"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/scout/trends/route";
exports.ids = ["app/api/scout/trends/route"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@15.0.0-rc.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fscout%2Ftrends%2Froute&page=%2Fapi%2Fscout%2Ftrends%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fscout%2Ftrends%2Froute.ts&appDir=%2FUsers%2Ftbwa%2Fscout-dashboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftbwa%2Fscout-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@15.0.0-rc.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fscout%2Ftrends%2Froute&page=%2Fapi%2Fscout%2Ftrends%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fscout%2Ftrends%2Froute.ts&appDir=%2FUsers%2Ftbwa%2Fscout-dashboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftbwa%2Fscout-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@15.0.0-rc.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@15.0.0-rc.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@15.0.0-rc.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_tbwa_scout_dashboard_app_api_scout_trends_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/scout/trends/route.ts */ \"(rsc)/./app/api/scout/trends/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/scout/trends/route\",\n        pathname: \"/api/scout/trends\",\n        filename: \"route\",\n        bundlePath: \"app/api/scout/trends/route\"\n    },\n    resolvedPagePath: \"/Users/tbwa/scout-dashboard/app/api/scout/trends/route.ts\",\n    nextConfigOutput,\n    userland: _Users_tbwa_scout_dashboard_app_api_scout_trends_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/scout/trends/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNS4wLjAtcmMuMF9yZWFjdC1kb21AMTkuMS4xX3JlYWN0QDE5LjEuMV9fcmVhY3RAMTkuMS4xL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtYXBwLWxvYWRlci5qcz9uYW1lPWFwcCUyRmFwaSUyRnNjb3V0JTJGdHJlbmRzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZzY291dCUyRnRyZW5kcyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnNjb3V0JTJGdHJlbmRzJTJGcm91dGUudHMmYXBwRGlyPSUyRlVzZXJzJTJGdGJ3YSUyRnNjb3V0LWRhc2hib2FyZCUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZ0YndhJTJGc2NvdXQtZGFzaGJvYXJkJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNTO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2NvdXQtZGFzaGJvYXJkLW5leHRqcy8/MjU3MCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvdGJ3YS9zY291dC1kYXNoYm9hcmQvYXBwL2FwaS9zY291dC90cmVuZHMvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3Njb3V0L3RyZW5kcy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3Njb3V0L3RyZW5kc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvc2NvdXQvdHJlbmRzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL3Rid2Evc2NvdXQtZGFzaGJvYXJkL2FwcC9hcGkvc2NvdXQvdHJlbmRzL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zY291dC90cmVuZHMvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@15.0.0-rc.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fscout%2Ftrends%2Froute&page=%2Fapi%2Fscout%2Ftrends%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fscout%2Ftrends%2Froute.ts&appDir=%2FUsers%2Ftbwa%2Fscout-dashboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftbwa%2Fscout-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/scout/trends/route.ts":
/*!***************************************!*\
  !*** ./app/api/scout/trends/route.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@15.0.0-rc.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_services_analytics__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/services/analytics */ \"(rsc)/./lib/services/analytics.ts\");\n/* harmony import */ var _lib_utils_validation__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/utils/validation */ \"(rsc)/./lib/utils/validation.ts\");\n\n\n\nasync function GET(req) {\n    try {\n        const { searchParams } = new URL(req.url);\n        // Parse and validate query parameters\n        const rawFilters = {\n            dateFrom: searchParams.get(\"from\"),\n            dateTo: searchParams.get(\"to\"),\n            regions: searchParams.get(\"regions\"),\n            provinces: searchParams.get(\"provinces\"),\n            stores: searchParams.get(\"stores\"),\n            brands: searchParams.get(\"brands\"),\n            categories: searchParams.get(\"categories\")\n        };\n        const rawPagination = {\n            limit: searchParams.get(\"limit\"),\n            offset: searchParams.get(\"offset\")\n        };\n        // Validate input parameters\n        const filterValidation = (0,_lib_utils_validation__WEBPACK_IMPORTED_MODULE_2__.validateTransactionFilters)(rawFilters);\n        const paginationValidation = (0,_lib_utils_validation__WEBPACK_IMPORTED_MODULE_2__.validatePagination)(rawPagination);\n        if (!filterValidation.isValid) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid filter parameters\",\n                details: filterValidation.errors\n            }, {\n                status: 400\n            });\n        }\n        if (!paginationValidation.isValid) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid pagination parameters\",\n                details: paginationValidation.errors\n            }, {\n                status: 400\n            });\n        }\n        // Apply defaults for missing filters\n        const filters = {\n            dateFrom: \"2024-01-01\",\n            dateTo: \"2025-12-31\",\n            ...filterValidation.sanitized\n        };\n        const analyticsService = new _lib_services_analytics__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\n        const result = await analyticsService.getDashboardData(\"transaction-trends\", filters, false);\n        if (result.error) {\n            console.error(\"Analytics service error:\", result.error);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Failed to fetch trends data\",\n                message: result.error\n            }, {\n                status: 500\n            });\n        }\n        const trendsData = result.data?.trends || [];\n        const { limit = 100, offset = 0 } = paginationValidation.sanitized;\n        const paginatedData = trendsData.slice(offset, offset + limit);\n        // Return trends data in expected format with enhanced metadata\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            rows: paginatedData,\n            meta: {\n                filters_applied: Object.keys(filters).filter((key)=>filters[key] !== undefined && filters[key] !== null),\n                total_records: trendsData.length,\n                returned_records: paginatedData.length,\n                pagination: {\n                    limit,\n                    offset,\n                    has_more: offset + limit < trendsData.length\n                },\n                generated_at: new Date().toISOString()\n            }\n        });\n    } catch (error) {\n        console.error(\"API error:\", error);\n        const errorMessage = error instanceof Error ? error.message : \"Unknown error occurred\";\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\",\n            message: errorMessage,\n            timestamp: new Date().toISOString()\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTtRQUM1QixNQUFNZ0MsZUFBZWhDLGlCQUFpQmlDLFFBQVFqQyxNQUFNVSxPQUFPLEdBQUc7UUFDOUQsT0FBT25DLHFEQUFZQSxDQUFDd0IsSUFBSSxDQUFDO1lBQ3ZCQyxPQUFPO1lBQ1BVLFNBQVNzQjtZQUNURSxXQUFXLElBQUlKLE9BQU9DLFdBQVc7UUFDbkMsR0FBRztZQUFFNUIsUUFBUTtRQUFJO0lBQ25CO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zY291dC1kYXNoYm9hcmQtbmV4dGpzLy4vYXBwL2FwaS9zY291dC90cmVuZHMvcm91dGUudHM/ODYyYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCJcbmltcG9ydCBBbmFseXRpY3NTZXJ2aWNlIGZyb20gXCJAL2xpYi9zZXJ2aWNlcy9hbmFseXRpY3NcIlxuaW1wb3J0IHsgVHJhbnNhY3Rpb25GaWx0ZXJzIH0gZnJvbSBcIkAvbGliL2RhbC90cmFuc2FjdGlvbnNcIlxuaW1wb3J0IHsgdmFsaWRhdGVUcmFuc2FjdGlvbkZpbHRlcnMsIHZhbGlkYXRlUGFnaW5hdGlvbiB9IGZyb20gXCJAL2xpYi91dGlscy92YWxpZGF0aW9uXCJcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxLnVybClcbiAgICBcbiAgICAvLyBQYXJzZSBhbmQgdmFsaWRhdGUgcXVlcnkgcGFyYW1ldGVyc1xuICAgIGNvbnN0IHJhd0ZpbHRlcnMgPSB7XG4gICAgICBkYXRlRnJvbTogc2VhcmNoUGFyYW1zLmdldChcImZyb21cIiksXG4gICAgICBkYXRlVG86IHNlYXJjaFBhcmFtcy5nZXQoXCJ0b1wiKSxcbiAgICAgIHJlZ2lvbnM6IHNlYXJjaFBhcmFtcy5nZXQoXCJyZWdpb25zXCIpLFxuICAgICAgcHJvdmluY2VzOiBzZWFyY2hQYXJhbXMuZ2V0KFwicHJvdmluY2VzXCIpLFxuICAgICAgc3RvcmVzOiBzZWFyY2hQYXJhbXMuZ2V0KFwic3RvcmVzXCIpLFxuICAgICAgYnJhbmRzOiBzZWFyY2hQYXJhbXMuZ2V0KFwiYnJhbmRzXCIpLFxuICAgICAgY2F0ZWdvcmllczogc2VhcmNoUGFyYW1zLmdldChcImNhdGVnb3JpZXNcIilcbiAgICB9XG4gICAgXG4gICAgY29uc3QgcmF3UGFnaW5hdGlvbiA9IHtcbiAgICAgIGxpbWl0OiBzZWFyY2hQYXJhbXMuZ2V0KFwibGltaXRcIiksXG4gICAgICBvZmZzZXQ6IHNlYXJjaFBhcmFtcy5nZXQoXCJvZmZzZXRcIilcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBpbnB1dCBwYXJhbWV0ZXJzXG4gICAgY29uc3QgZmlsdGVyVmFsaWRhdGlvbiA9IHZhbGlkYXRlVHJhbnNhY3Rpb25GaWx0ZXJzKHJhd0ZpbHRlcnMpXG4gICAgY29uc3QgcGFnaW5hdGlvblZhbGlkYXRpb24gPSB2YWxpZGF0ZVBhZ2luYXRpb24ocmF3UGFnaW5hdGlvbilcbiAgICBcbiAgICBpZiAoIWZpbHRlclZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIGVycm9yOiBcIkludmFsaWQgZmlsdGVyIHBhcmFtZXRlcnNcIiwgXG4gICAgICAgIGRldGFpbHM6IGZpbHRlclZhbGlkYXRpb24uZXJyb3JzIFxuICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgIH1cbiAgICBcbiAgICBpZiAoIXBhZ2luYXRpb25WYWxpZGF0aW9uLmlzVmFsaWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBlcnJvcjogXCJJbnZhbGlkIHBhZ2luYXRpb24gcGFyYW1ldGVyc1wiLCBcbiAgICAgICAgZGV0YWlsczogcGFnaW5hdGlvblZhbGlkYXRpb24uZXJyb3JzIFxuICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgIH1cblxuICAgIC8vIEFwcGx5IGRlZmF1bHRzIGZvciBtaXNzaW5nIGZpbHRlcnNcbiAgICBjb25zdCBmaWx0ZXJzOiBUcmFuc2FjdGlvbkZpbHRlcnMgPSB7XG4gICAgICBkYXRlRnJvbTogXCIyMDI0LTAxLTAxXCIsXG4gICAgICBkYXRlVG86IFwiMjAyNS0xMi0zMVwiLFxuICAgICAgLi4uZmlsdGVyVmFsaWRhdGlvbi5zYW5pdGl6ZWRcbiAgICB9XG5cbiAgICBjb25zdCBhbmFseXRpY3NTZXJ2aWNlID0gbmV3IEFuYWx5dGljc1NlcnZpY2UoKVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGFuYWx5dGljc1NlcnZpY2UuZ2V0RGFzaGJvYXJkRGF0YShcInRyYW5zYWN0aW9uLXRyZW5kc1wiLCBmaWx0ZXJzLCBmYWxzZSlcblxuICAgIGlmIChyZXN1bHQuZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJBbmFseXRpY3Mgc2VydmljZSBlcnJvcjpcIiwgcmVzdWx0LmVycm9yKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIGVycm9yOiBcIkZhaWxlZCB0byBmZXRjaCB0cmVuZHMgZGF0YVwiLCBcbiAgICAgICAgbWVzc2FnZTogcmVzdWx0LmVycm9yIFxuICAgICAgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICAgIH1cblxuICAgIGNvbnN0IHRyZW5kc0RhdGEgPSByZXN1bHQuZGF0YT8udHJlbmRzIHx8IFtdXG4gICAgY29uc3QgeyBsaW1pdCA9IDEwMCwgb2Zmc2V0ID0gMCB9ID0gcGFnaW5hdGlvblZhbGlkYXRpb24uc2FuaXRpemVkXG4gICAgY29uc3QgcGFnaW5hdGVkRGF0YSA9IHRyZW5kc0RhdGEuc2xpY2Uob2Zmc2V0LCBvZmZzZXQgKyBsaW1pdClcblxuICAgIC8vIFJldHVybiB0cmVuZHMgZGF0YSBpbiBleHBlY3RlZCBmb3JtYXQgd2l0aCBlbmhhbmNlZCBtZXRhZGF0YVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgcm93czogcGFnaW5hdGVkRGF0YSxcbiAgICAgIG1ldGE6IHtcbiAgICAgICAgZmlsdGVyc19hcHBsaWVkOiBPYmplY3Qua2V5cyhmaWx0ZXJzKS5maWx0ZXIoa2V5ID0+IFxuICAgICAgICAgIGZpbHRlcnNba2V5IGFzIGtleW9mIFRyYW5zYWN0aW9uRmlsdGVyc10gIT09IHVuZGVmaW5lZCAmJiBcbiAgICAgICAgICBmaWx0ZXJzW2tleSBhcyBrZXlvZiBUcmFuc2FjdGlvbkZpbHRlcnNdICE9PSBudWxsXG4gICAgICAgICksXG4gICAgICAgIHRvdGFsX3JlY29yZHM6IHRyZW5kc0RhdGEubGVuZ3RoLFxuICAgICAgICByZXR1cm5lZF9yZWNvcmRzOiBwYWdpbmF0ZWREYXRhLmxlbmd0aCxcbiAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgIGxpbWl0LFxuICAgICAgICAgIG9mZnNldCxcbiAgICAgICAgICBoYXNfbW9yZTogb2Zmc2V0ICsgbGltaXQgPCB0cmVuZHNEYXRhLmxlbmd0aFxuICAgICAgICB9LFxuICAgICAgICBnZW5lcmF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfVxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkFQSSBlcnJvcjpcIiwgZXJyb3IpXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBcIlVua25vd24gZXJyb3Igb2NjdXJyZWRcIlxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgZXJyb3I6IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIsXG4gICAgICBtZXNzYWdlOiBlcnJvck1lc3NhZ2UsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH0sIHsgc3RhdHVzOiA1MDAgfSlcbiAgfVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJBbmFseXRpY3NTZXJ2aWNlIiwidmFsaWRhdGVUcmFuc2FjdGlvbkZpbHRlcnMiLCJ2YWxpZGF0ZVBhZ2luYXRpb24iLCJHRVQiLCJyZXEiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJyYXdGaWx0ZXJzIiwiZGF0ZUZyb20iLCJnZXQiLCJkYXRlVG8iLCJyZWdpb25zIiwicHJvdmluY2VzIiwic3RvcmVzIiwiYnJhbmRzIiwiY2F0ZWdvcmllcyIsInJhd1BhZ2luYXRpb24iLCJsaW1pdCIsIm9mZnNldCIsImZpbHRlclZhbGlkYXRpb24iLCJwYWdpbmF0aW9uVmFsaWRhdGlvbiIsImlzVmFsaWQiLCJqc29uIiwiZXJyb3IiLCJkZXRhaWxzIiwiZXJyb3JzIiwic3RhdHVzIiwiZmlsdGVycyIsInNhbml0aXplZCIsImFuYWx5dGljc1NlcnZpY2UiLCJyZXN1bHQiLCJnZXREYXNoYm9hcmREYXRhIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJ0cmVuZHNEYXRhIiwiZGF0YSIsInRyZW5kcyIsInBhZ2luYXRlZERhdGEiLCJzbGljZSIsInJvd3MiLCJtZXRhIiwiZmlsdGVyc19hcHBsaWVkIiwiT2JqZWN0Iiwia2V5cyIsImZpbHRlciIsImtleSIsInVuZGVmaW5lZCIsInRvdGFsX3JlY29yZHMiLCJsZW5ndGgiLCJyZXR1cm5lZF9yZWNvcmRzIiwicGFnaW5hdGlvbiIsImhhc19tb3JlIiwiZ2VuZXJhdGVkX2F0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiZXJyb3JNZXNzYWdlIiwiRXJyb3IiLCJ0aW1lc3RhbXAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/scout/trends/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/dal/ai.ts":
/*!***********************!*\
  !*** ./lib/dal/ai.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base */ \"(rsc)/./lib/dal/base.ts\");\n/**\n * AI/LLM Data Access Layer\n * Handles AI-powered analytics, insights, and chat functionality\n */ \nclass AIDAL extends _base__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n    /**\n   * Store and retrieve chat messages\n   */ async storeChatMessage(message) {\n        return this.executeQuery(async (client)=>{\n            const { data, error } = await client.from('platinum.chat_messages').insert([\n                message\n            ]).select().single();\n            return {\n                data,\n                error\n            };\n        });\n    }\n    async getChatHistory(conversationId, limit = 50) {\n        const cacheKey = `chat_history_${conversationId}`;\n        return this.executeQuery(async (client)=>{\n            const { data, error } = await client.from('platinum.chat_messages').select('*').eq('conversation_id', conversationId).order('created_at', {\n                ascending: true\n            }).limit(limit);\n            return {\n                data,\n                error\n            };\n        }, cacheKey, 60000 // 1 minute cache for chat\n        );\n    }\n    /**\n   * Generate AI insights from transaction data\n   */ async generateInsights(params) {\n        const cacheKey = `insights_${JSON.stringify(params)}`;\n        return this.executeQuery(async (client)=>{\n            // First, get the data context for AI analysis\n            const contextQuery = this.buildContextQuery(params);\n            const { data: contextData, error: contextError } = await client.rpc('get_ai_context', {\n                analysis_type: params.analysisType,\n                filters: params.filters || {},\n                timeframe: params.timeframe || '30d'\n            });\n            if (contextError) {\n                return {\n                    data: null,\n                    error: contextError\n                };\n            }\n            // For now, generate rule-based insights\n            // In production, this would call OpenAI/Anthropic APIs\n            const insights = this.generateRuleBasedInsights(contextData, params);\n            // Store insights for tracking\n            const { error: storeError } = await client.from('platinum.ai_insights').insert(insights.map((insight)=>({\n                    ...insight,\n                    created_at: new Date().toISOString(),\n                    analysis_params: params\n                })));\n            if (storeError) {\n                console.warn('Failed to store insights:', storeError);\n            }\n            return {\n                data: insights,\n                error: null\n            };\n        }, cacheKey, 600000 // 10 minutes cache\n        );\n    }\n    /**\n   * Get AI-powered recommendations\n   */ async getRecommendations(section, userContext = {}) {\n        const cacheKey = `recommendations_${section}_${JSON.stringify(userContext)}`;\n        return this.executeQuery(async (client)=>{\n            // Get recent performance data for recommendations\n            const { data: performanceData, error: perfError } = await client.rpc('get_recommendation_context', {\n                section,\n                user_context: userContext\n            });\n            if (perfError) {\n                return {\n                    data: null,\n                    error: perfError\n                };\n            }\n            // Generate contextual recommendations\n            const recommendations = this.generateRecommendations(section, performanceData, userContext);\n            return {\n                data: recommendations,\n                error: null\n            };\n        }, cacheKey, 300000 // 5 minutes cache\n        );\n    }\n    /**\n   * Perform semantic search across transaction data and insights\n   */ async semanticSearch(query, filters = {}) {\n        const cacheKey = `semantic_${query}_${JSON.stringify(filters)}`;\n        return this.executeQuery(async (client)=>{\n            // Use PostgreSQL full-text search for now\n            // In production, this would use vector embeddings\n            const { data, error } = await client.rpc('semantic_search', {\n                search_query: query,\n                filters: filters,\n                limit: 20\n            });\n            return {\n                data,\n                error\n            };\n        }, cacheKey, 300000 // 5 minutes cache\n        );\n    }\n    /**\n   * Detect anomalies in transaction patterns\n   */ async detectAnomalies(metric = 'sales', timeframe = '7d', sensitivity = 2.0) {\n        const cacheKey = `anomalies_${metric}_${timeframe}_${sensitivity}`;\n        return this.executeQuery(async (client)=>{\n            const { data, error } = await client.rpc('detect_anomalies', {\n                metric_name: metric,\n                time_window: timeframe,\n                sensitivity_threshold: sensitivity\n            });\n            return {\n                data,\n                error\n            };\n        }, cacheKey, 600000 // 10 minutes cache\n        );\n    }\n    /**\n   * Generate predictions for business metrics\n   */ async generatePredictions(metrics, forecastDays = 30) {\n        const cacheKey = `predictions_${metrics.join(',')}_${forecastDays}`;\n        return this.executeQuery(async (client)=>{\n            // Simple linear regression for now\n            // In production, use more sophisticated ML models\n            const predictions = [];\n            for (const metric of metrics){\n                const { data: historicalData, error } = await client.from('v_trends_daily').select(`day, ${metric}`).order('day', {\n                    ascending: false\n                }).limit(90) // Use 90 days for trend analysis\n                ;\n                if (error) continue;\n                const forecast = this.generateLinearForecast(historicalData, metric, forecastDays);\n                predictions.push({\n                    metric,\n                    forecast,\n                    confidence: this.calculateForecastConfidence(historicalData)\n                });\n            }\n            return {\n                data: predictions,\n                error: null\n            };\n        }, cacheKey, 1800000 // 30 minutes cache\n        );\n    }\n    /**\n   * Process natural language query for dashboard insights\n   */ async processNaturalLanguageQuery(query, context) {\n        try {\n            // Parse intent from query\n            const intent = this.parseQueryIntent(query);\n            // Generate appropriate response based on intent\n            let response;\n            switch(intent.type){\n                case 'data_request':\n                    response = await this.handleDataRequest(intent, context);\n                    break;\n                case 'analysis_request':\n                    response = await this.handleAnalysisRequest(intent, context);\n                    break;\n                case 'comparison_request':\n                    response = await this.handleComparisonRequest(intent, context);\n                    break;\n                default:\n                    response = await this.handleGeneralQuery(query, context);\n            }\n            return {\n                data: response,\n                error: null\n            };\n        } catch (error) {\n            return {\n                data: null,\n                error: error.message\n            };\n        }\n    }\n    // Private helper methods\n    buildContextQuery(params) {\n        // Build SQL query based on analysis parameters\n        const baseQuery = `\n      SELECT \n        DATE_TRUNC('day', timestamp) as date,\n        COUNT(*) as transactions,\n        SUM(peso_value) as revenue,\n        AVG(peso_value) as avg_order_value,\n        COUNT(DISTINCT store_id) as unique_stores\n      FROM transactions\n      WHERE timestamp >= NOW() - INTERVAL '${params.timeframe || '30d'}'\n    `;\n        if (params.filters) {\n            // Add filter conditions\n            Object.entries(params.filters).forEach(([key, value])=>{\n                if (Array.isArray(value)) {\n                    baseQuery + ` AND ${key} = ANY($${value})`;\n                } else {\n                    baseQuery + ` AND ${key} = '${value}'`;\n                }\n            });\n        }\n        return baseQuery + ' GROUP BY DATE_TRUNC(\\'day\\', timestamp) ORDER BY date';\n    }\n    generateRuleBasedInsights(data, params) {\n        const insights = [];\n        if (params.analysisType === 'trends') {\n            // Detect trend patterns\n            if (data.length >= 7) {\n                const recentWeek = data.slice(-7);\n                const previousWeek = data.slice(-14, -7);\n                const recentAvg = recentWeek.reduce((sum, d)=>sum + d.revenue, 0) / recentWeek.length;\n                const previousAvg = previousWeek.reduce((sum, d)=>sum + d.revenue, 0) / previousWeek.length;\n                const changePercent = (recentAvg - previousAvg) / previousAvg * 100;\n                insights.push({\n                    id: `trend_${Date.now()}`,\n                    type: 'trend',\n                    title: `Revenue ${changePercent > 0 ? 'Growth' : 'Decline'} Detected`,\n                    description: `Revenue has ${changePercent > 0 ? 'increased' : 'decreased'} by ${Math.abs(changePercent).toFixed(1)}% compared to the previous week.`,\n                    confidence: Math.min(Math.abs(changePercent) / 10, 1),\n                    priority: changePercent > 15 || changePercent < -10 ? 'high' : 'medium',\n                    category: 'financial',\n                    recommendations: [\n                        changePercent > 15 ? 'Analyze successful strategies and scale them' : 'Investigate factors causing the decline',\n                        'Monitor closely for continued trend'\n                    ],\n                    created_at: new Date().toISOString()\n                });\n            }\n        }\n        if (params.analysisType === 'anomalies') {\n            // Detect anomalies in data\n            const revenues = data.map((d)=>d.revenue);\n            const mean = revenues.reduce((sum, r)=>sum + r, 0) / revenues.length;\n            const stdDev = Math.sqrt(revenues.reduce((sum, r)=>sum + Math.pow(r - mean, 2), 0) / revenues.length);\n            data.forEach((point, index)=>{\n                const zScore = Math.abs((point.revenue - mean) / stdDev);\n                if (zScore > 2) {\n                    insights.push({\n                        id: `anomaly_${Date.now()}_${index}`,\n                        type: 'anomaly',\n                        title: `Revenue Anomaly on ${point.date}`,\n                        description: `Revenue of ₱${point.revenue.toLocaleString()} is ${zScore.toFixed(1)} standard deviations from normal.`,\n                        confidence: Math.min(zScore / 3, 1),\n                        priority: zScore > 3 ? 'high' : 'medium',\n                        category: 'operational',\n                        recommendations: [\n                            'Investigate the root cause of this anomaly',\n                            'Check for data quality issues or exceptional events'\n                        ],\n                        created_at: new Date().toISOString()\n                    });\n                }\n            });\n        }\n        return insights;\n    }\n    generateRecommendations(section, data, context) {\n        const recommendations = [];\n        // Section-specific recommendations\n        switch(section){\n            case 'transaction-trends':\n                recommendations.push({\n                    id: `rec_trends_${Date.now()}`,\n                    type: 'optimization',\n                    title: 'Optimize Peak Hours',\n                    description: 'Focus marketing efforts during 2-4 PM when conversion rates are highest',\n                    impact: 'high',\n                    effort: 'medium',\n                    category: 'marketing',\n                    metrics: [\n                        'conversion_rate',\n                        'revenue'\n                    ],\n                    estimatedImprovement: '15-20%',\n                    timeline: '2-4 weeks',\n                    created_at: new Date().toISOString()\n                });\n                break;\n            case 'product-mix':\n                recommendations.push({\n                    id: `rec_product_${Date.now()}`,\n                    type: 'inventory',\n                    title: 'Adjust Inventory Mix',\n                    description: 'Increase stock for top-performing categories and reduce underperformers',\n                    impact: 'high',\n                    effort: 'low',\n                    category: 'inventory',\n                    metrics: [\n                        'inventory_turnover',\n                        'profit_margin'\n                    ],\n                    estimatedImprovement: '10-15%',\n                    timeline: '1-2 weeks',\n                    created_at: new Date().toISOString()\n                });\n                break;\n        }\n        return recommendations;\n    }\n    parseQueryIntent(query) {\n        const lowercaseQuery = query.toLowerCase();\n        // Simple intent classification\n        if (lowercaseQuery.includes('show') || lowercaseQuery.includes('display') || lowercaseQuery.includes('get')) {\n            return {\n                type: 'data_request',\n                entities: [],\n                parameters: {}\n            };\n        }\n        if (lowercaseQuery.includes('analyze') || lowercaseQuery.includes('analysis')) {\n            return {\n                type: 'analysis_request',\n                entities: [],\n                parameters: {}\n            };\n        }\n        if (lowercaseQuery.includes('compare') || lowercaseQuery.includes('vs')) {\n            return {\n                type: 'comparison_request',\n                entities: [],\n                parameters: {}\n            };\n        }\n        return {\n            type: 'general',\n            entities: [],\n            parameters: {}\n        };\n    }\n    async handleDataRequest(intent, context) {\n        // Handle data requests\n        return {\n            type: 'data_response',\n            message: 'I can help you access specific data. What metrics would you like to see?',\n            suggestions: [\n                'Show sales trends',\n                'Display top products',\n                'Get regional performance'\n            ]\n        };\n    }\n    async handleAnalysisRequest(intent, context) {\n        // Handle analysis requests\n        return {\n            type: 'analysis_response',\n            message: 'I can perform various analyses on your data. What type of analysis interests you?',\n            suggestions: [\n                'Trend analysis',\n                'Anomaly detection',\n                'Predictive modeling'\n            ]\n        };\n    }\n    async handleComparisonRequest(intent, context) {\n        // Handle comparison requests\n        return {\n            type: 'comparison_response',\n            message: 'I can help you compare different metrics or time periods. What would you like to compare?',\n            suggestions: [\n                'Compare regions',\n                'Month-over-month trends',\n                'Product performance'\n            ]\n        };\n    }\n    async handleGeneralQuery(query, context) {\n        // Handle general queries\n        return {\n            type: 'general_response',\n            message: `I understand you're asking about \"${query}\". Could you be more specific about what data or analysis you need?`,\n            suggestions: [\n                'Ask about specific metrics',\n                'Request trend analysis',\n                'Compare time periods'\n            ]\n        };\n    }\n    generateLinearForecast(data, metric, days) {\n        // Simple linear regression forecast\n        const points = data.map((d, i)=>({\n                x: i,\n                y: d[metric]\n            }));\n        // Calculate linear regression\n        const n = points.length;\n        const sumX = points.reduce((sum, p)=>sum + p.x, 0);\n        const sumY = points.reduce((sum, p)=>sum + p.y, 0);\n        const sumXY = points.reduce((sum, p)=>sum + p.x * p.y, 0);\n        const sumXX = points.reduce((sum, p)=>sum + p.x * p.x, 0);\n        const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);\n        const intercept = (sumY - slope * sumX) / n;\n        // Generate forecast points\n        const forecast = [];\n        for(let i = 0; i < days; i++){\n            const x = n + i;\n            const y = slope * x + intercept;\n            forecast.push({\n                day: i + 1,\n                predicted_value: Math.max(0, y),\n                confidence: Math.max(0, 1 - i / days * 0.5) // Decreasing confidence over time\n            });\n        }\n        return forecast;\n    }\n    calculateForecastConfidence(data) {\n        // Calculate R-squared for confidence measure\n        if (data.length < 3) return 0.5;\n        const values = data.map((d)=>d.revenue || d.sales || 0);\n        const mean = values.reduce((sum, v)=>sum + v, 0) / values.length;\n        const totalVariation = values.reduce((sum, v)=>sum + Math.pow(v - mean, 2), 0);\n        const trend = this.calculateTrendLine(values);\n        const explainedVariation = values.reduce((sum, v, i)=>sum + Math.pow(trend[i] - mean, 2), 0);\n        const rSquared = explainedVariation / totalVariation;\n        return Math.min(Math.max(rSquared, 0.1), 0.95) // Bounded confidence\n        ;\n    }\n    calculateTrendLine(values) {\n        const n = values.length;\n        const sumX = n * (n - 1) / 2;\n        const sumY = values.reduce((sum, v)=>sum + v, 0);\n        const sumXY = values.reduce((sum, v, i)=>sum + i * v, 0);\n        const sumXX = n * (n - 1) * (2 * n - 1) / 6;\n        const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);\n        const intercept = (sumY - slope * sumX) / n;\n        return values.map((_, i)=>slope * i + intercept);\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AIDAL);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGFsL2FpLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7OztDQUdDLEdBRTJCO0FBa0I1QixNQUFNQyxjQUFjRCw2Q0FBT0E7SUFFekI7O0dBRUMsR0FDRCxNQUFNRSxpQkFBaUJDLE9BQW9CLEVBQStEO1FBQ3hHLE9BQU8sSUFBSSxDQUFDQyxZQUFZLENBQ3RCLE9BQU9DO1lBQ0wsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1GLE9BQzNCRyxJQUFJLENBQUMsMEJBQ0xDLE1BQU0sQ0FBQztnQkFBQ047YUFBUSxFQUNoQk8sTUFBTSxHQUNOQyxNQUFNO1lBRVQsT0FBTztnQkFBRUw7Z0JBQU1DO1lBQU07UUFDdkI7SUFFSjtJQUVBLE1BQU1LLGVBQWVDLGNBQXNCLEVBQUVDLFFBQWdCLEVBQUUsRUFBaUU7UUFDOUgsTUFBTUMsV0FBVyxDQUFDLGFBQWEsRUFBRUYsZUFBZSxDQUFDO1FBRWpELE9BQU8sSUFBSSxDQUFDVCxZQUFZLENBQ3RCLE9BQU9DO1lBQ0wsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1GLE9BQzNCRyxJQUFJLENBQUMsMEJBQ0xFLE1BQU0sQ0FBQyxLQUNQTSxFQUFFLENBQUMsbUJBQW1CSCxnQkFDdEJJLEtBQUssQ0FBQyxjQUFjO2dCQUFFQyxXQUFXO1lBQUssR0FDdENKLEtBQUssQ0FBQ0E7WUFFVCxPQUFPO2dCQUFFUjtnQkFBTUM7WUFBTTtRQUN2QixHQUNBUSxVQUNBLE1BQU0sMEJBQTBCOztJQUVwQztJQUVBOztHQUVDLEdBQ0QsTUFBTUksaUJBQWlCQyxNQUF3QixFQUErRDtRQUM1RyxNQUFNTCxXQUFXLENBQUMsU0FBUyxFQUFFTSxLQUFLQyxTQUFTLENBQUNGLFFBQVEsQ0FBQztRQUVyRCxPQUFPLElBQUksQ0FBQ2hCLFlBQVksQ0FDdEIsT0FBT0M7WUFDTCw4Q0FBOEM7WUFDOUMsTUFBTWtCLGVBQWUsSUFBSSxDQUFDQyxpQkFBaUIsQ0FBQ0o7WUFDNUMsTUFBTSxFQUFFZCxNQUFNbUIsV0FBVyxFQUFFbEIsT0FBT21CLFlBQVksRUFBRSxHQUFHLE1BQU1yQixPQUFPc0IsR0FBRyxDQUFDLGtCQUFrQjtnQkFDcEZDLGVBQWVSLE9BQU9TLFlBQVk7Z0JBQ2xDQyxTQUFTVixPQUFPVSxPQUFPLElBQUksQ0FBQztnQkFDNUJDLFdBQVdYLE9BQU9XLFNBQVMsSUFBSTtZQUNqQztZQUVBLElBQUlMLGNBQWM7Z0JBQ2hCLE9BQU87b0JBQUVwQixNQUFNO29CQUFNQyxPQUFPbUI7Z0JBQWE7WUFDM0M7WUFFQSx3Q0FBd0M7WUFDeEMsdURBQXVEO1lBQ3ZELE1BQU1NLFdBQVcsSUFBSSxDQUFDQyx5QkFBeUIsQ0FBQ1IsYUFBYUw7WUFFN0QsOEJBQThCO1lBQzlCLE1BQU0sRUFBRWIsT0FBTzJCLFVBQVUsRUFBRSxHQUFHLE1BQU03QixPQUNqQ0csSUFBSSxDQUFDLHdCQUNMQyxNQUFNLENBQUN1QixTQUFTRyxHQUFHLENBQUNDLENBQUFBLFVBQVk7b0JBQy9CLEdBQUdBLE9BQU87b0JBQ1ZDLFlBQVksSUFBSUMsT0FBT0MsV0FBVztvQkFDbENDLGlCQUFpQnBCO2dCQUNuQjtZQUVGLElBQUljLFlBQVk7Z0JBQ2RPLFFBQVFDLElBQUksQ0FBQyw2QkFBNkJSO1lBQzVDO1lBRUEsT0FBTztnQkFBRTVCLE1BQU0wQjtnQkFBVXpCLE9BQU87WUFBSztRQUN2QyxHQUNBUSxVQUNBLE9BQU8sbUJBQW1COztJQUU5QjtJQUVBOztHQUVDLEdBQ0QsTUFBTTRCLG1CQUNKQyxPQUFlLEVBQ2ZDLGNBQW1DLENBQUMsQ0FBQyxFQUNpQztRQUN0RSxNQUFNOUIsV0FBVyxDQUFDLGdCQUFnQixFQUFFNkIsUUFBUSxDQUFDLEVBQUV2QixLQUFLQyxTQUFTLENBQUN1QixhQUFhLENBQUM7UUFFNUUsT0FBTyxJQUFJLENBQUN6QyxZQUFZLENBQ3RCLE9BQU9DO1lBQ0wsa0RBQWtEO1lBQ2xELE1BQU0sRUFBRUMsTUFBTXdDLGVBQWUsRUFBRXZDLE9BQU93QyxTQUFTLEVBQUUsR0FBRyxNQUFNMUMsT0FBT3NCLEdBQUcsQ0FBQyw4QkFBOEI7Z0JBQ2pHaUI7Z0JBQ0FJLGNBQWNIO1lBQ2hCO1lBRUEsSUFBSUUsV0FBVztnQkFDYixPQUFPO29CQUFFekMsTUFBTTtvQkFBTUMsT0FBT3dDO2dCQUFVO1lBQ3hDO1lBRUEsc0NBQXNDO1lBQ3RDLE1BQU1FLGtCQUFrQixJQUFJLENBQUNDLHVCQUF1QixDQUFDTixTQUFTRSxpQkFBaUJEO1lBRS9FLE9BQU87Z0JBQUV2QyxNQUFNMkM7Z0JBQWlCMUMsT0FBTztZQUFLO1FBQzlDLEdBQ0FRLFVBQ0EsT0FBTyxrQkFBa0I7O0lBRTdCO0lBRUE7O0dBRUMsR0FDRCxNQUFNb0MsZUFBZUMsS0FBYSxFQUFFdEIsVUFBK0IsQ0FBQyxDQUFDLEVBQXlEO1FBQzVILE1BQU1mLFdBQVcsQ0FBQyxTQUFTLEVBQUVxQyxNQUFNLENBQUMsRUFBRS9CLEtBQUtDLFNBQVMsQ0FBQ1EsU0FBUyxDQUFDO1FBRS9ELE9BQU8sSUFBSSxDQUFDMUIsWUFBWSxDQUN0QixPQUFPQztZQUNMLDBDQUEwQztZQUMxQyxrREFBa0Q7WUFDbEQsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1GLE9BQU9zQixHQUFHLENBQUMsbUJBQW1CO2dCQUMxRDBCLGNBQWNEO2dCQUNkdEIsU0FBU0E7Z0JBQ1RoQixPQUFPO1lBQ1Q7WUFFQSxPQUFPO2dCQUFFUjtnQkFBTUM7WUFBTTtRQUN2QixHQUNBUSxVQUNBLE9BQU8sa0JBQWtCOztJQUU3QjtJQUVBOztHQUVDLEdBQ0QsTUFBTXVDLGdCQUNKQyxTQUFpQixPQUFPLEVBQ3hCeEIsWUFBb0IsSUFBSSxFQUN4QnlCLGNBQXNCLEdBQUcsRUFDOEI7UUFDdkQsTUFBTXpDLFdBQVcsQ0FBQyxVQUFVLEVBQUV3QyxPQUFPLENBQUMsRUFBRXhCLFVBQVUsQ0FBQyxFQUFFeUIsWUFBWSxDQUFDO1FBRWxFLE9BQU8sSUFBSSxDQUFDcEQsWUFBWSxDQUN0QixPQUFPQztZQUNMLE1BQU0sRUFBRUMsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNRixPQUFPc0IsR0FBRyxDQUFDLG9CQUFvQjtnQkFDM0Q4QixhQUFhRjtnQkFDYkcsYUFBYTNCO2dCQUNiNEIsdUJBQXVCSDtZQUN6QjtZQUVBLE9BQU87Z0JBQUVsRDtnQkFBTUM7WUFBTTtRQUN2QixHQUNBUSxVQUNBLE9BQU8sbUJBQW1COztJQUU5QjtJQUVBOztHQUVDLEdBQ0QsTUFBTTZDLG9CQUNKQyxPQUFpQixFQUNqQkMsZUFBdUIsRUFBRSxFQUM4QjtRQUN2RCxNQUFNL0MsV0FBVyxDQUFDLFlBQVksRUFBRThDLFFBQVFFLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRUQsYUFBYSxDQUFDO1FBRW5FLE9BQU8sSUFBSSxDQUFDMUQsWUFBWSxDQUN0QixPQUFPQztZQUNMLG1DQUFtQztZQUNuQyxrREFBa0Q7WUFDbEQsTUFBTTJELGNBQWMsRUFBRTtZQUV0QixLQUFLLE1BQU1ULFVBQVVNLFFBQVM7Z0JBQzVCLE1BQU0sRUFBRXZELE1BQU0yRCxjQUFjLEVBQUUxRCxLQUFLLEVBQUUsR0FBRyxNQUFNRixPQUMzQ0csSUFBSSxDQUFDLGtCQUNMRSxNQUFNLENBQUMsQ0FBQyxLQUFLLEVBQUU2QyxPQUFPLENBQUMsRUFDdkJ0QyxLQUFLLENBQUMsT0FBTztvQkFBRUMsV0FBVztnQkFBTSxHQUNoQ0osS0FBSyxDQUFDLElBQUksaUNBQWlDOztnQkFFOUMsSUFBSVAsT0FBTztnQkFFWCxNQUFNMkQsV0FBVyxJQUFJLENBQUNDLHNCQUFzQixDQUFDRixnQkFBZ0JWLFFBQVFPO2dCQUNyRUUsWUFBWUksSUFBSSxDQUFDO29CQUNmYjtvQkFDQVc7b0JBQ0FHLFlBQVksSUFBSSxDQUFDQywyQkFBMkIsQ0FBQ0w7Z0JBQy9DO1lBQ0Y7WUFFQSxPQUFPO2dCQUFFM0QsTUFBTTBEO2dCQUFhekQsT0FBTztZQUFLO1FBQzFDLEdBQ0FRLFVBQ0EsUUFBUSxtQkFBbUI7O0lBRS9CO0lBRUE7O0dBRUMsR0FDRCxNQUFNd0QsNEJBQ0puQixLQUFhLEVBQ2JvQixPQUFvQixFQUNpQztRQUNyRCxJQUFJO1lBQ0YsMEJBQTBCO1lBQzFCLE1BQU1DLFNBQVMsSUFBSSxDQUFDQyxnQkFBZ0IsQ0FBQ3RCO1lBRXJDLGdEQUFnRDtZQUNoRCxJQUFJdUI7WUFDSixPQUFRRixPQUFPRyxJQUFJO2dCQUNqQixLQUFLO29CQUNIRCxXQUFXLE1BQU0sSUFBSSxDQUFDRSxpQkFBaUIsQ0FBQ0osUUFBUUQ7b0JBQ2hEO2dCQUNGLEtBQUs7b0JBQ0hHLFdBQVcsTUFBTSxJQUFJLENBQUNHLHFCQUFxQixDQUFDTCxRQUFRRDtvQkFDcEQ7Z0JBQ0YsS0FBSztvQkFDSEcsV0FBVyxNQUFNLElBQUksQ0FBQ0ksdUJBQXVCLENBQUNOLFFBQVFEO29CQUN0RDtnQkFDRjtvQkFDRUcsV0FBVyxNQUFNLElBQUksQ0FBQ0ssa0JBQWtCLENBQUM1QixPQUFPb0I7WUFDcEQ7WUFFQSxPQUFPO2dCQUFFbEUsTUFBTXFFO2dCQUFVcEUsT0FBTztZQUFLO1FBQ3ZDLEVBQUUsT0FBT0EsT0FBTztZQUNkLE9BQU87Z0JBQUVELE1BQU07Z0JBQU1DLE9BQU8sTUFBaUJKLE9BQU87WUFBQztRQUN2RDtJQUNGO0lBRUEseUJBQXlCO0lBQ2pCcUIsa0JBQWtCSixNQUF3QixFQUFVO1FBQzFELCtDQUErQztRQUMvQyxNQUFNNkQsWUFBWSxDQUFDOzs7Ozs7OzsyQ0FRb0IsRUFBRTdELE9BQU9XLFNBQVMsSUFBSSxNQUFNO0lBQ25FLENBQUM7UUFFRCxJQUFJWCxPQUFPVSxPQUFPLEVBQUU7WUFDbEIsd0JBQXdCO1lBQ3hCb0QsT0FBT0MsT0FBTyxDQUFDL0QsT0FBT1UsT0FBTyxFQUFFc0QsT0FBTyxDQUFDLENBQUMsQ0FBQ0MsS0FBS0MsTUFBTTtnQkFDbEQsSUFBSUMsTUFBTUMsT0FBTyxDQUFDRixRQUFRO29CQUN4QkwsWUFBWSxDQUFDLEtBQUssRUFBRUksSUFBSSxRQUFRLEVBQUVDLE1BQU0sQ0FBQyxDQUFDO2dCQUM1QyxPQUFPO29CQUNMTCxZQUFZLENBQUMsS0FBSyxFQUFFSSxJQUFJLElBQUksRUFBRUMsTUFBTSxDQUFDLENBQUM7Z0JBQ3hDO1lBQ0Y7UUFDRjtRQUVBLE9BQU9MLFlBQVk7SUFDckI7SUFFUWhELDBCQUEwQjNCLElBQVcsRUFBRWMsTUFBd0IsRUFBZTtRQUNwRixNQUFNWSxXQUF3QixFQUFFO1FBRWhDLElBQUlaLE9BQU9TLFlBQVksS0FBSyxVQUFVO1lBQ3BDLHdCQUF3QjtZQUN4QixJQUFJdkIsS0FBS21GLE1BQU0sSUFBSSxHQUFHO2dCQUNwQixNQUFNQyxhQUFhcEYsS0FBS3FGLEtBQUssQ0FBQyxDQUFDO2dCQUMvQixNQUFNQyxlQUFldEYsS0FBS3FGLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQztnQkFFdEMsTUFBTUUsWUFBWUgsV0FBV0ksTUFBTSxDQUFDLENBQUNDLEtBQUtDLElBQU1ELE1BQU1DLEVBQUVDLE9BQU8sRUFBRSxLQUFLUCxXQUFXRCxNQUFNO2dCQUN2RixNQUFNUyxjQUFjTixhQUFhRSxNQUFNLENBQUMsQ0FBQ0MsS0FBS0MsSUFBTUQsTUFBTUMsRUFBRUMsT0FBTyxFQUFFLEtBQUtMLGFBQWFILE1BQU07Z0JBRTdGLE1BQU1VLGdCQUFnQixDQUFFTixZQUFZSyxXQUFVLElBQUtBLGNBQWU7Z0JBRWxFbEUsU0FBU29DLElBQUksQ0FBQztvQkFDWmdDLElBQUksQ0FBQyxNQUFNLEVBQUU5RCxLQUFLK0QsR0FBRyxHQUFHLENBQUM7b0JBQ3pCekIsTUFBTTtvQkFDTjBCLE9BQU8sQ0FBQyxRQUFRLEVBQUVILGdCQUFnQixJQUFJLFdBQVcsVUFBVSxTQUFTLENBQUM7b0JBQ3JFSSxhQUFhLENBQUMsWUFBWSxFQUFFSixnQkFBZ0IsSUFBSSxjQUFjLFlBQVksSUFBSSxFQUFFSyxLQUFLQyxHQUFHLENBQUNOLGVBQWVPLE9BQU8sQ0FBQyxHQUFHLGdDQUFnQyxDQUFDO29CQUNwSnJDLFlBQVltQyxLQUFLRyxHQUFHLENBQUNILEtBQUtDLEdBQUcsQ0FBQ04saUJBQWlCLElBQUk7b0JBQ25EUyxVQUFVVCxnQkFBZ0IsTUFBTUEsZ0JBQWdCLENBQUMsS0FBSyxTQUFTO29CQUMvRFUsVUFBVTtvQkFDVjVELGlCQUFpQjt3QkFDZmtELGdCQUFnQixLQUFLLGlEQUFpRDt3QkFDdEU7cUJBQ0Q7b0JBQ0Q5RCxZQUFZLElBQUlDLE9BQU9DLFdBQVc7Z0JBQ3BDO1lBQ0Y7UUFDRjtRQUVBLElBQUluQixPQUFPUyxZQUFZLEtBQUssYUFBYTtZQUN2QywyQkFBMkI7WUFDM0IsTUFBTWlGLFdBQVd4RyxLQUFLNkIsR0FBRyxDQUFDNkQsQ0FBQUEsSUFBS0EsRUFBRUMsT0FBTztZQUN4QyxNQUFNYyxPQUFPRCxTQUFTaEIsTUFBTSxDQUFDLENBQUNDLEtBQUtpQixJQUFNakIsTUFBTWlCLEdBQUcsS0FBS0YsU0FBU3JCLE1BQU07WUFDdEUsTUFBTXdCLFNBQVNULEtBQUtVLElBQUksQ0FBQ0osU0FBU2hCLE1BQU0sQ0FBQyxDQUFDQyxLQUFLaUIsSUFBTWpCLE1BQU1TLEtBQUtXLEdBQUcsQ0FBQ0gsSUFBSUQsTUFBTSxJQUFJLEtBQUtELFNBQVNyQixNQUFNO1lBRXRHbkYsS0FBSzhFLE9BQU8sQ0FBQyxDQUFDZ0MsT0FBT0M7Z0JBQ25CLE1BQU1DLFNBQVNkLEtBQUtDLEdBQUcsQ0FBQyxDQUFDVyxNQUFNbkIsT0FBTyxHQUFHYyxJQUFHLElBQUtFO2dCQUNqRCxJQUFJSyxTQUFTLEdBQUc7b0JBQ2R0RixTQUFTb0MsSUFBSSxDQUFDO3dCQUNaZ0MsSUFBSSxDQUFDLFFBQVEsRUFBRTlELEtBQUsrRCxHQUFHLEdBQUcsQ0FBQyxFQUFFZ0IsTUFBTSxDQUFDO3dCQUNwQ3pDLE1BQU07d0JBQ04wQixPQUFPLENBQUMsbUJBQW1CLEVBQUVjLE1BQU1HLElBQUksQ0FBQyxDQUFDO3dCQUN6Q2hCLGFBQWEsQ0FBQyxZQUFZLEVBQUVhLE1BQU1uQixPQUFPLENBQUN1QixjQUFjLEdBQUcsSUFBSSxFQUFFRixPQUFPWixPQUFPLENBQUMsR0FBRyxpQ0FBaUMsQ0FBQzt3QkFDckhyQyxZQUFZbUMsS0FBS0csR0FBRyxDQUFDVyxTQUFTLEdBQUc7d0JBQ2pDVixVQUFVVSxTQUFTLElBQUksU0FBUzt3QkFDaENULFVBQVU7d0JBQ1Y1RCxpQkFBaUI7NEJBQ2Y7NEJBQ0E7eUJBQ0Q7d0JBQ0RaLFlBQVksSUFBSUMsT0FBT0MsV0FBVztvQkFDcEM7Z0JBQ0Y7WUFDRjtRQUNGO1FBRUEsT0FBT1A7SUFDVDtJQUVRa0Isd0JBQXdCTixPQUFlLEVBQUV0QyxJQUFXLEVBQUVrRSxPQUE0QixFQUF3QjtRQUNoSCxNQUFNdkIsa0JBQXdDLEVBQUU7UUFFaEQsbUNBQW1DO1FBQ25DLE9BQVFMO1lBQ04sS0FBSztnQkFDSEssZ0JBQWdCbUIsSUFBSSxDQUFDO29CQUNuQmdDLElBQUksQ0FBQyxXQUFXLEVBQUU5RCxLQUFLK0QsR0FBRyxHQUFHLENBQUM7b0JBQzlCekIsTUFBTTtvQkFDTjBCLE9BQU87b0JBQ1BDLGFBQWE7b0JBQ2JrQixRQUFRO29CQUNSQyxRQUFRO29CQUNSYixVQUFVO29CQUNWaEQsU0FBUzt3QkFBQzt3QkFBbUI7cUJBQVU7b0JBQ3ZDOEQsc0JBQXNCO29CQUN0QkMsVUFBVTtvQkFDVnZGLFlBQVksSUFBSUMsT0FBT0MsV0FBVztnQkFDcEM7Z0JBQ0E7WUFFRixLQUFLO2dCQUNIVSxnQkFBZ0JtQixJQUFJLENBQUM7b0JBQ25CZ0MsSUFBSSxDQUFDLFlBQVksRUFBRTlELEtBQUsrRCxHQUFHLEdBQUcsQ0FBQztvQkFDL0J6QixNQUFNO29CQUNOMEIsT0FBTztvQkFDUEMsYUFBYTtvQkFDYmtCLFFBQVE7b0JBQ1JDLFFBQVE7b0JBQ1JiLFVBQVU7b0JBQ1ZoRCxTQUFTO3dCQUFDO3dCQUFzQjtxQkFBZ0I7b0JBQ2hEOEQsc0JBQXNCO29CQUN0QkMsVUFBVTtvQkFDVnZGLFlBQVksSUFBSUMsT0FBT0MsV0FBVztnQkFDcEM7Z0JBQ0E7UUFDSjtRQUVBLE9BQU9VO0lBQ1Q7SUFFUXlCLGlCQUFpQnRCLEtBQWEsRUFBeUU7UUFDN0csTUFBTXlFLGlCQUFpQnpFLE1BQU0wRSxXQUFXO1FBRXhDLCtCQUErQjtRQUMvQixJQUFJRCxlQUFlRSxRQUFRLENBQUMsV0FBV0YsZUFBZUUsUUFBUSxDQUFDLGNBQWNGLGVBQWVFLFFBQVEsQ0FBQyxRQUFRO1lBQzNHLE9BQU87Z0JBQUVuRCxNQUFNO2dCQUFnQm9ELFVBQVUsRUFBRTtnQkFBRUMsWUFBWSxDQUFDO1lBQUU7UUFDOUQ7UUFFQSxJQUFJSixlQUFlRSxRQUFRLENBQUMsY0FBY0YsZUFBZUUsUUFBUSxDQUFDLGFBQWE7WUFDN0UsT0FBTztnQkFBRW5ELE1BQU07Z0JBQW9Cb0QsVUFBVSxFQUFFO2dCQUFFQyxZQUFZLENBQUM7WUFBRTtRQUNsRTtRQUVBLElBQUlKLGVBQWVFLFFBQVEsQ0FBQyxjQUFjRixlQUFlRSxRQUFRLENBQUMsT0FBTztZQUN2RSxPQUFPO2dCQUFFbkQsTUFBTTtnQkFBc0JvRCxVQUFVLEVBQUU7Z0JBQUVDLFlBQVksQ0FBQztZQUFFO1FBQ3BFO1FBRUEsT0FBTztZQUFFckQsTUFBTTtZQUFXb0QsVUFBVSxFQUFFO1lBQUVDLFlBQVksQ0FBQztRQUFFO0lBQ3pEO0lBRUEsTUFBY3BELGtCQUFrQkosTUFBVyxFQUFFRCxPQUFvQixFQUFnQjtRQUMvRSx1QkFBdUI7UUFDdkIsT0FBTztZQUNMSSxNQUFNO1lBQ056RSxTQUFTO1lBQ1QrSCxhQUFhO2dCQUFDO2dCQUFxQjtnQkFBd0I7YUFBMkI7UUFDeEY7SUFDRjtJQUVBLE1BQWNwRCxzQkFBc0JMLE1BQVcsRUFBRUQsT0FBb0IsRUFBZ0I7UUFDbkYsMkJBQTJCO1FBQzNCLE9BQU87WUFDTEksTUFBTTtZQUNOekUsU0FBUztZQUNUK0gsYUFBYTtnQkFBQztnQkFBa0I7Z0JBQXFCO2FBQXNCO1FBQzdFO0lBQ0Y7SUFFQSxNQUFjbkQsd0JBQXdCTixNQUFXLEVBQUVELE9BQW9CLEVBQWdCO1FBQ3JGLDZCQUE2QjtRQUM3QixPQUFPO1lBQ0xJLE1BQU07WUFDTnpFLFNBQVM7WUFDVCtILGFBQWE7Z0JBQUM7Z0JBQW1CO2dCQUEyQjthQUFzQjtRQUNwRjtJQUNGO0lBRUEsTUFBY2xELG1CQUFtQjVCLEtBQWEsRUFBRW9CLE9BQW9CLEVBQWdCO1FBQ2xGLHlCQUF5QjtRQUN6QixPQUFPO1lBQ0xJLE1BQU07WUFDTnpFLFNBQVMsQ0FBQyxrQ0FBa0MsRUFBRWlELE1BQU0sbUVBQW1FLENBQUM7WUFDeEg4RSxhQUFhO2dCQUFDO2dCQUE4QjtnQkFBMEI7YUFBdUI7UUFDL0Y7SUFDRjtJQUVRL0QsdUJBQXVCN0QsSUFBVyxFQUFFaUQsTUFBYyxFQUFFNEUsSUFBWSxFQUFTO1FBQy9FLG9DQUFvQztRQUNwQyxNQUFNQyxTQUFTOUgsS0FBSzZCLEdBQUcsQ0FBQyxDQUFDNkQsR0FBR3FDLElBQU87Z0JBQUVDLEdBQUdEO2dCQUFHRSxHQUFHdkMsQ0FBQyxDQUFDekMsT0FBTztZQUFDO1FBRXhELDhCQUE4QjtRQUM5QixNQUFNaUYsSUFBSUosT0FBTzNDLE1BQU07UUFDdkIsTUFBTWdELE9BQU9MLE9BQU90QyxNQUFNLENBQUMsQ0FBQ0MsS0FBSzJDLElBQU0zQyxNQUFNMkMsRUFBRUosQ0FBQyxFQUFFO1FBQ2xELE1BQU1LLE9BQU9QLE9BQU90QyxNQUFNLENBQUMsQ0FBQ0MsS0FBSzJDLElBQU0zQyxNQUFNMkMsRUFBRUgsQ0FBQyxFQUFFO1FBQ2xELE1BQU1LLFFBQVFSLE9BQU90QyxNQUFNLENBQUMsQ0FBQ0MsS0FBSzJDLElBQU0zQyxNQUFNMkMsRUFBRUosQ0FBQyxHQUFHSSxFQUFFSCxDQUFDLEVBQUU7UUFDekQsTUFBTU0sUUFBUVQsT0FBT3RDLE1BQU0sQ0FBQyxDQUFDQyxLQUFLMkMsSUFBTTNDLE1BQU0yQyxFQUFFSixDQUFDLEdBQUdJLEVBQUVKLENBQUMsRUFBRTtRQUV6RCxNQUFNUSxRQUFRLENBQUNOLElBQUlJLFFBQVFILE9BQU9FLElBQUcsSUFBTUgsQ0FBQUEsSUFBSUssUUFBUUosT0FBT0EsSUFBRztRQUNqRSxNQUFNTSxZQUFZLENBQUNKLE9BQU9HLFFBQVFMLElBQUcsSUFBS0Q7UUFFMUMsMkJBQTJCO1FBQzNCLE1BQU10RSxXQUFXLEVBQUU7UUFDbkIsSUFBSyxJQUFJbUUsSUFBSSxHQUFHQSxJQUFJRixNQUFNRSxJQUFLO1lBQzdCLE1BQU1DLElBQUlFLElBQUlIO1lBQ2QsTUFBTUUsSUFBSU8sUUFBUVIsSUFBSVM7WUFDdEI3RSxTQUFTRSxJQUFJLENBQUM7Z0JBQ1o0RSxLQUFLWCxJQUFJO2dCQUNUWSxpQkFBaUJ6QyxLQUFLMEMsR0FBRyxDQUFDLEdBQUdYO2dCQUM3QmxFLFlBQVltQyxLQUFLMEMsR0FBRyxDQUFDLEdBQUcsSUFBSSxJQUFLZixPQUFRLEtBQUssa0NBQWtDO1lBQ2xGO1FBQ0Y7UUFFQSxPQUFPakU7SUFDVDtJQUVRSSw0QkFBNEJoRSxJQUFXLEVBQVU7UUFDdkQsNkNBQTZDO1FBQzdDLElBQUlBLEtBQUttRixNQUFNLEdBQUcsR0FBRyxPQUFPO1FBRTVCLE1BQU0wRCxTQUFTN0ksS0FBSzZCLEdBQUcsQ0FBQzZELENBQUFBLElBQUtBLEVBQUVDLE9BQU8sSUFBSUQsRUFBRW9ELEtBQUssSUFBSTtRQUNyRCxNQUFNckMsT0FBT29DLE9BQU9yRCxNQUFNLENBQUMsQ0FBQ0MsS0FBS3NELElBQU10RCxNQUFNc0QsR0FBRyxLQUFLRixPQUFPMUQsTUFBTTtRQUVsRSxNQUFNNkQsaUJBQWlCSCxPQUFPckQsTUFBTSxDQUFDLENBQUNDLEtBQUtzRCxJQUFNdEQsTUFBTVMsS0FBS1csR0FBRyxDQUFDa0MsSUFBSXRDLE1BQU0sSUFBSTtRQUM5RSxNQUFNd0MsUUFBUSxJQUFJLENBQUNDLGtCQUFrQixDQUFDTDtRQUN0QyxNQUFNTSxxQkFBcUJOLE9BQU9yRCxNQUFNLENBQUMsQ0FBQ0MsS0FBS3NELEdBQUdoQixJQUFNdEMsTUFBTVMsS0FBS1csR0FBRyxDQUFDb0MsS0FBSyxDQUFDbEIsRUFBRSxHQUFHdEIsTUFBTSxJQUFJO1FBRTVGLE1BQU0yQyxXQUFXRCxxQkFBcUJIO1FBQ3RDLE9BQU85QyxLQUFLRyxHQUFHLENBQUNILEtBQUswQyxHQUFHLENBQUNRLFVBQVUsTUFBTSxNQUFNLHFCQUFxQjs7SUFDdEU7SUFFUUYsbUJBQW1CTCxNQUFnQixFQUFZO1FBQ3JELE1BQU1YLElBQUlXLE9BQU8xRCxNQUFNO1FBQ3ZCLE1BQU1nRCxPQUFPLElBQU1ELENBQUFBLElBQUksS0FBTTtRQUM3QixNQUFNRyxPQUFPUSxPQUFPckQsTUFBTSxDQUFDLENBQUNDLEtBQUtzRCxJQUFNdEQsTUFBTXNELEdBQUc7UUFDaEQsTUFBTVQsUUFBUU8sT0FBT3JELE1BQU0sQ0FBQyxDQUFDQyxLQUFLc0QsR0FBR2hCLElBQU10QyxNQUFNc0MsSUFBSWdCLEdBQUc7UUFDeEQsTUFBTVIsUUFBUSxJQUFNTCxDQUFBQSxJQUFJLEtBQU0sS0FBSUEsSUFBSSxLQUFNO1FBRTVDLE1BQU1NLFFBQVEsQ0FBQ04sSUFBSUksUUFBUUgsT0FBT0UsSUFBRyxJQUFNSCxDQUFBQSxJQUFJSyxRQUFRSixPQUFPQSxJQUFHO1FBQ2pFLE1BQU1NLFlBQVksQ0FBQ0osT0FBT0csUUFBUUwsSUFBRyxJQUFLRDtRQUUxQyxPQUFPVyxPQUFPaEgsR0FBRyxDQUFDLENBQUN3SCxHQUFHdEIsSUFBTVMsUUFBUVQsSUFBSVU7SUFDMUM7QUFDRjtBQUVBLGlFQUFlOUksS0FBS0EsRUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL3Njb3V0LWRhc2hib2FyZC1uZXh0anMvLi9saWIvZGFsL2FpLnRzPzY0YTgiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBSS9MTE0gRGF0YSBBY2Nlc3MgTGF5ZXJcbiAqIEhhbmRsZXMgQUktcG93ZXJlZCBhbmFseXRpY3MsIGluc2lnaHRzLCBhbmQgY2hhdCBmdW5jdGlvbmFsaXR5XG4gKi9cblxuaW1wb3J0IEJhc2VEQUwgZnJvbSAnLi9iYXNlJ1xuaW1wb3J0IHsgQ2hhdE1lc3NhZ2UsIEFJSW5zaWdodCwgUmVjb21tZW5kYXRpb25EYXRhIH0gZnJvbSAnQC9saWIvdHlwZXMvYWknXG5cbmV4cG9ydCBpbnRlcmZhY2UgQUlBbmFseXNpc1BhcmFtcyB7XG4gIGNvbnRleHQ6IHN0cmluZ1xuICBmaWx0ZXJzPzogUmVjb3JkPHN0cmluZywgYW55PlxuICBhbmFseXNpc1R5cGU6ICd0cmVuZHMnIHwgJ2Fub21hbGllcycgfCAncHJlZGljdGlvbnMnIHwgJ3JlY29tbWVuZGF0aW9ucydcbiAgdGltZWZyYW1lPzogc3RyaW5nXG4gIGNvbmZpZGVuY2VUaHJlc2hvbGQ/OiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDaGF0Q29udGV4dCB7XG4gIGNvbnZlcnNhdGlvbklkOiBzdHJpbmdcbiAgdXNlckNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4gIGRhc2hib2FyZFN0YXRlPzogUmVjb3JkPHN0cmluZywgYW55PlxuICBwcmV2aW91c01lc3NhZ2VzPzogQ2hhdE1lc3NhZ2VbXVxufVxuXG5jbGFzcyBBSURBTCBleHRlbmRzIEJhc2VEQUwge1xuXG4gIC8qKlxuICAgKiBTdG9yZSBhbmQgcmV0cmlldmUgY2hhdCBtZXNzYWdlc1xuICAgKi9cbiAgYXN5bmMgc3RvcmVDaGF0TWVzc2FnZShtZXNzYWdlOiBDaGF0TWVzc2FnZSk6IFByb21pc2U8eyBkYXRhOiBDaGF0TWVzc2FnZSB8IG51bGw7IGVycm9yOiBzdHJpbmcgfCBudWxsIH0+IHtcbiAgICByZXR1cm4gdGhpcy5leGVjdXRlUXVlcnk8Q2hhdE1lc3NhZ2U+KFxuICAgICAgYXN5bmMgKGNsaWVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBjbGllbnRcbiAgICAgICAgICAuZnJvbSgncGxhdGludW0uY2hhdF9tZXNzYWdlcycpXG4gICAgICAgICAgLmluc2VydChbbWVzc2FnZV0pXG4gICAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgICAgLnNpbmdsZSgpXG5cbiAgICAgICAgcmV0dXJuIHsgZGF0YSwgZXJyb3IgfVxuICAgICAgfVxuICAgIClcbiAgfVxuXG4gIGFzeW5jIGdldENoYXRIaXN0b3J5KGNvbnZlcnNhdGlvbklkOiBzdHJpbmcsIGxpbWl0OiBudW1iZXIgPSA1MCk6IFByb21pc2U8eyBkYXRhOiBDaGF0TWVzc2FnZVtdIHwgbnVsbDsgZXJyb3I6IHN0cmluZyB8IG51bGwgfT4ge1xuICAgIGNvbnN0IGNhY2hlS2V5ID0gYGNoYXRfaGlzdG9yeV8ke2NvbnZlcnNhdGlvbklkfWBcbiAgICBcbiAgICByZXR1cm4gdGhpcy5leGVjdXRlUXVlcnk8Q2hhdE1lc3NhZ2VbXT4oXG4gICAgICBhc3luYyAoY2xpZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGNsaWVudFxuICAgICAgICAgIC5mcm9tKCdwbGF0aW51bS5jaGF0X21lc3NhZ2VzJylcbiAgICAgICAgICAuc2VsZWN0KCcqJylcbiAgICAgICAgICAuZXEoJ2NvbnZlcnNhdGlvbl9pZCcsIGNvbnZlcnNhdGlvbklkKVxuICAgICAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICAgICAgLmxpbWl0KGxpbWl0KVxuXG4gICAgICAgIHJldHVybiB7IGRhdGEsIGVycm9yIH1cbiAgICAgIH0sXG4gICAgICBjYWNoZUtleSxcbiAgICAgIDYwMDAwIC8vIDEgbWludXRlIGNhY2hlIGZvciBjaGF0XG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIEFJIGluc2lnaHRzIGZyb20gdHJhbnNhY3Rpb24gZGF0YVxuICAgKi9cbiAgYXN5bmMgZ2VuZXJhdGVJbnNpZ2h0cyhwYXJhbXM6IEFJQW5hbHlzaXNQYXJhbXMpOiBQcm9taXNlPHsgZGF0YTogQUlJbnNpZ2h0W10gfCBudWxsOyBlcnJvcjogc3RyaW5nIHwgbnVsbCB9PiB7XG4gICAgY29uc3QgY2FjaGVLZXkgPSBgaW5zaWdodHNfJHtKU09OLnN0cmluZ2lmeShwYXJhbXMpfWBcbiAgICBcbiAgICByZXR1cm4gdGhpcy5leGVjdXRlUXVlcnk8QUlJbnNpZ2h0W10+KFxuICAgICAgYXN5bmMgKGNsaWVudCkgPT4ge1xuICAgICAgICAvLyBGaXJzdCwgZ2V0IHRoZSBkYXRhIGNvbnRleHQgZm9yIEFJIGFuYWx5c2lzXG4gICAgICAgIGNvbnN0IGNvbnRleHRRdWVyeSA9IHRoaXMuYnVpbGRDb250ZXh0UXVlcnkocGFyYW1zKVxuICAgICAgICBjb25zdCB7IGRhdGE6IGNvbnRleHREYXRhLCBlcnJvcjogY29udGV4dEVycm9yIH0gPSBhd2FpdCBjbGllbnQucnBjKCdnZXRfYWlfY29udGV4dCcsIHtcbiAgICAgICAgICBhbmFseXNpc190eXBlOiBwYXJhbXMuYW5hbHlzaXNUeXBlLFxuICAgICAgICAgIGZpbHRlcnM6IHBhcmFtcy5maWx0ZXJzIHx8IHt9LFxuICAgICAgICAgIHRpbWVmcmFtZTogcGFyYW1zLnRpbWVmcmFtZSB8fCAnMzBkJ1xuICAgICAgICB9KVxuXG4gICAgICAgIGlmIChjb250ZXh0RXJyb3IpIHtcbiAgICAgICAgICByZXR1cm4geyBkYXRhOiBudWxsLCBlcnJvcjogY29udGV4dEVycm9yIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvciBub3csIGdlbmVyYXRlIHJ1bGUtYmFzZWQgaW5zaWdodHNcbiAgICAgICAgLy8gSW4gcHJvZHVjdGlvbiwgdGhpcyB3b3VsZCBjYWxsIE9wZW5BSS9BbnRocm9waWMgQVBJc1xuICAgICAgICBjb25zdCBpbnNpZ2h0cyA9IHRoaXMuZ2VuZXJhdGVSdWxlQmFzZWRJbnNpZ2h0cyhjb250ZXh0RGF0YSwgcGFyYW1zKVxuICAgICAgICBcbiAgICAgICAgLy8gU3RvcmUgaW5zaWdodHMgZm9yIHRyYWNraW5nXG4gICAgICAgIGNvbnN0IHsgZXJyb3I6IHN0b3JlRXJyb3IgfSA9IGF3YWl0IGNsaWVudFxuICAgICAgICAgIC5mcm9tKCdwbGF0aW51bS5haV9pbnNpZ2h0cycpXG4gICAgICAgICAgLmluc2VydChpbnNpZ2h0cy5tYXAoaW5zaWdodCA9PiAoe1xuICAgICAgICAgICAgLi4uaW5zaWdodCxcbiAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIGFuYWx5c2lzX3BhcmFtczogcGFyYW1zXG4gICAgICAgICAgfSkpKVxuXG4gICAgICAgIGlmIChzdG9yZUVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gc3RvcmUgaW5zaWdodHM6Jywgc3RvcmVFcnJvcilcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IGRhdGE6IGluc2lnaHRzLCBlcnJvcjogbnVsbCB9XG4gICAgICB9LFxuICAgICAgY2FjaGVLZXksXG4gICAgICA2MDAwMDAgLy8gMTAgbWludXRlcyBjYWNoZVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgQUktcG93ZXJlZCByZWNvbW1lbmRhdGlvbnNcbiAgICovXG4gIGFzeW5jIGdldFJlY29tbWVuZGF0aW9ucyhcbiAgICBzZWN0aW9uOiBzdHJpbmcsIFxuICAgIHVzZXJDb250ZXh0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge31cbiAgKTogUHJvbWlzZTx7IGRhdGE6IFJlY29tbWVuZGF0aW9uRGF0YVtdIHwgbnVsbDsgZXJyb3I6IHN0cmluZyB8IG51bGwgfT4ge1xuICAgIGNvbnN0IGNhY2hlS2V5ID0gYHJlY29tbWVuZGF0aW9uc18ke3NlY3Rpb259XyR7SlNPTi5zdHJpbmdpZnkodXNlckNvbnRleHQpfWBcbiAgICBcbiAgICByZXR1cm4gdGhpcy5leGVjdXRlUXVlcnk8UmVjb21tZW5kYXRpb25EYXRhW10+KFxuICAgICAgYXN5bmMgKGNsaWVudCkgPT4ge1xuICAgICAgICAvLyBHZXQgcmVjZW50IHBlcmZvcm1hbmNlIGRhdGEgZm9yIHJlY29tbWVuZGF0aW9uc1xuICAgICAgICBjb25zdCB7IGRhdGE6IHBlcmZvcm1hbmNlRGF0YSwgZXJyb3I6IHBlcmZFcnJvciB9ID0gYXdhaXQgY2xpZW50LnJwYygnZ2V0X3JlY29tbWVuZGF0aW9uX2NvbnRleHQnLCB7XG4gICAgICAgICAgc2VjdGlvbixcbiAgICAgICAgICB1c2VyX2NvbnRleHQ6IHVzZXJDb250ZXh0XG4gICAgICAgIH0pXG5cbiAgICAgICAgaWYgKHBlcmZFcnJvcikge1xuICAgICAgICAgIHJldHVybiB7IGRhdGE6IG51bGwsIGVycm9yOiBwZXJmRXJyb3IgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2VuZXJhdGUgY29udGV4dHVhbCByZWNvbW1lbmRhdGlvbnNcbiAgICAgICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gdGhpcy5nZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyhzZWN0aW9uLCBwZXJmb3JtYW5jZURhdGEsIHVzZXJDb250ZXh0KVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHsgZGF0YTogcmVjb21tZW5kYXRpb25zLCBlcnJvcjogbnVsbCB9XG4gICAgICB9LFxuICAgICAgY2FjaGVLZXksXG4gICAgICAzMDAwMDAgLy8gNSBtaW51dGVzIGNhY2hlXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm0gc2VtYW50aWMgc2VhcmNoIGFjcm9zcyB0cmFuc2FjdGlvbiBkYXRhIGFuZCBpbnNpZ2h0c1xuICAgKi9cbiAgYXN5bmMgc2VtYW50aWNTZWFyY2gocXVlcnk6IHN0cmluZywgZmlsdGVyczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9KTogUHJvbWlzZTx7IGRhdGE6IGFueVtdIHwgbnVsbDsgZXJyb3I6IHN0cmluZyB8IG51bGwgfT4ge1xuICAgIGNvbnN0IGNhY2hlS2V5ID0gYHNlbWFudGljXyR7cXVlcnl9XyR7SlNPTi5zdHJpbmdpZnkoZmlsdGVycyl9YFxuICAgIFxuICAgIHJldHVybiB0aGlzLmV4ZWN1dGVRdWVyeTxhbnlbXT4oXG4gICAgICBhc3luYyAoY2xpZW50KSA9PiB7XG4gICAgICAgIC8vIFVzZSBQb3N0Z3JlU1FMIGZ1bGwtdGV4dCBzZWFyY2ggZm9yIG5vd1xuICAgICAgICAvLyBJbiBwcm9kdWN0aW9uLCB0aGlzIHdvdWxkIHVzZSB2ZWN0b3IgZW1iZWRkaW5nc1xuICAgICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBjbGllbnQucnBjKCdzZW1hbnRpY19zZWFyY2gnLCB7XG4gICAgICAgICAgc2VhcmNoX3F1ZXJ5OiBxdWVyeSxcbiAgICAgICAgICBmaWx0ZXJzOiBmaWx0ZXJzLFxuICAgICAgICAgIGxpbWl0OiAyMFxuICAgICAgICB9KVxuXG4gICAgICAgIHJldHVybiB7IGRhdGEsIGVycm9yIH1cbiAgICAgIH0sXG4gICAgICBjYWNoZUtleSxcbiAgICAgIDMwMDAwMCAvLyA1IG1pbnV0ZXMgY2FjaGVcbiAgICApXG4gIH1cblxuICAvKipcbiAgICogRGV0ZWN0IGFub21hbGllcyBpbiB0cmFuc2FjdGlvbiBwYXR0ZXJuc1xuICAgKi9cbiAgYXN5bmMgZGV0ZWN0QW5vbWFsaWVzKFxuICAgIG1ldHJpYzogc3RyaW5nID0gJ3NhbGVzJyxcbiAgICB0aW1lZnJhbWU6IHN0cmluZyA9ICc3ZCcsXG4gICAgc2Vuc2l0aXZpdHk6IG51bWJlciA9IDIuMFxuICApOiBQcm9taXNlPHsgZGF0YTogYW55W10gfCBudWxsOyBlcnJvcjogc3RyaW5nIHwgbnVsbCB9PiB7XG4gICAgY29uc3QgY2FjaGVLZXkgPSBgYW5vbWFsaWVzXyR7bWV0cmljfV8ke3RpbWVmcmFtZX1fJHtzZW5zaXRpdml0eX1gXG4gICAgXG4gICAgcmV0dXJuIHRoaXMuZXhlY3V0ZVF1ZXJ5PGFueVtdPihcbiAgICAgIGFzeW5jIChjbGllbnQpID0+IHtcbiAgICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgY2xpZW50LnJwYygnZGV0ZWN0X2Fub21hbGllcycsIHtcbiAgICAgICAgICBtZXRyaWNfbmFtZTogbWV0cmljLFxuICAgICAgICAgIHRpbWVfd2luZG93OiB0aW1lZnJhbWUsXG4gICAgICAgICAgc2Vuc2l0aXZpdHlfdGhyZXNob2xkOiBzZW5zaXRpdml0eVxuICAgICAgICB9KVxuXG4gICAgICAgIHJldHVybiB7IGRhdGEsIGVycm9yIH1cbiAgICAgIH0sXG4gICAgICBjYWNoZUtleSxcbiAgICAgIDYwMDAwMCAvLyAxMCBtaW51dGVzIGNhY2hlXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHByZWRpY3Rpb25zIGZvciBidXNpbmVzcyBtZXRyaWNzXG4gICAqL1xuICBhc3luYyBnZW5lcmF0ZVByZWRpY3Rpb25zKFxuICAgIG1ldHJpY3M6IHN0cmluZ1tdLFxuICAgIGZvcmVjYXN0RGF5czogbnVtYmVyID0gMzBcbiAgKTogUHJvbWlzZTx7IGRhdGE6IGFueVtdIHwgbnVsbDsgZXJyb3I6IHN0cmluZyB8IG51bGwgfT4ge1xuICAgIGNvbnN0IGNhY2hlS2V5ID0gYHByZWRpY3Rpb25zXyR7bWV0cmljcy5qb2luKCcsJyl9XyR7Zm9yZWNhc3REYXlzfWBcbiAgICBcbiAgICByZXR1cm4gdGhpcy5leGVjdXRlUXVlcnk8YW55W10+KFxuICAgICAgYXN5bmMgKGNsaWVudCkgPT4ge1xuICAgICAgICAvLyBTaW1wbGUgbGluZWFyIHJlZ3Jlc3Npb24gZm9yIG5vd1xuICAgICAgICAvLyBJbiBwcm9kdWN0aW9uLCB1c2UgbW9yZSBzb3BoaXN0aWNhdGVkIE1MIG1vZGVsc1xuICAgICAgICBjb25zdCBwcmVkaWN0aW9ucyA9IFtdXG4gICAgICAgIFxuICAgICAgICBmb3IgKGNvbnN0IG1ldHJpYyBvZiBtZXRyaWNzKSB7XG4gICAgICAgICAgY29uc3QgeyBkYXRhOiBoaXN0b3JpY2FsRGF0YSwgZXJyb3IgfSA9IGF3YWl0IGNsaWVudFxuICAgICAgICAgICAgLmZyb20oJ3ZfdHJlbmRzX2RhaWx5JylcbiAgICAgICAgICAgIC5zZWxlY3QoYGRheSwgJHttZXRyaWN9YClcbiAgICAgICAgICAgIC5vcmRlcignZGF5JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICAgICAgICAubGltaXQoOTApIC8vIFVzZSA5MCBkYXlzIGZvciB0cmVuZCBhbmFseXNpc1xuXG4gICAgICAgICAgaWYgKGVycm9yKSBjb250aW51ZVxuXG4gICAgICAgICAgY29uc3QgZm9yZWNhc3QgPSB0aGlzLmdlbmVyYXRlTGluZWFyRm9yZWNhc3QoaGlzdG9yaWNhbERhdGEsIG1ldHJpYywgZm9yZWNhc3REYXlzKVxuICAgICAgICAgIHByZWRpY3Rpb25zLnB1c2goe1xuICAgICAgICAgICAgbWV0cmljLFxuICAgICAgICAgICAgZm9yZWNhc3QsXG4gICAgICAgICAgICBjb25maWRlbmNlOiB0aGlzLmNhbGN1bGF0ZUZvcmVjYXN0Q29uZmlkZW5jZShoaXN0b3JpY2FsRGF0YSlcbiAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgZGF0YTogcHJlZGljdGlvbnMsIGVycm9yOiBudWxsIH1cbiAgICAgIH0sXG4gICAgICBjYWNoZUtleSxcbiAgICAgIDE4MDAwMDAgLy8gMzAgbWludXRlcyBjYWNoZVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNzIG5hdHVyYWwgbGFuZ3VhZ2UgcXVlcnkgZm9yIGRhc2hib2FyZCBpbnNpZ2h0c1xuICAgKi9cbiAgYXN5bmMgcHJvY2Vzc05hdHVyYWxMYW5ndWFnZVF1ZXJ5KFxuICAgIHF1ZXJ5OiBzdHJpbmcsXG4gICAgY29udGV4dDogQ2hhdENvbnRleHRcbiAgKTogUHJvbWlzZTx7IGRhdGE6IGFueSB8IG51bGw7IGVycm9yOiBzdHJpbmcgfCBudWxsIH0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gUGFyc2UgaW50ZW50IGZyb20gcXVlcnlcbiAgICAgIGNvbnN0IGludGVudCA9IHRoaXMucGFyc2VRdWVyeUludGVudChxdWVyeSlcbiAgICAgIFxuICAgICAgLy8gR2VuZXJhdGUgYXBwcm9wcmlhdGUgcmVzcG9uc2UgYmFzZWQgb24gaW50ZW50XG4gICAgICBsZXQgcmVzcG9uc2VcbiAgICAgIHN3aXRjaCAoaW50ZW50LnR5cGUpIHtcbiAgICAgICAgY2FzZSAnZGF0YV9yZXF1ZXN0JzpcbiAgICAgICAgICByZXNwb25zZSA9IGF3YWl0IHRoaXMuaGFuZGxlRGF0YVJlcXVlc3QoaW50ZW50LCBjb250ZXh0KVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgJ2FuYWx5c2lzX3JlcXVlc3QnOlxuICAgICAgICAgIHJlc3BvbnNlID0gYXdhaXQgdGhpcy5oYW5kbGVBbmFseXNpc1JlcXVlc3QoaW50ZW50LCBjb250ZXh0KVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgJ2NvbXBhcmlzb25fcmVxdWVzdCc6XG4gICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmhhbmRsZUNvbXBhcmlzb25SZXF1ZXN0KGludGVudCwgY29udGV4dClcbiAgICAgICAgICBicmVha1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJlc3BvbnNlID0gYXdhaXQgdGhpcy5oYW5kbGVHZW5lcmFsUXVlcnkocXVlcnksIGNvbnRleHQpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7IGRhdGE6IHJlc3BvbnNlLCBlcnJvcjogbnVsbCB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7IGRhdGE6IG51bGwsIGVycm9yOiAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2UgfVxuICAgIH1cbiAgfVxuXG4gIC8vIFByaXZhdGUgaGVscGVyIG1ldGhvZHNcbiAgcHJpdmF0ZSBidWlsZENvbnRleHRRdWVyeShwYXJhbXM6IEFJQW5hbHlzaXNQYXJhbXMpOiBzdHJpbmcge1xuICAgIC8vIEJ1aWxkIFNRTCBxdWVyeSBiYXNlZCBvbiBhbmFseXNpcyBwYXJhbWV0ZXJzXG4gICAgY29uc3QgYmFzZVF1ZXJ5ID0gYFxuICAgICAgU0VMRUNUIFxuICAgICAgICBEQVRFX1RSVU5DKCdkYXknLCB0aW1lc3RhbXApIGFzIGRhdGUsXG4gICAgICAgIENPVU5UKCopIGFzIHRyYW5zYWN0aW9ucyxcbiAgICAgICAgU1VNKHBlc29fdmFsdWUpIGFzIHJldmVudWUsXG4gICAgICAgIEFWRyhwZXNvX3ZhbHVlKSBhcyBhdmdfb3JkZXJfdmFsdWUsXG4gICAgICAgIENPVU5UKERJU1RJTkNUIHN0b3JlX2lkKSBhcyB1bmlxdWVfc3RvcmVzXG4gICAgICBGUk9NIHRyYW5zYWN0aW9uc1xuICAgICAgV0hFUkUgdGltZXN0YW1wID49IE5PVygpIC0gSU5URVJWQUwgJyR7cGFyYW1zLnRpbWVmcmFtZSB8fCAnMzBkJ30nXG4gICAgYFxuICAgIFxuICAgIGlmIChwYXJhbXMuZmlsdGVycykge1xuICAgICAgLy8gQWRkIGZpbHRlciBjb25kaXRpb25zXG4gICAgICBPYmplY3QuZW50cmllcyhwYXJhbXMuZmlsdGVycykuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgIGJhc2VRdWVyeSArIGAgQU5EICR7a2V5fSA9IEFOWSgkJHt2YWx1ZX0pYFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGJhc2VRdWVyeSArIGAgQU5EICR7a2V5fSA9ICcke3ZhbHVlfSdgXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBiYXNlUXVlcnkgKyAnIEdST1VQIEJZIERBVEVfVFJVTkMoXFwnZGF5XFwnLCB0aW1lc3RhbXApIE9SREVSIEJZIGRhdGUnXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlUnVsZUJhc2VkSW5zaWdodHMoZGF0YTogYW55W10sIHBhcmFtczogQUlBbmFseXNpc1BhcmFtcyk6IEFJSW5zaWdodFtdIHtcbiAgICBjb25zdCBpbnNpZ2h0czogQUlJbnNpZ2h0W10gPSBbXVxuICAgIFxuICAgIGlmIChwYXJhbXMuYW5hbHlzaXNUeXBlID09PSAndHJlbmRzJykge1xuICAgICAgLy8gRGV0ZWN0IHRyZW5kIHBhdHRlcm5zXG4gICAgICBpZiAoZGF0YS5sZW5ndGggPj0gNykge1xuICAgICAgICBjb25zdCByZWNlbnRXZWVrID0gZGF0YS5zbGljZSgtNylcbiAgICAgICAgY29uc3QgcHJldmlvdXNXZWVrID0gZGF0YS5zbGljZSgtMTQsIC03KVxuICAgICAgICBcbiAgICAgICAgY29uc3QgcmVjZW50QXZnID0gcmVjZW50V2Vlay5yZWR1Y2UoKHN1bSwgZCkgPT4gc3VtICsgZC5yZXZlbnVlLCAwKSAvIHJlY2VudFdlZWsubGVuZ3RoXG4gICAgICAgIGNvbnN0IHByZXZpb3VzQXZnID0gcHJldmlvdXNXZWVrLnJlZHVjZSgoc3VtLCBkKSA9PiBzdW0gKyBkLnJldmVudWUsIDApIC8gcHJldmlvdXNXZWVrLmxlbmd0aFxuICAgICAgICBcbiAgICAgICAgY29uc3QgY2hhbmdlUGVyY2VudCA9ICgocmVjZW50QXZnIC0gcHJldmlvdXNBdmcpIC8gcHJldmlvdXNBdmcpICogMTAwXG4gICAgICAgIFxuICAgICAgICBpbnNpZ2h0cy5wdXNoKHtcbiAgICAgICAgICBpZDogYHRyZW5kXyR7RGF0ZS5ub3coKX1gLFxuICAgICAgICAgIHR5cGU6ICd0cmVuZCcsXG4gICAgICAgICAgdGl0bGU6IGBSZXZlbnVlICR7Y2hhbmdlUGVyY2VudCA+IDAgPyAnR3Jvd3RoJyA6ICdEZWNsaW5lJ30gRGV0ZWN0ZWRgLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBgUmV2ZW51ZSBoYXMgJHtjaGFuZ2VQZXJjZW50ID4gMCA/ICdpbmNyZWFzZWQnIDogJ2RlY3JlYXNlZCd9IGJ5ICR7TWF0aC5hYnMoY2hhbmdlUGVyY2VudCkudG9GaXhlZCgxKX0lIGNvbXBhcmVkIHRvIHRoZSBwcmV2aW91cyB3ZWVrLmAsXG4gICAgICAgICAgY29uZmlkZW5jZTogTWF0aC5taW4oTWF0aC5hYnMoY2hhbmdlUGVyY2VudCkgLyAxMCwgMSksXG4gICAgICAgICAgcHJpb3JpdHk6IGNoYW5nZVBlcmNlbnQgPiAxNSB8fCBjaGFuZ2VQZXJjZW50IDwgLTEwID8gJ2hpZ2gnIDogJ21lZGl1bScsXG4gICAgICAgICAgY2F0ZWdvcnk6ICdmaW5hbmNpYWwnLFxuICAgICAgICAgIHJlY29tbWVuZGF0aW9uczogW1xuICAgICAgICAgICAgY2hhbmdlUGVyY2VudCA+IDE1ID8gJ0FuYWx5emUgc3VjY2Vzc2Z1bCBzdHJhdGVnaWVzIGFuZCBzY2FsZSB0aGVtJyA6ICdJbnZlc3RpZ2F0ZSBmYWN0b3JzIGNhdXNpbmcgdGhlIGRlY2xpbmUnLFxuICAgICAgICAgICAgJ01vbml0b3IgY2xvc2VseSBmb3IgY29udGludWVkIHRyZW5kJ1xuICAgICAgICAgIF0sXG4gICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGlmIChwYXJhbXMuYW5hbHlzaXNUeXBlID09PSAnYW5vbWFsaWVzJykge1xuICAgICAgLy8gRGV0ZWN0IGFub21hbGllcyBpbiBkYXRhXG4gICAgICBjb25zdCByZXZlbnVlcyA9IGRhdGEubWFwKGQgPT4gZC5yZXZlbnVlKVxuICAgICAgY29uc3QgbWVhbiA9IHJldmVudWVzLnJlZHVjZSgoc3VtLCByKSA9PiBzdW0gKyByLCAwKSAvIHJldmVudWVzLmxlbmd0aFxuICAgICAgY29uc3Qgc3RkRGV2ID0gTWF0aC5zcXJ0KHJldmVudWVzLnJlZHVjZSgoc3VtLCByKSA9PiBzdW0gKyBNYXRoLnBvdyhyIC0gbWVhbiwgMiksIDApIC8gcmV2ZW51ZXMubGVuZ3RoKVxuICAgICAgXG4gICAgICBkYXRhLmZvckVhY2goKHBvaW50LCBpbmRleCkgPT4ge1xuICAgICAgICBjb25zdCB6U2NvcmUgPSBNYXRoLmFicygocG9pbnQucmV2ZW51ZSAtIG1lYW4pIC8gc3RkRGV2KVxuICAgICAgICBpZiAoelNjb3JlID4gMikge1xuICAgICAgICAgIGluc2lnaHRzLnB1c2goe1xuICAgICAgICAgICAgaWQ6IGBhbm9tYWx5XyR7RGF0ZS5ub3coKX1fJHtpbmRleH1gLFxuICAgICAgICAgICAgdHlwZTogJ2Fub21hbHknLFxuICAgICAgICAgICAgdGl0bGU6IGBSZXZlbnVlIEFub21hbHkgb24gJHtwb2ludC5kYXRlfWAsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogYFJldmVudWUgb2Yg4oKxJHtwb2ludC5yZXZlbnVlLnRvTG9jYWxlU3RyaW5nKCl9IGlzICR7elNjb3JlLnRvRml4ZWQoMSl9IHN0YW5kYXJkIGRldmlhdGlvbnMgZnJvbSBub3JtYWwuYCxcbiAgICAgICAgICAgIGNvbmZpZGVuY2U6IE1hdGgubWluKHpTY29yZSAvIDMsIDEpLFxuICAgICAgICAgICAgcHJpb3JpdHk6IHpTY29yZSA+IDMgPyAnaGlnaCcgOiAnbWVkaXVtJyxcbiAgICAgICAgICAgIGNhdGVnb3J5OiAnb3BlcmF0aW9uYWwnLFxuICAgICAgICAgICAgcmVjb21tZW5kYXRpb25zOiBbXG4gICAgICAgICAgICAgICdJbnZlc3RpZ2F0ZSB0aGUgcm9vdCBjYXVzZSBvZiB0aGlzIGFub21hbHknLFxuICAgICAgICAgICAgICAnQ2hlY2sgZm9yIGRhdGEgcXVhbGl0eSBpc3N1ZXMgb3IgZXhjZXB0aW9uYWwgZXZlbnRzJ1xuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBpbnNpZ2h0c1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyhzZWN0aW9uOiBzdHJpbmcsIGRhdGE6IGFueVtdLCBjb250ZXh0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogUmVjb21tZW5kYXRpb25EYXRhW10ge1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogUmVjb21tZW5kYXRpb25EYXRhW10gPSBbXVxuICAgIFxuICAgIC8vIFNlY3Rpb24tc3BlY2lmaWMgcmVjb21tZW5kYXRpb25zXG4gICAgc3dpdGNoIChzZWN0aW9uKSB7XG4gICAgICBjYXNlICd0cmFuc2FjdGlvbi10cmVuZHMnOlxuICAgICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgICAgaWQ6IGByZWNfdHJlbmRzXyR7RGF0ZS5ub3coKX1gLFxuICAgICAgICAgIHR5cGU6ICdvcHRpbWl6YXRpb24nLFxuICAgICAgICAgIHRpdGxlOiAnT3B0aW1pemUgUGVhayBIb3VycycsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdGb2N1cyBtYXJrZXRpbmcgZWZmb3J0cyBkdXJpbmcgMi00IFBNIHdoZW4gY29udmVyc2lvbiByYXRlcyBhcmUgaGlnaGVzdCcsXG4gICAgICAgICAgaW1wYWN0OiAnaGlnaCcsXG4gICAgICAgICAgZWZmb3J0OiAnbWVkaXVtJyxcbiAgICAgICAgICBjYXRlZ29yeTogJ21hcmtldGluZycsXG4gICAgICAgICAgbWV0cmljczogWydjb252ZXJzaW9uX3JhdGUnLCAncmV2ZW51ZSddLFxuICAgICAgICAgIGVzdGltYXRlZEltcHJvdmVtZW50OiAnMTUtMjAlJyxcbiAgICAgICAgICB0aW1lbGluZTogJzItNCB3ZWVrcycsXG4gICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgIH0pXG4gICAgICAgIGJyZWFrXG4gICAgICAgIFxuICAgICAgY2FzZSAncHJvZHVjdC1taXgnOlxuICAgICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgICAgaWQ6IGByZWNfcHJvZHVjdF8ke0RhdGUubm93KCl9YCxcbiAgICAgICAgICB0eXBlOiAnaW52ZW50b3J5JyxcbiAgICAgICAgICB0aXRsZTogJ0FkanVzdCBJbnZlbnRvcnkgTWl4JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ0luY3JlYXNlIHN0b2NrIGZvciB0b3AtcGVyZm9ybWluZyBjYXRlZ29yaWVzIGFuZCByZWR1Y2UgdW5kZXJwZXJmb3JtZXJzJyxcbiAgICAgICAgICBpbXBhY3Q6ICdoaWdoJyxcbiAgICAgICAgICBlZmZvcnQ6ICdsb3cnLFxuICAgICAgICAgIGNhdGVnb3J5OiAnaW52ZW50b3J5JyxcbiAgICAgICAgICBtZXRyaWNzOiBbJ2ludmVudG9yeV90dXJub3ZlcicsICdwcm9maXRfbWFyZ2luJ10sXG4gICAgICAgICAgZXN0aW1hdGVkSW1wcm92ZW1lbnQ6ICcxMC0xNSUnLFxuICAgICAgICAgIHRpbWVsaW5lOiAnMS0yIHdlZWtzJyxcbiAgICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfSlcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJlY29tbWVuZGF0aW9uc1xuICB9XG5cbiAgcHJpdmF0ZSBwYXJzZVF1ZXJ5SW50ZW50KHF1ZXJ5OiBzdHJpbmcpOiB7IHR5cGU6IHN0cmluZzsgZW50aXRpZXM6IHN0cmluZ1tdOyBwYXJhbWV0ZXJzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+IH0ge1xuICAgIGNvbnN0IGxvd2VyY2FzZVF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKVxuICAgIFxuICAgIC8vIFNpbXBsZSBpbnRlbnQgY2xhc3NpZmljYXRpb25cbiAgICBpZiAobG93ZXJjYXNlUXVlcnkuaW5jbHVkZXMoJ3Nob3cnKSB8fCBsb3dlcmNhc2VRdWVyeS5pbmNsdWRlcygnZGlzcGxheScpIHx8IGxvd2VyY2FzZVF1ZXJ5LmluY2x1ZGVzKCdnZXQnKSkge1xuICAgICAgcmV0dXJuIHsgdHlwZTogJ2RhdGFfcmVxdWVzdCcsIGVudGl0aWVzOiBbXSwgcGFyYW1ldGVyczoge30gfVxuICAgIH1cbiAgICBcbiAgICBpZiAobG93ZXJjYXNlUXVlcnkuaW5jbHVkZXMoJ2FuYWx5emUnKSB8fCBsb3dlcmNhc2VRdWVyeS5pbmNsdWRlcygnYW5hbHlzaXMnKSkge1xuICAgICAgcmV0dXJuIHsgdHlwZTogJ2FuYWx5c2lzX3JlcXVlc3QnLCBlbnRpdGllczogW10sIHBhcmFtZXRlcnM6IHt9IH1cbiAgICB9XG4gICAgXG4gICAgaWYgKGxvd2VyY2FzZVF1ZXJ5LmluY2x1ZGVzKCdjb21wYXJlJykgfHwgbG93ZXJjYXNlUXVlcnkuaW5jbHVkZXMoJ3ZzJykpIHtcbiAgICAgIHJldHVybiB7IHR5cGU6ICdjb21wYXJpc29uX3JlcXVlc3QnLCBlbnRpdGllczogW10sIHBhcmFtZXRlcnM6IHt9IH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHsgdHlwZTogJ2dlbmVyYWwnLCBlbnRpdGllczogW10sIHBhcmFtZXRlcnM6IHt9IH1cbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgaGFuZGxlRGF0YVJlcXVlc3QoaW50ZW50OiBhbnksIGNvbnRleHQ6IENoYXRDb250ZXh0KTogUHJvbWlzZTxhbnk+IHtcbiAgICAvLyBIYW5kbGUgZGF0YSByZXF1ZXN0c1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnZGF0YV9yZXNwb25zZScsXG4gICAgICBtZXNzYWdlOiAnSSBjYW4gaGVscCB5b3UgYWNjZXNzIHNwZWNpZmljIGRhdGEuIFdoYXQgbWV0cmljcyB3b3VsZCB5b3UgbGlrZSB0byBzZWU/JyxcbiAgICAgIHN1Z2dlc3Rpb25zOiBbJ1Nob3cgc2FsZXMgdHJlbmRzJywgJ0Rpc3BsYXkgdG9wIHByb2R1Y3RzJywgJ0dldCByZWdpb25hbCBwZXJmb3JtYW5jZSddXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVBbmFseXNpc1JlcXVlc3QoaW50ZW50OiBhbnksIGNvbnRleHQ6IENoYXRDb250ZXh0KTogUHJvbWlzZTxhbnk+IHtcbiAgICAvLyBIYW5kbGUgYW5hbHlzaXMgcmVxdWVzdHNcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ2FuYWx5c2lzX3Jlc3BvbnNlJyxcbiAgICAgIG1lc3NhZ2U6ICdJIGNhbiBwZXJmb3JtIHZhcmlvdXMgYW5hbHlzZXMgb24geW91ciBkYXRhLiBXaGF0IHR5cGUgb2YgYW5hbHlzaXMgaW50ZXJlc3RzIHlvdT8nLFxuICAgICAgc3VnZ2VzdGlvbnM6IFsnVHJlbmQgYW5hbHlzaXMnLCAnQW5vbWFseSBkZXRlY3Rpb24nLCAnUHJlZGljdGl2ZSBtb2RlbGluZyddXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVDb21wYXJpc29uUmVxdWVzdChpbnRlbnQ6IGFueSwgY29udGV4dDogQ2hhdENvbnRleHQpOiBQcm9taXNlPGFueT4ge1xuICAgIC8vIEhhbmRsZSBjb21wYXJpc29uIHJlcXVlc3RzXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdjb21wYXJpc29uX3Jlc3BvbnNlJyxcbiAgICAgIG1lc3NhZ2U6ICdJIGNhbiBoZWxwIHlvdSBjb21wYXJlIGRpZmZlcmVudCBtZXRyaWNzIG9yIHRpbWUgcGVyaW9kcy4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBjb21wYXJlPycsXG4gICAgICBzdWdnZXN0aW9uczogWydDb21wYXJlIHJlZ2lvbnMnLCAnTW9udGgtb3Zlci1tb250aCB0cmVuZHMnLCAnUHJvZHVjdCBwZXJmb3JtYW5jZSddXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVHZW5lcmFsUXVlcnkocXVlcnk6IHN0cmluZywgY29udGV4dDogQ2hhdENvbnRleHQpOiBQcm9taXNlPGFueT4ge1xuICAgIC8vIEhhbmRsZSBnZW5lcmFsIHF1ZXJpZXNcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ2dlbmVyYWxfcmVzcG9uc2UnLFxuICAgICAgbWVzc2FnZTogYEkgdW5kZXJzdGFuZCB5b3UncmUgYXNraW5nIGFib3V0IFwiJHtxdWVyeX1cIi4gQ291bGQgeW91IGJlIG1vcmUgc3BlY2lmaWMgYWJvdXQgd2hhdCBkYXRhIG9yIGFuYWx5c2lzIHlvdSBuZWVkP2AsXG4gICAgICBzdWdnZXN0aW9uczogWydBc2sgYWJvdXQgc3BlY2lmaWMgbWV0cmljcycsICdSZXF1ZXN0IHRyZW5kIGFuYWx5c2lzJywgJ0NvbXBhcmUgdGltZSBwZXJpb2RzJ11cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlTGluZWFyRm9yZWNhc3QoZGF0YTogYW55W10sIG1ldHJpYzogc3RyaW5nLCBkYXlzOiBudW1iZXIpOiBhbnlbXSB7XG4gICAgLy8gU2ltcGxlIGxpbmVhciByZWdyZXNzaW9uIGZvcmVjYXN0XG4gICAgY29uc3QgcG9pbnRzID0gZGF0YS5tYXAoKGQsIGkpID0+ICh7IHg6IGksIHk6IGRbbWV0cmljXSB9KSlcbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgbGluZWFyIHJlZ3Jlc3Npb25cbiAgICBjb25zdCBuID0gcG9pbnRzLmxlbmd0aFxuICAgIGNvbnN0IHN1bVggPSBwb2ludHMucmVkdWNlKChzdW0sIHApID0+IHN1bSArIHAueCwgMClcbiAgICBjb25zdCBzdW1ZID0gcG9pbnRzLnJlZHVjZSgoc3VtLCBwKSA9PiBzdW0gKyBwLnksIDApXG4gICAgY29uc3Qgc3VtWFkgPSBwb2ludHMucmVkdWNlKChzdW0sIHApID0+IHN1bSArIHAueCAqIHAueSwgMClcbiAgICBjb25zdCBzdW1YWCA9IHBvaW50cy5yZWR1Y2UoKHN1bSwgcCkgPT4gc3VtICsgcC54ICogcC54LCAwKVxuICAgIFxuICAgIGNvbnN0IHNsb3BlID0gKG4gKiBzdW1YWSAtIHN1bVggKiBzdW1ZKSAvIChuICogc3VtWFggLSBzdW1YICogc3VtWClcbiAgICBjb25zdCBpbnRlcmNlcHQgPSAoc3VtWSAtIHNsb3BlICogc3VtWCkgLyBuXG4gICAgXG4gICAgLy8gR2VuZXJhdGUgZm9yZWNhc3QgcG9pbnRzXG4gICAgY29uc3QgZm9yZWNhc3QgPSBbXVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF5czsgaSsrKSB7XG4gICAgICBjb25zdCB4ID0gbiArIGlcbiAgICAgIGNvbnN0IHkgPSBzbG9wZSAqIHggKyBpbnRlcmNlcHRcbiAgICAgIGZvcmVjYXN0LnB1c2goe1xuICAgICAgICBkYXk6IGkgKyAxLFxuICAgICAgICBwcmVkaWN0ZWRfdmFsdWU6IE1hdGgubWF4KDAsIHkpLCAvLyBFbnN1cmUgbm9uLW5lZ2F0aXZlXG4gICAgICAgIGNvbmZpZGVuY2U6IE1hdGgubWF4KDAsIDEgLSAoaSAvIGRheXMpICogMC41KSAvLyBEZWNyZWFzaW5nIGNvbmZpZGVuY2Ugb3ZlciB0aW1lXG4gICAgICB9KVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZm9yZWNhc3RcbiAgfVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlRm9yZWNhc3RDb25maWRlbmNlKGRhdGE6IGFueVtdKTogbnVtYmVyIHtcbiAgICAvLyBDYWxjdWxhdGUgUi1zcXVhcmVkIGZvciBjb25maWRlbmNlIG1lYXN1cmVcbiAgICBpZiAoZGF0YS5sZW5ndGggPCAzKSByZXR1cm4gMC41XG4gICAgXG4gICAgY29uc3QgdmFsdWVzID0gZGF0YS5tYXAoZCA9PiBkLnJldmVudWUgfHwgZC5zYWxlcyB8fCAwKVxuICAgIGNvbnN0IG1lYW4gPSB2YWx1ZXMucmVkdWNlKChzdW0sIHYpID0+IHN1bSArIHYsIDApIC8gdmFsdWVzLmxlbmd0aFxuICAgIFxuICAgIGNvbnN0IHRvdGFsVmFyaWF0aW9uID0gdmFsdWVzLnJlZHVjZSgoc3VtLCB2KSA9PiBzdW0gKyBNYXRoLnBvdyh2IC0gbWVhbiwgMiksIDApXG4gICAgY29uc3QgdHJlbmQgPSB0aGlzLmNhbGN1bGF0ZVRyZW5kTGluZSh2YWx1ZXMpXG4gICAgY29uc3QgZXhwbGFpbmVkVmFyaWF0aW9uID0gdmFsdWVzLnJlZHVjZSgoc3VtLCB2LCBpKSA9PiBzdW0gKyBNYXRoLnBvdyh0cmVuZFtpXSAtIG1lYW4sIDIpLCAwKVxuICAgIFxuICAgIGNvbnN0IHJTcXVhcmVkID0gZXhwbGFpbmVkVmFyaWF0aW9uIC8gdG90YWxWYXJpYXRpb25cbiAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgoclNxdWFyZWQsIDAuMSksIDAuOTUpIC8vIEJvdW5kZWQgY29uZmlkZW5jZVxuICB9XG5cbiAgcHJpdmF0ZSBjYWxjdWxhdGVUcmVuZExpbmUodmFsdWVzOiBudW1iZXJbXSk6IG51bWJlcltdIHtcbiAgICBjb25zdCBuID0gdmFsdWVzLmxlbmd0aFxuICAgIGNvbnN0IHN1bVggPSAobiAqIChuIC0gMSkpIC8gMlxuICAgIGNvbnN0IHN1bVkgPSB2YWx1ZXMucmVkdWNlKChzdW0sIHYpID0+IHN1bSArIHYsIDApXG4gICAgY29uc3Qgc3VtWFkgPSB2YWx1ZXMucmVkdWNlKChzdW0sIHYsIGkpID0+IHN1bSArIGkgKiB2LCAwKVxuICAgIGNvbnN0IHN1bVhYID0gKG4gKiAobiAtIDEpICogKDIgKiBuIC0gMSkpIC8gNlxuICAgIFxuICAgIGNvbnN0IHNsb3BlID0gKG4gKiBzdW1YWSAtIHN1bVggKiBzdW1ZKSAvIChuICogc3VtWFggLSBzdW1YICogc3VtWClcbiAgICBjb25zdCBpbnRlcmNlcHQgPSAoc3VtWSAtIHNsb3BlICogc3VtWCkgLyBuXG4gICAgXG4gICAgcmV0dXJuIHZhbHVlcy5tYXAoKF8sIGkpID0+IHNsb3BlICogaSArIGludGVyY2VwdClcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBSURBTCJdLCJuYW1lcyI6WyJCYXNlREFMIiwiQUlEQUwiLCJzdG9yZUNoYXRNZXNzYWdlIiwibWVzc2FnZSIsImV4ZWN1dGVRdWVyeSIsImNsaWVudCIsImRhdGEiLCJlcnJvciIsImZyb20iLCJpbnNlcnQiLCJzZWxlY3QiLCJzaW5nbGUiLCJnZXRDaGF0SGlzdG9yeSIsImNvbnZlcnNhdGlvbklkIiwibGltaXQiLCJjYWNoZUtleSIsImVxIiwib3JkZXIiLCJhc2NlbmRpbmciLCJnZW5lcmF0ZUluc2lnaHRzIiwicGFyYW1zIiwiSlNPTiIsInN0cmluZ2lmeSIsImNvbnRleHRRdWVyeSIsImJ1aWxkQ29udGV4dFF1ZXJ5IiwiY29udGV4dERhdGEiLCJjb250ZXh0RXJyb3IiLCJycGMiLCJhbmFseXNpc190eXBlIiwiYW5hbHlzaXNUeXBlIiwiZmlsdGVycyIsInRpbWVmcmFtZSIsImluc2lnaHRzIiwiZ2VuZXJhdGVSdWxlQmFzZWRJbnNpZ2h0cyIsInN0b3JlRXJyb3IiLCJtYXAiLCJpbnNpZ2h0IiwiY3JlYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImFuYWx5c2lzX3BhcmFtcyIsImNvbnNvbGUiLCJ3YXJuIiwiZ2V0UmVjb21tZW5kYXRpb25zIiwic2VjdGlvbiIsInVzZXJDb250ZXh0IiwicGVyZm9ybWFuY2VEYXRhIiwicGVyZkVycm9yIiwidXNlcl9jb250ZXh0IiwicmVjb21tZW5kYXRpb25zIiwiZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMiLCJzZW1hbnRpY1NlYXJjaCIsInF1ZXJ5Iiwic2VhcmNoX3F1ZXJ5IiwiZGV0ZWN0QW5vbWFsaWVzIiwibWV0cmljIiwic2Vuc2l0aXZpdHkiLCJtZXRyaWNfbmFtZSIsInRpbWVfd2luZG93Iiwic2Vuc2l0aXZpdHlfdGhyZXNob2xkIiwiZ2VuZXJhdGVQcmVkaWN0aW9ucyIsIm1ldHJpY3MiLCJmb3JlY2FzdERheXMiLCJqb2luIiwicHJlZGljdGlvbnMiLCJoaXN0b3JpY2FsRGF0YSIsImZvcmVjYXN0IiwiZ2VuZXJhdGVMaW5lYXJGb3JlY2FzdCIsInB1c2giLCJjb25maWRlbmNlIiwiY2FsY3VsYXRlRm9yZWNhc3RDb25maWRlbmNlIiwicHJvY2Vzc05hdHVyYWxMYW5ndWFnZVF1ZXJ5IiwiY29udGV4dCIsImludGVudCIsInBhcnNlUXVlcnlJbnRlbnQiLCJyZXNwb25zZSIsInR5cGUiLCJoYW5kbGVEYXRhUmVxdWVzdCIsImhhbmRsZUFuYWx5c2lzUmVxdWVzdCIsImhhbmRsZUNvbXBhcmlzb25SZXF1ZXN0IiwiaGFuZGxlR2VuZXJhbFF1ZXJ5IiwiYmFzZVF1ZXJ5IiwiT2JqZWN0IiwiZW50cmllcyIsImZvckVhY2giLCJrZXkiLCJ2YWx1ZSIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsInJlY2VudFdlZWsiLCJzbGljZSIsInByZXZpb3VzV2VlayIsInJlY2VudEF2ZyIsInJlZHVjZSIsInN1bSIsImQiLCJyZXZlbnVlIiwicHJldmlvdXNBdmciLCJjaGFuZ2VQZXJjZW50IiwiaWQiLCJub3ciLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiTWF0aCIsImFicyIsInRvRml4ZWQiLCJtaW4iLCJwcmlvcml0eSIsImNhdGVnb3J5IiwicmV2ZW51ZXMiLCJtZWFuIiwiciIsInN0ZERldiIsInNxcnQiLCJwb3ciLCJwb2ludCIsImluZGV4IiwielNjb3JlIiwiZGF0ZSIsInRvTG9jYWxlU3RyaW5nIiwiaW1wYWN0IiwiZWZmb3J0IiwiZXN0aW1hdGVkSW1wcm92ZW1lbnQiLCJ0aW1lbGluZSIsImxvd2VyY2FzZVF1ZXJ5IiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImVudGl0aWVzIiwicGFyYW1ldGVycyIsInN1Z2dlc3Rpb25zIiwiZGF5cyIsInBvaW50cyIsImkiLCJ4IiwieSIsIm4iLCJzdW1YIiwicCIsInN1bVkiLCJzdW1YWSIsInN1bVhYIiwic2xvcGUiLCJpbnRlcmNlcHQiLCJkYXkiLCJwcmVkaWN0ZWRfdmFsdWUiLCJtYXgiLCJ2YWx1ZXMiLCJzYWxlcyIsInYiLCJ0b3RhbFZhcmlhdGlvbiIsInRyZW5kIiwiY2FsY3VsYXRlVHJlbmRMaW5lIiwiZXhwbGFpbmVkVmFyaWF0aW9uIiwiclNxdWFyZWQiLCJfIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/dal/ai.ts\n");

/***/ }),

/***/ "(rsc)/./lib/dal/base.ts":
/*!*************************!*\
  !*** ./lib/dal/base.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n/**\n * Base Data Access Layer for Scout Dashboard\n * Provides centralized database operations with error handling and caching\n */ \nclass BaseDAL {\n    constructor(){\n        this.cache = new Map();\n        this.client = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(process.env.NEXT_PUBLIC_SUPABASE_URL, process.env.SUPABASE_SERVICE_ROLE || process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY, {\n            auth: {\n                persistSession: false,\n                autoRefreshToken: false\n            },\n            db: {\n                schema: 'public'\n            }\n        });\n    }\n    /**\n   * Get Supabase client instance\n   */ getClient() {\n        return this.client;\n    }\n    /**\n   * Execute query with error handling and optional caching\n   */ async executeQuery(queryFn, cacheKey, cacheTTL = 300000 // 5 minutes default\n    ) {\n        try {\n            // Check cache first if cache key provided\n            if (cacheKey) {\n                const cached = this.cache.get(cacheKey);\n                if (cached && Date.now() - cached.timestamp < cached.ttl) {\n                    return {\n                        data: cached.data,\n                        error: null\n                    };\n                }\n            }\n            const { data, error } = await queryFn(this.client);\n            if (error) {\n                console.error('Database query error:', error);\n                return {\n                    data: null,\n                    error: error.message\n                };\n            }\n            // Cache successful result if cache key provided\n            if (cacheKey && data) {\n                this.cache.set(cacheKey, {\n                    data,\n                    timestamp: Date.now(),\n                    ttl: cacheTTL\n                });\n            }\n            return {\n                data,\n                error: null\n            };\n        } catch (err) {\n            const error = err;\n            console.error('Database execution error:', error);\n            return {\n                data: null,\n                error: error.message\n            };\n        }\n    }\n    /**\n   * Clear cache by key or all cache\n   */ clearCache(key) {\n        if (key) {\n            this.cache.delete(key);\n        } else {\n            this.cache.clear();\n        }\n    }\n    /**\n   * Build dynamic filters for queries\n   */ buildFilters(filters) {\n        const cleanFilters = {};\n        Object.entries(filters).forEach(([key, value])=>{\n            if (value !== undefined && value !== null && value !== '') {\n                if (Array.isArray(value) && value.length > 0) {\n                    cleanFilters[key] = value;\n                } else if (!Array.isArray(value)) {\n                    cleanFilters[key] = value;\n                }\n            }\n        });\n        return cleanFilters;\n    }\n    /**\n   * Execute raw SQL query (for complex analytics)\n   */ async executeRawQuery(query, params = [], cacheKey, cacheTTL = 300000) {\n        return this.executeQuery(async (client)=>{\n            const { data, error } = await client.rpc('execute_sql', {\n                query_text: query,\n                params: params\n            });\n            return {\n                data,\n                error\n            };\n        }, cacheKey, cacheTTL);\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (BaseDAL);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUNILFlBQVksQ0FDdEIsT0FBT1o7WUFDTCxNQUFNLEVBQUVzQixJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU12QixPQUFPOEMsR0FBRyxDQUFDLGVBQWU7Z0JBQ3REQyxZQUFZSDtnQkFDWkMsUUFBUUE7WUFDVjtZQUNBLE9BQU87Z0JBQUV2QjtnQkFBTUM7WUFBTTtRQUN2QixHQUNBVCxVQUNBQztJQUVKO0FBQ0Y7QUFFQSxpRUFBZW5CLE9BQU9BLEVBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zY291dC1kYXNoYm9hcmQtbmV4dGpzLy4vbGliL2RhbC9iYXNlLnRzP2Q0ODIiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBCYXNlIERhdGEgQWNjZXNzIExheWVyIGZvciBTY291dCBEYXNoYm9hcmRcbiAqIFByb3ZpZGVzIGNlbnRyYWxpemVkIGRhdGFiYXNlIG9wZXJhdGlvbnMgd2l0aCBlcnJvciBoYW5kbGluZyBhbmQgY2FjaGluZ1xuICovXG5cbmltcG9ydCB7IGNyZWF0ZUNsaWVudCwgU3VwYWJhc2VDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnXG5pbXBvcnQgeyBEYXRhYmFzZSB9IGZyb20gJ0AvdHlwZXMvc3VwYWJhc2UnXG5cbmV4cG9ydCB0eXBlIFNjb3V0RGF0YWJhc2UgPSBEYXRhYmFzZVxuXG5jbGFzcyBCYXNlREFMIHtcbiAgcHJpdmF0ZSBjbGllbnQ6IFN1cGFiYXNlQ2xpZW50PFNjb3V0RGF0YWJhc2U+XG4gIHByaXZhdGUgY2FjaGU6IE1hcDxzdHJpbmcsIHsgZGF0YTogYW55OyB0aW1lc3RhbXA6IG51bWJlcjsgdHRsOiBudW1iZXIgfT4gPSBuZXcgTWFwKClcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmNsaWVudCA9IGNyZWF0ZUNsaWVudDxTY291dERhdGFiYXNlPihcbiAgICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgICBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEUgfHwgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxuICAgICAge1xuICAgICAgICBhdXRoOiB7XG4gICAgICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlLFxuICAgICAgICAgIGF1dG9SZWZyZXNoVG9rZW46IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBkYjoge1xuICAgICAgICAgIHNjaGVtYTogJ3B1YmxpYydcbiAgICAgICAgfVxuICAgICAgfVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgU3VwYWJhc2UgY2xpZW50IGluc3RhbmNlXG4gICAqL1xuICBnZXRDbGllbnQoKTogU3VwYWJhc2VDbGllbnQ8U2NvdXREYXRhYmFzZT4ge1xuICAgIHJldHVybiB0aGlzLmNsaWVudFxuICB9XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGUgcXVlcnkgd2l0aCBlcnJvciBoYW5kbGluZyBhbmQgb3B0aW9uYWwgY2FjaGluZ1xuICAgKi9cbiAgYXN5bmMgZXhlY3V0ZVF1ZXJ5PFQ+KFxuICAgIHF1ZXJ5Rm46IChjbGllbnQ6IFN1cGFiYXNlQ2xpZW50PFNjb3V0RGF0YWJhc2U+KSA9PiBQcm9taXNlPHsgZGF0YTogVCB8IG51bGw7IGVycm9yOiBhbnkgfT4sXG4gICAgY2FjaGVLZXk/OiBzdHJpbmcsXG4gICAgY2FjaGVUVEw6IG51bWJlciA9IDMwMDAwMCAvLyA1IG1pbnV0ZXMgZGVmYXVsdFxuICApOiBQcm9taXNlPHsgZGF0YTogVCB8IG51bGw7IGVycm9yOiBzdHJpbmcgfCBudWxsIH0+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQ2hlY2sgY2FjaGUgZmlyc3QgaWYgY2FjaGUga2V5IHByb3ZpZGVkXG4gICAgICBpZiAoY2FjaGVLZXkpIHtcbiAgICAgICAgY29uc3QgY2FjaGVkID0gdGhpcy5jYWNoZS5nZXQoY2FjaGVLZXkpXG4gICAgICAgIGlmIChjYWNoZWQgJiYgRGF0ZS5ub3coKSAtIGNhY2hlZC50aW1lc3RhbXAgPCBjYWNoZWQudHRsKSB7XG4gICAgICAgICAgcmV0dXJuIHsgZGF0YTogY2FjaGVkLmRhdGEsIGVycm9yOiBudWxsIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBxdWVyeUZuKHRoaXMuY2xpZW50KVxuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgcXVlcnkgZXJyb3I6JywgZXJyb3IpXG4gICAgICAgIHJldHVybiB7IGRhdGE6IG51bGwsIGVycm9yOiBlcnJvci5tZXNzYWdlIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ2FjaGUgc3VjY2Vzc2Z1bCByZXN1bHQgaWYgY2FjaGUga2V5IHByb3ZpZGVkXG4gICAgICBpZiAoY2FjaGVLZXkgJiYgZGF0YSkge1xuICAgICAgICB0aGlzLmNhY2hlLnNldChjYWNoZUtleSwge1xuICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICAgIHR0bDogY2FjaGVUVExcbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHsgZGF0YSwgZXJyb3I6IG51bGwgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc3QgZXJyb3IgPSBlcnIgYXMgRXJyb3JcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIGV4ZWN1dGlvbiBlcnJvcjonLCBlcnJvcilcbiAgICAgIHJldHVybiB7IGRhdGE6IG51bGwsIGVycm9yOiBlcnJvci5tZXNzYWdlIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXIgY2FjaGUgYnkga2V5IG9yIGFsbCBjYWNoZVxuICAgKi9cbiAgY2xlYXJDYWNoZShrZXk/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAoa2V5KSB7XG4gICAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2FjaGUuY2xlYXIoKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBCdWlsZCBkeW5hbWljIGZpbHRlcnMgZm9yIHF1ZXJpZXNcbiAgICovXG4gIGJ1aWxkRmlsdGVycyhmaWx0ZXJzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogUmVjb3JkPHN0cmluZywgYW55PiB7XG4gICAgY29uc3QgY2xlYW5GaWx0ZXJzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge31cbiAgICBcbiAgICBPYmplY3QuZW50cmllcyhmaWx0ZXJzKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSAnJykge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNsZWFuRmlsdGVyc1trZXldID0gdmFsdWVcbiAgICAgICAgfSBlbHNlIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICBjbGVhbkZpbHRlcnNba2V5XSA9IHZhbHVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIGNsZWFuRmlsdGVyc1xuICB9XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGUgcmF3IFNRTCBxdWVyeSAoZm9yIGNvbXBsZXggYW5hbHl0aWNzKVxuICAgKi9cbiAgYXN5bmMgZXhlY3V0ZVJhd1F1ZXJ5PFQ+KFxuICAgIHF1ZXJ5OiBzdHJpbmcsXG4gICAgcGFyYW1zOiBhbnlbXSA9IFtdLFxuICAgIGNhY2hlS2V5Pzogc3RyaW5nLFxuICAgIGNhY2hlVFRMOiBudW1iZXIgPSAzMDAwMDBcbiAgKTogUHJvbWlzZTx7IGRhdGE6IFQgfCBudWxsOyBlcnJvcjogc3RyaW5nIHwgbnVsbCB9PiB7XG4gICAgcmV0dXJuIHRoaXMuZXhlY3V0ZVF1ZXJ5PFQ+KFxuICAgICAgYXN5bmMgKGNsaWVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBjbGllbnQucnBjKCdleGVjdXRlX3NxbCcsIHtcbiAgICAgICAgICBxdWVyeV90ZXh0OiBxdWVyeSxcbiAgICAgICAgICBwYXJhbXM6IHBhcmFtc1xuICAgICAgICB9KVxuICAgICAgICByZXR1cm4geyBkYXRhLCBlcnJvciB9XG4gICAgICB9LFxuICAgICAgY2FjaGVLZXksXG4gICAgICBjYWNoZVRUTFxuICAgIClcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBCYXNlREFMIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsIkJhc2VEQUwiLCJjb25zdHJ1Y3RvciIsImNhY2hlIiwiTWFwIiwiY2xpZW50IiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiYXV0aCIsInBlcnNpc3RTZXNzaW9uIiwiYXV0b1JlZnJlc2hUb2tlbiIsImRiIiwic2NoZW1hIiwiZ2V0Q2xpZW50IiwiZXhlY3V0ZVF1ZXJ5IiwicXVlcnlGbiIsImNhY2hlS2V5IiwiY2FjaGVUVEwiLCJjYWNoZWQiLCJnZXQiLCJEYXRlIiwibm93IiwidGltZXN0YW1wIiwidHRsIiwiZGF0YSIsImVycm9yIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJzZXQiLCJlcnIiLCJjbGVhckNhY2hlIiwia2V5IiwiZGVsZXRlIiwiY2xlYXIiLCJidWlsZEZpbHRlcnMiLCJmaWx0ZXJzIiwiY2xlYW5GaWx0ZXJzIiwiT2JqZWN0IiwiZW50cmllcyIsImZvckVhY2giLCJ2YWx1ZSIsInVuZGVmaW5lZCIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsImV4ZWN1dGVSYXdRdWVyeSIsInF1ZXJ5IiwicGFyYW1zIiwicnBjIiwicXVlcnlfdGV4dCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/dal/base.ts\n");

/***/ }),

/***/ "(rsc)/./lib/dal/transactions.ts":
/*!*********************************!*\
  !*** ./lib/dal/transactions.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base */ \"(rsc)/./lib/dal/base.ts\");\n/**\n * Transaction Data Access Layer\n * Handles all transaction-related database operations\n */ \nclass TransactionDAL extends _base__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n    /**\n   * Get daily transaction trends with optional filters\n   */ async getTrends(filters = {}) {\n        const cacheKey = `trends_${JSON.stringify(filters)}`;\n        return this.executeQuery(async (client)=>{\n            let query = client.from('v_trends_daily').select('day, tx_count, sales, avg_transaction').order('day', {\n                ascending: true\n            });\n            // Apply date filters\n            if (filters.dateFrom) {\n                query = query.gte('day', filters.dateFrom);\n            }\n            if (filters.dateTo) {\n                query = query.lte('day', filters.dateTo);\n            }\n            const { data, error } = await query;\n            return {\n                data,\n                error\n            };\n        }, cacheKey, 300000 // 5 minutes cache\n        );\n    }\n    /**\n   * Get consumer behavior patterns\n   */ async getBehaviorData(filters = {}) {\n        const cacheKey = `behavior_${JSON.stringify(filters)}`;\n        return this.executeQuery(async (client)=>{\n            let query = client.from('v_behavior_patterns').select('request_type, n, acceptance_rate').order('n', {\n                ascending: false\n            });\n            // Apply filters if needed\n            if (filters.dateFrom) {\n                query = query.gte('created_at', filters.dateFrom);\n            }\n            if (filters.dateTo) {\n                query = query.lte('created_at', filters.dateTo);\n            }\n            const { data, error } = await query;\n            return {\n                data,\n                error\n            };\n        }, cacheKey, 600000 // 10 minutes cache\n        );\n    }\n    /**\n   * Get product mix analysis\n   */ async getProductMix(filters = {}) {\n        const cacheKey = `product_mix_${JSON.stringify(filters)}`;\n        return this.executeQuery(async (client)=>{\n            let query = client.from('v_product_mix').select('product_category, brand_name, n, total_sales').order('total_sales', {\n                ascending: false\n            });\n            // Apply filters\n            if (filters.categories?.length) {\n                query = query.in('product_category', filters.categories);\n            }\n            if (filters.brands?.length) {\n                query = query.in('brand_name', filters.brands);\n            }\n            if (filters.dateFrom) {\n                query = query.gte('created_at', filters.dateFrom);\n            }\n            if (filters.dateTo) {\n                query = query.lte('created_at', filters.dateTo);\n            }\n            const { data, error } = await query;\n            return {\n                data,\n                error\n            };\n        }, cacheKey, 300000 // 5 minutes cache\n        );\n    }\n    /**\n   * Get consumer profiling data\n   */ async getProfiling(filters = {}) {\n        const cacheKey = `profiling_${JSON.stringify(filters)}`;\n        return this.executeQuery(async (client)=>{\n            let query = client.from('v_consumer_profiling').select('gender, age_bracket, n, avg_spend').order('n', {\n                ascending: false\n            });\n            // Apply filters\n            if (filters.genders?.length) {\n                query = query.in('gender', filters.genders);\n            }\n            if (filters.ageBrackets?.length) {\n                query = query.in('age_bracket', filters.ageBrackets);\n            }\n            if (filters.dateFrom) {\n                query = query.gte('created_at', filters.dateFrom);\n            }\n            if (filters.dateTo) {\n                query = query.lte('created_at', filters.dateTo);\n            }\n            const { data, error } = await query;\n            return {\n                data,\n                error\n            };\n        }, cacheKey, 600000 // 10 minutes cache\n        );\n    }\n    /**\n   * Get geographic distribution data\n   */ async getGeoData(filters = {}) {\n        const cacheKey = `geo_${JSON.stringify(filters)}`;\n        return this.executeQuery(async (client)=>{\n            let query = client.from('v_geo_province').select('province, tx_count, sales, avg_transaction, region_name, province_code').order('tx_count', {\n                ascending: false\n            });\n            // Apply filters\n            if (filters.regions?.length) {\n                query = query.in('region_name', filters.regions);\n            }\n            if (filters.provinces?.length) {\n                query = query.in('province', filters.provinces);\n            }\n            if (filters.dateFrom) {\n                query = query.gte('created_at', filters.dateFrom);\n            }\n            if (filters.dateTo) {\n                query = query.lte('created_at', filters.dateTo);\n            }\n            const { data, error } = await query;\n            return {\n                data,\n                error\n            };\n        }, cacheKey, 300000 // 5 minutes cache\n        );\n    }\n    /**\n   * Get time-based heatmap data\n   */ async getTimeHeatmap(filters = {}) {\n        const cacheKey = `time_heatmap_${JSON.stringify(filters)}`;\n        return this.executeQuery(async (client)=>{\n            let query = client.from('v_time_heatmap').select('time_of_day, day_of_week, tx_count, avg_value').order('day_of_week', {\n                ascending: true\n            }).order('time_of_day', {\n                ascending: true\n            });\n            // Apply date filters\n            if (filters.dateFrom) {\n                query = query.gte('created_at', filters.dateFrom);\n            }\n            if (filters.dateTo) {\n                query = query.lte('created_at', filters.dateTo);\n            }\n            const { data, error } = await query;\n            return {\n                data,\n                error\n            };\n        }, cacheKey, 600000 // 10 minutes cache\n        );\n    }\n    /**\n   * Get competitive analysis data\n   */ async getCompetitiveData(filters = {}) {\n        const cacheKey = `competitive_${JSON.stringify(filters)}`;\n        return this.executeQuery(async (client)=>{\n            let query = client.from('v_competitive_analysis').select(`\n            brand_name, \n            product_category, \n            market_share, \n            total_revenue, \n            avg_price_point, \n            acceptance_rate,\n            is_tbwa_client,\n            tier_classification\n          `).order('market_share', {\n                ascending: false\n            });\n            // Apply filters\n            if (filters.categories?.length) {\n                query = query.in('product_category', filters.categories);\n            }\n            if (filters.brands?.length) {\n                query = query.in('brand_name', filters.brands);\n            }\n            if (filters.dateFrom) {\n                query = query.gte('created_at', filters.dateFrom);\n            }\n            if (filters.dateTo) {\n                query = query.lte('created_at', filters.dateTo);\n            }\n            const { data, error } = await query;\n            return {\n                data,\n                error\n            };\n        }, cacheKey, 600000 // 10 minutes cache\n        );\n    }\n    /**\n   * Get advanced analytics with custom SQL\n   */ async getAdvancedAnalytics(analysisType, params = {}) {\n        const cacheKey = `advanced_${analysisType}_${JSON.stringify(params)}`;\n        const queries = {\n            cohort: `\n        WITH cohorts AS (\n          SELECT \n            DATE_TRUNC('month', timestamp::date) as cohort_month,\n            store_id,\n            COUNT(*) as tx_count,\n            AVG(peso_value) as avg_spend\n          FROM transactions \n          WHERE timestamp >= $1 AND timestamp <= $2\n          GROUP BY cohort_month, store_id\n        )\n        SELECT * FROM cohorts ORDER BY cohort_month\n      `,\n            funnel: `\n        SELECT \n          'awareness' as stage, COUNT(DISTINCT store_id) as count\n        FROM transactions WHERE campaign_influenced = true\n        UNION ALL\n        SELECT \n          'consideration' as stage, COUNT(DISTINCT store_id) as count\n        FROM transactions WHERE request_type != 'indirect'\n        UNION ALL\n        SELECT \n          'purchase' as stage, COUNT(DISTINCT store_id) as count\n        FROM transactions WHERE peso_value > 0\n      `,\n            retention: `\n        WITH user_activity AS (\n          SELECT \n            store_id,\n            DATE_TRUNC('month', timestamp::date) as activity_month,\n            COUNT(*) as tx_count\n          FROM transactions \n          WHERE timestamp >= $1 AND timestamp <= $2\n          GROUP BY store_id, activity_month\n        )\n        SELECT \n          activity_month,\n          COUNT(DISTINCT store_id) as active_stores,\n          AVG(tx_count) as avg_transactions\n        FROM user_activity\n        GROUP BY activity_month\n        ORDER BY activity_month\n      `,\n            attribution: `\n        SELECT \n          CASE WHEN campaign_influenced THEN 'Campaign' ELSE 'Organic' END as source,\n          COUNT(*) as transactions,\n          SUM(peso_value) as revenue,\n          AVG(peso_value) as avg_order_value\n        FROM transactions \n        WHERE timestamp >= $1 AND timestamp <= $2\n        GROUP BY campaign_influenced\n      `\n        };\n        const query = queries[analysisType];\n        if (!query) {\n            return {\n                data: null,\n                error: 'Invalid analysis type'\n            };\n        }\n        return this.executeRawQuery(query, [\n            params.dateFrom || '2024-01-01',\n            params.dateTo || '2024-12-31'\n        ], cacheKey, 900000 // 15 minutes cache\n        );\n    }\n    /**\n   * Invalidate all transaction-related caches\n   */ invalidateCache() {\n        this.clearCache();\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (TransactionDAL);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFFRSxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1WO1lBQzlCLE9BQU87Z0JBQUVTO2dCQUFNQztZQUFNO1FBQ3ZCLEdBQ0FmLFVBQ0EsT0FBTyxtQkFBbUI7O0lBRTlCO0lBRUE7O0dBRUMsR0FDRCxNQUFNOEIscUJBQ0pDLFlBQStELEVBQy9EQyxTQUE4QixDQUFDLENBQUMsRUFDdUI7UUFDdkQsTUFBTWhDLFdBQVcsQ0FBQyxTQUFTLEVBQUUrQixhQUFhLENBQUMsRUFBRTlCLEtBQUtDLFNBQVMsQ0FBQzhCLFFBQVEsQ0FBQztRQUVyRSxNQUFNQyxVQUFVO1lBQ2RDLFFBQVEsQ0FBQzs7Ozs7Ozs7Ozs7O01BWVQsQ0FBQztZQUNEQyxRQUFRLENBQUM7Ozs7Ozs7Ozs7OztNQVlULENBQUM7WUFDREMsV0FBVyxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7OztNQWlCWixDQUFDO1lBQ0RDLGFBQWEsQ0FBQzs7Ozs7Ozs7O01BU2QsQ0FBQztRQUNIO1FBRUEsTUFBTWhDLFFBQVE0QixPQUFPLENBQUNGLGFBQWE7UUFDbkMsSUFBSSxDQUFDMUIsT0FBTztZQUNWLE9BQU87Z0JBQUVTLE1BQU07Z0JBQU1DLE9BQU87WUFBd0I7UUFDdEQ7UUFFQSxPQUFPLElBQUksQ0FBQ3VCLGVBQWUsQ0FDekJqQyxPQUNBO1lBQUMyQixPQUFPdEIsUUFBUSxJQUFJO1lBQWNzQixPQUFPcEIsTUFBTSxJQUFJO1NBQWEsRUFDaEVaLFVBQ0EsT0FBTyxtQkFBbUI7O0lBRTlCO0lBRUE7O0dBRUMsR0FDRHVDLGtCQUF3QjtRQUN0QixJQUFJLENBQUNDLFVBQVU7SUFDakI7QUFDRjtBQUVBLGlFQUFlM0MsY0FBY0EsRUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL3Njb3V0LWRhc2hib2FyZC1uZXh0anMvLi9saWIvZGFsL3RyYW5zYWN0aW9ucy50cz8xZmJiIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVHJhbnNhY3Rpb24gRGF0YSBBY2Nlc3MgTGF5ZXJcbiAqIEhhbmRsZXMgYWxsIHRyYW5zYWN0aW9uLXJlbGF0ZWQgZGF0YWJhc2Ugb3BlcmF0aW9uc1xuICovXG5cbmltcG9ydCBCYXNlREFMIGZyb20gJy4vYmFzZSdcbmltcG9ydCB0eXBlIHsgVHJlbmREYXRhLCBCZWhhdmlvckRhdGEsIFByb2R1Y3RNaXhEYXRhLCBQcm9maWxpbmdEYXRhLCBHZW9EYXRhLCBUaW1lSGVhdG1hcERhdGEsIENvbXBldGl0aXZlRGF0YSB9IGZyb20gJ0AvbGliL3R5cGVzL3RyYW5zYWN0aW9ucydcblxuZXhwb3J0IGludGVyZmFjZSBUcmFuc2FjdGlvbkZpbHRlcnMge1xuICBkYXRlRnJvbT86IHN0cmluZ1xuICBkYXRlVG8/OiBzdHJpbmdcbiAgcmVnaW9ucz86IHN0cmluZ1tdXG4gIHByb3ZpbmNlcz86IHN0cmluZ1tdXG4gIHN0b3Jlcz86IHN0cmluZ1tdXG4gIGJyYW5kcz86IHN0cmluZ1tdXG4gIGNhdGVnb3JpZXM/OiBzdHJpbmdbXVxuICBnZW5kZXJzPzogc3RyaW5nW11cbiAgYWdlQnJhY2tldHM/OiBzdHJpbmdbXVxuICBwYXltZW50TWV0aG9kcz86IHN0cmluZ1tdXG4gIGN1c3RvbWVyVHlwZXM/OiBzdHJpbmdbXVxufVxuXG5jbGFzcyBUcmFuc2FjdGlvbkRBTCBleHRlbmRzIEJhc2VEQUwge1xuXG4gIC8qKlxuICAgKiBHZXQgZGFpbHkgdHJhbnNhY3Rpb24gdHJlbmRzIHdpdGggb3B0aW9uYWwgZmlsdGVyc1xuICAgKi9cbiAgYXN5bmMgZ2V0VHJlbmRzKGZpbHRlcnM6IFRyYW5zYWN0aW9uRmlsdGVycyA9IHt9KTogUHJvbWlzZTx7IGRhdGE6IFRyZW5kRGF0YVtdIHwgbnVsbDsgZXJyb3I6IHN0cmluZyB8IG51bGwgfT4ge1xuICAgIGNvbnN0IGNhY2hlS2V5ID0gYHRyZW5kc18ke0pTT04uc3RyaW5naWZ5KGZpbHRlcnMpfWBcbiAgICBcbiAgICByZXR1cm4gdGhpcy5leGVjdXRlUXVlcnk8VHJlbmREYXRhW10+KFxuICAgICAgYXN5bmMgKGNsaWVudCkgPT4ge1xuICAgICAgICBsZXQgcXVlcnkgPSBjbGllbnRcbiAgICAgICAgICAuZnJvbSgndl90cmVuZHNfZGFpbHknKVxuICAgICAgICAgIC5zZWxlY3QoJ2RheSwgdHhfY291bnQsIHNhbGVzLCBhdmdfdHJhbnNhY3Rpb24nKVxuICAgICAgICAgIC5vcmRlcignZGF5JywgeyBhc2NlbmRpbmc6IHRydWUgfSlcblxuICAgICAgICAvLyBBcHBseSBkYXRlIGZpbHRlcnNcbiAgICAgICAgaWYgKGZpbHRlcnMuZGF0ZUZyb20pIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lmd0ZSgnZGF5JywgZmlsdGVycy5kYXRlRnJvbSlcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsdGVycy5kYXRlVG8pIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lmx0ZSgnZGF5JywgZmlsdGVycy5kYXRlVG8pXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBxdWVyeVxuICAgICAgICByZXR1cm4geyBkYXRhLCBlcnJvciB9XG4gICAgICB9LFxuICAgICAgY2FjaGVLZXksXG4gICAgICAzMDAwMDAgLy8gNSBtaW51dGVzIGNhY2hlXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjb25zdW1lciBiZWhhdmlvciBwYXR0ZXJuc1xuICAgKi9cbiAgYXN5bmMgZ2V0QmVoYXZpb3JEYXRhKGZpbHRlcnM6IFRyYW5zYWN0aW9uRmlsdGVycyA9IHt9KTogUHJvbWlzZTx7IGRhdGE6IEJlaGF2aW9yRGF0YVtdIHwgbnVsbDsgZXJyb3I6IHN0cmluZyB8IG51bGwgfT4ge1xuICAgIGNvbnN0IGNhY2hlS2V5ID0gYGJlaGF2aW9yXyR7SlNPTi5zdHJpbmdpZnkoZmlsdGVycyl9YFxuICAgIFxuICAgIHJldHVybiB0aGlzLmV4ZWN1dGVRdWVyeTxCZWhhdmlvckRhdGFbXT4oXG4gICAgICBhc3luYyAoY2xpZW50KSA9PiB7XG4gICAgICAgIGxldCBxdWVyeSA9IGNsaWVudFxuICAgICAgICAgIC5mcm9tKCd2X2JlaGF2aW9yX3BhdHRlcm5zJylcbiAgICAgICAgICAuc2VsZWN0KCdyZXF1ZXN0X3R5cGUsIG4sIGFjY2VwdGFuY2VfcmF0ZScpXG4gICAgICAgICAgLm9yZGVyKCduJywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG5cbiAgICAgICAgLy8gQXBwbHkgZmlsdGVycyBpZiBuZWVkZWRcbiAgICAgICAgaWYgKGZpbHRlcnMuZGF0ZUZyb20pIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lmd0ZSgnY3JlYXRlZF9hdCcsIGZpbHRlcnMuZGF0ZUZyb20pXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpbHRlcnMuZGF0ZVRvKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5sdGUoJ2NyZWF0ZWRfYXQnLCBmaWx0ZXJzLmRhdGVUbylcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHF1ZXJ5XG4gICAgICAgIHJldHVybiB7IGRhdGEsIGVycm9yIH1cbiAgICAgIH0sXG4gICAgICBjYWNoZUtleSxcbiAgICAgIDYwMDAwMCAvLyAxMCBtaW51dGVzIGNhY2hlXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBwcm9kdWN0IG1peCBhbmFseXNpc1xuICAgKi9cbiAgYXN5bmMgZ2V0UHJvZHVjdE1peChmaWx0ZXJzOiBUcmFuc2FjdGlvbkZpbHRlcnMgPSB7fSk6IFByb21pc2U8eyBkYXRhOiBQcm9kdWN0TWl4RGF0YVtdIHwgbnVsbDsgZXJyb3I6IHN0cmluZyB8IG51bGwgfT4ge1xuICAgIGNvbnN0IGNhY2hlS2V5ID0gYHByb2R1Y3RfbWl4XyR7SlNPTi5zdHJpbmdpZnkoZmlsdGVycyl9YFxuICAgIFxuICAgIHJldHVybiB0aGlzLmV4ZWN1dGVRdWVyeTxQcm9kdWN0TWl4RGF0YVtdPihcbiAgICAgIGFzeW5jIChjbGllbnQpID0+IHtcbiAgICAgICAgbGV0IHF1ZXJ5ID0gY2xpZW50XG4gICAgICAgICAgLmZyb20oJ3ZfcHJvZHVjdF9taXgnKVxuICAgICAgICAgIC5zZWxlY3QoJ3Byb2R1Y3RfY2F0ZWdvcnksIGJyYW5kX25hbWUsIG4sIHRvdGFsX3NhbGVzJylcbiAgICAgICAgICAub3JkZXIoJ3RvdGFsX3NhbGVzJywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG5cbiAgICAgICAgLy8gQXBwbHkgZmlsdGVyc1xuICAgICAgICBpZiAoZmlsdGVycy5jYXRlZ29yaWVzPy5sZW5ndGgpIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LmluKCdwcm9kdWN0X2NhdGVnb3J5JywgZmlsdGVycy5jYXRlZ29yaWVzKVxuICAgICAgICB9XG4gICAgICAgIGlmIChmaWx0ZXJzLmJyYW5kcz8ubGVuZ3RoKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5pbignYnJhbmRfbmFtZScsIGZpbHRlcnMuYnJhbmRzKVxuICAgICAgICB9XG4gICAgICAgIGlmIChmaWx0ZXJzLmRhdGVGcm9tKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5ndGUoJ2NyZWF0ZWRfYXQnLCBmaWx0ZXJzLmRhdGVGcm9tKVxuICAgICAgICB9XG4gICAgICAgIGlmIChmaWx0ZXJzLmRhdGVUbykge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkubHRlKCdjcmVhdGVkX2F0JywgZmlsdGVycy5kYXRlVG8pXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBxdWVyeVxuICAgICAgICByZXR1cm4geyBkYXRhLCBlcnJvciB9XG4gICAgICB9LFxuICAgICAgY2FjaGVLZXksXG4gICAgICAzMDAwMDAgLy8gNSBtaW51dGVzIGNhY2hlXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjb25zdW1lciBwcm9maWxpbmcgZGF0YVxuICAgKi9cbiAgYXN5bmMgZ2V0UHJvZmlsaW5nKGZpbHRlcnM6IFRyYW5zYWN0aW9uRmlsdGVycyA9IHt9KTogUHJvbWlzZTx7IGRhdGE6IFByb2ZpbGluZ0RhdGFbXSB8IG51bGw7IGVycm9yOiBzdHJpbmcgfCBudWxsIH0+IHtcbiAgICBjb25zdCBjYWNoZUtleSA9IGBwcm9maWxpbmdfJHtKU09OLnN0cmluZ2lmeShmaWx0ZXJzKX1gXG4gICAgXG4gICAgcmV0dXJuIHRoaXMuZXhlY3V0ZVF1ZXJ5PFByb2ZpbGluZ0RhdGFbXT4oXG4gICAgICBhc3luYyAoY2xpZW50KSA9PiB7XG4gICAgICAgIGxldCBxdWVyeSA9IGNsaWVudFxuICAgICAgICAgIC5mcm9tKCd2X2NvbnN1bWVyX3Byb2ZpbGluZycpXG4gICAgICAgICAgLnNlbGVjdCgnZ2VuZGVyLCBhZ2VfYnJhY2tldCwgbiwgYXZnX3NwZW5kJylcbiAgICAgICAgICAub3JkZXIoJ24nLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcblxuICAgICAgICAvLyBBcHBseSBmaWx0ZXJzXG4gICAgICAgIGlmIChmaWx0ZXJzLmdlbmRlcnM/Lmxlbmd0aCkge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkuaW4oJ2dlbmRlcicsIGZpbHRlcnMuZ2VuZGVycylcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsdGVycy5hZ2VCcmFja2V0cz8ubGVuZ3RoKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5pbignYWdlX2JyYWNrZXQnLCBmaWx0ZXJzLmFnZUJyYWNrZXRzKVxuICAgICAgICB9XG4gICAgICAgIGlmIChmaWx0ZXJzLmRhdGVGcm9tKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5ndGUoJ2NyZWF0ZWRfYXQnLCBmaWx0ZXJzLmRhdGVGcm9tKVxuICAgICAgICB9XG4gICAgICAgIGlmIChmaWx0ZXJzLmRhdGVUbykge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkubHRlKCdjcmVhdGVkX2F0JywgZmlsdGVycy5kYXRlVG8pXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBxdWVyeVxuICAgICAgICByZXR1cm4geyBkYXRhLCBlcnJvciB9XG4gICAgICB9LFxuICAgICAgY2FjaGVLZXksXG4gICAgICA2MDAwMDAgLy8gMTAgbWludXRlcyBjYWNoZVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZ2VvZ3JhcGhpYyBkaXN0cmlidXRpb24gZGF0YVxuICAgKi9cbiAgYXN5bmMgZ2V0R2VvRGF0YShmaWx0ZXJzOiBUcmFuc2FjdGlvbkZpbHRlcnMgPSB7fSk6IFByb21pc2U8eyBkYXRhOiBHZW9EYXRhW10gfCBudWxsOyBlcnJvcjogc3RyaW5nIHwgbnVsbCB9PiB7XG4gICAgY29uc3QgY2FjaGVLZXkgPSBgZ2VvXyR7SlNPTi5zdHJpbmdpZnkoZmlsdGVycyl9YFxuICAgIFxuICAgIHJldHVybiB0aGlzLmV4ZWN1dGVRdWVyeTxHZW9EYXRhW10+KFxuICAgICAgYXN5bmMgKGNsaWVudCkgPT4ge1xuICAgICAgICBsZXQgcXVlcnkgPSBjbGllbnRcbiAgICAgICAgICAuZnJvbSgndl9nZW9fcHJvdmluY2UnKVxuICAgICAgICAgIC5zZWxlY3QoJ3Byb3ZpbmNlLCB0eF9jb3VudCwgc2FsZXMsIGF2Z190cmFuc2FjdGlvbiwgcmVnaW9uX25hbWUsIHByb3ZpbmNlX2NvZGUnKVxuICAgICAgICAgIC5vcmRlcigndHhfY291bnQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcblxuICAgICAgICAvLyBBcHBseSBmaWx0ZXJzXG4gICAgICAgIGlmIChmaWx0ZXJzLnJlZ2lvbnM/Lmxlbmd0aCkge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkuaW4oJ3JlZ2lvbl9uYW1lJywgZmlsdGVycy5yZWdpb25zKVxuICAgICAgICB9XG4gICAgICAgIGlmIChmaWx0ZXJzLnByb3ZpbmNlcz8ubGVuZ3RoKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5pbigncHJvdmluY2UnLCBmaWx0ZXJzLnByb3ZpbmNlcylcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsdGVycy5kYXRlRnJvbSkge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkuZ3RlKCdjcmVhdGVkX2F0JywgZmlsdGVycy5kYXRlRnJvbSlcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsdGVycy5kYXRlVG8pIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lmx0ZSgnY3JlYXRlZF9hdCcsIGZpbHRlcnMuZGF0ZVRvKVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgcXVlcnlcbiAgICAgICAgcmV0dXJuIHsgZGF0YSwgZXJyb3IgfVxuICAgICAgfSxcbiAgICAgIGNhY2hlS2V5LFxuICAgICAgMzAwMDAwIC8vIDUgbWludXRlcyBjYWNoZVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGltZS1iYXNlZCBoZWF0bWFwIGRhdGFcbiAgICovXG4gIGFzeW5jIGdldFRpbWVIZWF0bWFwKGZpbHRlcnM6IFRyYW5zYWN0aW9uRmlsdGVycyA9IHt9KTogUHJvbWlzZTx7IGRhdGE6IFRpbWVIZWF0bWFwRGF0YVtdIHwgbnVsbDsgZXJyb3I6IHN0cmluZyB8IG51bGwgfT4ge1xuICAgIGNvbnN0IGNhY2hlS2V5ID0gYHRpbWVfaGVhdG1hcF8ke0pTT04uc3RyaW5naWZ5KGZpbHRlcnMpfWBcbiAgICBcbiAgICByZXR1cm4gdGhpcy5leGVjdXRlUXVlcnk8VGltZUhlYXRtYXBEYXRhW10+KFxuICAgICAgYXN5bmMgKGNsaWVudCkgPT4ge1xuICAgICAgICBsZXQgcXVlcnkgPSBjbGllbnRcbiAgICAgICAgICAuZnJvbSgndl90aW1lX2hlYXRtYXAnKVxuICAgICAgICAgIC5zZWxlY3QoJ3RpbWVfb2ZfZGF5LCBkYXlfb2Zfd2VlaywgdHhfY291bnQsIGF2Z192YWx1ZScpXG4gICAgICAgICAgLm9yZGVyKCdkYXlfb2Zfd2VlaycsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG4gICAgICAgICAgLm9yZGVyKCd0aW1lX29mX2RheScsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG5cbiAgICAgICAgLy8gQXBwbHkgZGF0ZSBmaWx0ZXJzXG4gICAgICAgIGlmIChmaWx0ZXJzLmRhdGVGcm9tKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5ndGUoJ2NyZWF0ZWRfYXQnLCBmaWx0ZXJzLmRhdGVGcm9tKVxuICAgICAgICB9XG4gICAgICAgIGlmIChmaWx0ZXJzLmRhdGVUbykge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkubHRlKCdjcmVhdGVkX2F0JywgZmlsdGVycy5kYXRlVG8pXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBxdWVyeVxuICAgICAgICByZXR1cm4geyBkYXRhLCBlcnJvciB9XG4gICAgICB9LFxuICAgICAgY2FjaGVLZXksXG4gICAgICA2MDAwMDAgLy8gMTAgbWludXRlcyBjYWNoZVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY29tcGV0aXRpdmUgYW5hbHlzaXMgZGF0YVxuICAgKi9cbiAgYXN5bmMgZ2V0Q29tcGV0aXRpdmVEYXRhKGZpbHRlcnM6IFRyYW5zYWN0aW9uRmlsdGVycyA9IHt9KTogUHJvbWlzZTx7IGRhdGE6IENvbXBldGl0aXZlRGF0YVtdIHwgbnVsbDsgZXJyb3I6IHN0cmluZyB8IG51bGwgfT4ge1xuICAgIGNvbnN0IGNhY2hlS2V5ID0gYGNvbXBldGl0aXZlXyR7SlNPTi5zdHJpbmdpZnkoZmlsdGVycyl9YFxuICAgIFxuICAgIHJldHVybiB0aGlzLmV4ZWN1dGVRdWVyeTxDb21wZXRpdGl2ZURhdGFbXT4oXG4gICAgICBhc3luYyAoY2xpZW50KSA9PiB7XG4gICAgICAgIGxldCBxdWVyeSA9IGNsaWVudFxuICAgICAgICAgIC5mcm9tKCd2X2NvbXBldGl0aXZlX2FuYWx5c2lzJylcbiAgICAgICAgICAuc2VsZWN0KGBcbiAgICAgICAgICAgIGJyYW5kX25hbWUsIFxuICAgICAgICAgICAgcHJvZHVjdF9jYXRlZ29yeSwgXG4gICAgICAgICAgICBtYXJrZXRfc2hhcmUsIFxuICAgICAgICAgICAgdG90YWxfcmV2ZW51ZSwgXG4gICAgICAgICAgICBhdmdfcHJpY2VfcG9pbnQsIFxuICAgICAgICAgICAgYWNjZXB0YW5jZV9yYXRlLFxuICAgICAgICAgICAgaXNfdGJ3YV9jbGllbnQsXG4gICAgICAgICAgICB0aWVyX2NsYXNzaWZpY2F0aW9uXG4gICAgICAgICAgYClcbiAgICAgICAgICAub3JkZXIoJ21hcmtldF9zaGFyZScsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuXG4gICAgICAgIC8vIEFwcGx5IGZpbHRlcnNcbiAgICAgICAgaWYgKGZpbHRlcnMuY2F0ZWdvcmllcz8ubGVuZ3RoKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5pbigncHJvZHVjdF9jYXRlZ29yeScsIGZpbHRlcnMuY2F0ZWdvcmllcylcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsdGVycy5icmFuZHM/Lmxlbmd0aCkge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkuaW4oJ2JyYW5kX25hbWUnLCBmaWx0ZXJzLmJyYW5kcylcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsdGVycy5kYXRlRnJvbSkge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkuZ3RlKCdjcmVhdGVkX2F0JywgZmlsdGVycy5kYXRlRnJvbSlcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsdGVycy5kYXRlVG8pIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lmx0ZSgnY3JlYXRlZF9hdCcsIGZpbHRlcnMuZGF0ZVRvKVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgcXVlcnlcbiAgICAgICAgcmV0dXJuIHsgZGF0YSwgZXJyb3IgfVxuICAgICAgfSxcbiAgICAgIGNhY2hlS2V5LFxuICAgICAgNjAwMDAwIC8vIDEwIG1pbnV0ZXMgY2FjaGVcbiAgICApXG4gIH1cblxuICAvKipcbiAgICogR2V0IGFkdmFuY2VkIGFuYWx5dGljcyB3aXRoIGN1c3RvbSBTUUxcbiAgICovXG4gIGFzeW5jIGdldEFkdmFuY2VkQW5hbHl0aWNzKFxuICAgIGFuYWx5c2lzVHlwZTogJ2NvaG9ydCcgfCAnZnVubmVsJyB8ICdyZXRlbnRpb24nIHwgJ2F0dHJpYnV0aW9uJyxcbiAgICBwYXJhbXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fVxuICApOiBQcm9taXNlPHsgZGF0YTogYW55W10gfCBudWxsOyBlcnJvcjogc3RyaW5nIHwgbnVsbCB9PiB7XG4gICAgY29uc3QgY2FjaGVLZXkgPSBgYWR2YW5jZWRfJHthbmFseXNpc1R5cGV9XyR7SlNPTi5zdHJpbmdpZnkocGFyYW1zKX1gXG5cbiAgICBjb25zdCBxdWVyaWVzID0ge1xuICAgICAgY29ob3J0OiBgXG4gICAgICAgIFdJVEggY29ob3J0cyBBUyAoXG4gICAgICAgICAgU0VMRUNUIFxuICAgICAgICAgICAgREFURV9UUlVOQygnbW9udGgnLCB0aW1lc3RhbXA6OmRhdGUpIGFzIGNvaG9ydF9tb250aCxcbiAgICAgICAgICAgIHN0b3JlX2lkLFxuICAgICAgICAgICAgQ09VTlQoKikgYXMgdHhfY291bnQsXG4gICAgICAgICAgICBBVkcocGVzb192YWx1ZSkgYXMgYXZnX3NwZW5kXG4gICAgICAgICAgRlJPTSB0cmFuc2FjdGlvbnMgXG4gICAgICAgICAgV0hFUkUgdGltZXN0YW1wID49ICQxIEFORCB0aW1lc3RhbXAgPD0gJDJcbiAgICAgICAgICBHUk9VUCBCWSBjb2hvcnRfbW9udGgsIHN0b3JlX2lkXG4gICAgICAgIClcbiAgICAgICAgU0VMRUNUICogRlJPTSBjb2hvcnRzIE9SREVSIEJZIGNvaG9ydF9tb250aFxuICAgICAgYCxcbiAgICAgIGZ1bm5lbDogYFxuICAgICAgICBTRUxFQ1QgXG4gICAgICAgICAgJ2F3YXJlbmVzcycgYXMgc3RhZ2UsIENPVU5UKERJU1RJTkNUIHN0b3JlX2lkKSBhcyBjb3VudFxuICAgICAgICBGUk9NIHRyYW5zYWN0aW9ucyBXSEVSRSBjYW1wYWlnbl9pbmZsdWVuY2VkID0gdHJ1ZVxuICAgICAgICBVTklPTiBBTExcbiAgICAgICAgU0VMRUNUIFxuICAgICAgICAgICdjb25zaWRlcmF0aW9uJyBhcyBzdGFnZSwgQ09VTlQoRElTVElOQ1Qgc3RvcmVfaWQpIGFzIGNvdW50XG4gICAgICAgIEZST00gdHJhbnNhY3Rpb25zIFdIRVJFIHJlcXVlc3RfdHlwZSAhPSAnaW5kaXJlY3QnXG4gICAgICAgIFVOSU9OIEFMTFxuICAgICAgICBTRUxFQ1QgXG4gICAgICAgICAgJ3B1cmNoYXNlJyBhcyBzdGFnZSwgQ09VTlQoRElTVElOQ1Qgc3RvcmVfaWQpIGFzIGNvdW50XG4gICAgICAgIEZST00gdHJhbnNhY3Rpb25zIFdIRVJFIHBlc29fdmFsdWUgPiAwXG4gICAgICBgLFxuICAgICAgcmV0ZW50aW9uOiBgXG4gICAgICAgIFdJVEggdXNlcl9hY3Rpdml0eSBBUyAoXG4gICAgICAgICAgU0VMRUNUIFxuICAgICAgICAgICAgc3RvcmVfaWQsXG4gICAgICAgICAgICBEQVRFX1RSVU5DKCdtb250aCcsIHRpbWVzdGFtcDo6ZGF0ZSkgYXMgYWN0aXZpdHlfbW9udGgsXG4gICAgICAgICAgICBDT1VOVCgqKSBhcyB0eF9jb3VudFxuICAgICAgICAgIEZST00gdHJhbnNhY3Rpb25zIFxuICAgICAgICAgIFdIRVJFIHRpbWVzdGFtcCA+PSAkMSBBTkQgdGltZXN0YW1wIDw9ICQyXG4gICAgICAgICAgR1JPVVAgQlkgc3RvcmVfaWQsIGFjdGl2aXR5X21vbnRoXG4gICAgICAgIClcbiAgICAgICAgU0VMRUNUIFxuICAgICAgICAgIGFjdGl2aXR5X21vbnRoLFxuICAgICAgICAgIENPVU5UKERJU1RJTkNUIHN0b3JlX2lkKSBhcyBhY3RpdmVfc3RvcmVzLFxuICAgICAgICAgIEFWRyh0eF9jb3VudCkgYXMgYXZnX3RyYW5zYWN0aW9uc1xuICAgICAgICBGUk9NIHVzZXJfYWN0aXZpdHlcbiAgICAgICAgR1JPVVAgQlkgYWN0aXZpdHlfbW9udGhcbiAgICAgICAgT1JERVIgQlkgYWN0aXZpdHlfbW9udGhcbiAgICAgIGAsXG4gICAgICBhdHRyaWJ1dGlvbjogYFxuICAgICAgICBTRUxFQ1QgXG4gICAgICAgICAgQ0FTRSBXSEVOIGNhbXBhaWduX2luZmx1ZW5jZWQgVEhFTiAnQ2FtcGFpZ24nIEVMU0UgJ09yZ2FuaWMnIEVORCBhcyBzb3VyY2UsXG4gICAgICAgICAgQ09VTlQoKikgYXMgdHJhbnNhY3Rpb25zLFxuICAgICAgICAgIFNVTShwZXNvX3ZhbHVlKSBhcyByZXZlbnVlLFxuICAgICAgICAgIEFWRyhwZXNvX3ZhbHVlKSBhcyBhdmdfb3JkZXJfdmFsdWVcbiAgICAgICAgRlJPTSB0cmFuc2FjdGlvbnMgXG4gICAgICAgIFdIRVJFIHRpbWVzdGFtcCA+PSAkMSBBTkQgdGltZXN0YW1wIDw9ICQyXG4gICAgICAgIEdST1VQIEJZIGNhbXBhaWduX2luZmx1ZW5jZWRcbiAgICAgIGBcbiAgICB9XG5cbiAgICBjb25zdCBxdWVyeSA9IHF1ZXJpZXNbYW5hbHlzaXNUeXBlXVxuICAgIGlmICghcXVlcnkpIHtcbiAgICAgIHJldHVybiB7IGRhdGE6IG51bGwsIGVycm9yOiAnSW52YWxpZCBhbmFseXNpcyB0eXBlJyB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZXhlY3V0ZVJhd1F1ZXJ5KFxuICAgICAgcXVlcnksXG4gICAgICBbcGFyYW1zLmRhdGVGcm9tIHx8ICcyMDI0LTAxLTAxJywgcGFyYW1zLmRhdGVUbyB8fCAnMjAyNC0xMi0zMSddLFxuICAgICAgY2FjaGVLZXksXG4gICAgICA5MDAwMDAgLy8gMTUgbWludXRlcyBjYWNoZVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBJbnZhbGlkYXRlIGFsbCB0cmFuc2FjdGlvbi1yZWxhdGVkIGNhY2hlc1xuICAgKi9cbiAgaW52YWxpZGF0ZUNhY2hlKCk6IHZvaWQge1xuICAgIHRoaXMuY2xlYXJDYWNoZSgpXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVHJhbnNhY3Rpb25EQUwiXSwibmFtZXMiOlsiQmFzZURBTCIsIlRyYW5zYWN0aW9uREFMIiwiZ2V0VHJlbmRzIiwiZmlsdGVycyIsImNhY2hlS2V5IiwiSlNPTiIsInN0cmluZ2lmeSIsImV4ZWN1dGVRdWVyeSIsImNsaWVudCIsInF1ZXJ5IiwiZnJvbSIsInNlbGVjdCIsIm9yZGVyIiwiYXNjZW5kaW5nIiwiZGF0ZUZyb20iLCJndGUiLCJkYXRlVG8iLCJsdGUiLCJkYXRhIiwiZXJyb3IiLCJnZXRCZWhhdmlvckRhdGEiLCJnZXRQcm9kdWN0TWl4IiwiY2F0ZWdvcmllcyIsImxlbmd0aCIsImluIiwiYnJhbmRzIiwiZ2V0UHJvZmlsaW5nIiwiZ2VuZGVycyIsImFnZUJyYWNrZXRzIiwiZ2V0R2VvRGF0YSIsInJlZ2lvbnMiLCJwcm92aW5jZXMiLCJnZXRUaW1lSGVhdG1hcCIsImdldENvbXBldGl0aXZlRGF0YSIsImdldEFkdmFuY2VkQW5hbHl0aWNzIiwiYW5hbHlzaXNUeXBlIiwicGFyYW1zIiwicXVlcmllcyIsImNvaG9ydCIsImZ1bm5lbCIsInJldGVudGlvbiIsImF0dHJpYnV0aW9uIiwiZXhlY3V0ZVJhd1F1ZXJ5IiwiaW52YWxpZGF0ZUNhY2hlIiwiY2xlYXJDYWNoZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/dal/transactions.ts\n");

/***/ }),

/***/ "(rsc)/./lib/services/analytics.ts":
/*!***********************************!*\
  !*** ./lib/services/analytics.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _lib_dal_transactions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/dal/transactions */ \"(rsc)/./lib/dal/transactions.ts\");\n/* harmony import */ var _lib_dal_ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/dal/ai */ \"(rsc)/./lib/dal/ai.ts\");\n/**\n * Analytics Service Layer\n * Orchestrates DAL operations and business logic for analytics\n */ \n\nclass AnalyticsService {\n    constructor(options = {}){\n        this.transactionDAL = new _lib_dal_transactions__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\n        this.aiDAL = new _lib_dal_ai__WEBPACK_IMPORTED_MODULE_1__[\"default\"]();\n        this.options = {\n            enableCaching: true,\n            enableAI: true,\n            defaultCacheTTL: 300000,\n            ...options\n        };\n    }\n    /**\n   * Get comprehensive dashboard data for a specific view\n   */ async getDashboardData(section, filters = {}, includeAI = true) {\n        try {\n            let dashboardData = {};\n            let insights = [];\n            let recommendations = [];\n            // Get section-specific data\n            switch(section){\n                case 'transaction-trends':\n                    const { data: trendsData, error: trendsError } = await this.transactionDAL.getTrends(filters);\n                    if (trendsError) throw new Error(trendsError);\n                    dashboardData.trends = trendsData;\n                    break;\n                case 'product-mix':\n                    const { data: productData, error: productError } = await this.transactionDAL.getProductMix(filters);\n                    if (productError) throw new Error(productError);\n                    dashboardData.productMix = productData;\n                    break;\n                case 'consumer-behavior':\n                    const { data: behaviorData, error: behaviorError } = await this.transactionDAL.getBehaviorData(filters);\n                    if (behaviorError) throw new Error(behaviorError);\n                    dashboardData.behavior = behaviorData;\n                    break;\n                case 'consumer-profiling':\n                    const { data: profilingData, error: profilingError } = await this.transactionDAL.getProfiling(filters);\n                    if (profilingError) throw new Error(profilingError);\n                    dashboardData.profiling = profilingData;\n                    break;\n                case 'geographical-intelligence':\n                    const { data: geoData, error: geoError } = await this.transactionDAL.getGeoData(filters);\n                    if (geoError) throw new Error(geoError);\n                    dashboardData.geo = geoData;\n                    break;\n                case 'competitive-analysis':\n                    const { data: competitiveData, error: competitiveError } = await this.transactionDAL.getCompetitiveData(filters);\n                    if (competitiveError) throw new Error(competitiveError);\n                    dashboardData.competitive = competitiveData;\n                    break;\n                default:\n                    // Get overview data for general dashboard\n                    const [trendsResult, behaviorResult, geoResult] = await Promise.all([\n                        this.transactionDAL.getTrends(filters),\n                        this.transactionDAL.getBehaviorData(filters),\n                        this.transactionDAL.getGeoData(filters)\n                    ]);\n                    dashboardData = {\n                        trends: trendsResult.data,\n                        behavior: behaviorResult.data,\n                        geo: geoResult.data\n                    };\n            }\n            // Get AI insights and recommendations if enabled\n            if (includeAI && this.options.enableAI) {\n                const [insightsResult, recommendationsResult] = await Promise.all([\n                    this.aiDAL.generateInsights({\n                        context: section,\n                        filters,\n                        analysisType: 'trends',\n                        timeframe: '30d'\n                    }),\n                    this.aiDAL.getRecommendations(section, {\n                        filters\n                    })\n                ]);\n                insights = insightsResult.data || [];\n                recommendations = recommendationsResult.data || [];\n            }\n            return {\n                data: dashboardData,\n                insights,\n                recommendations\n            };\n        } catch (error) {\n            return {\n                data: null,\n                error: error.message\n            };\n        }\n    }\n    /**\n   * Get time-based heatmap data with insights\n   */ async getTimeAnalysis(filters = {}) {\n        try {\n            const { data: heatmapData, error } = await this.transactionDAL.getTimeHeatmap(filters);\n            if (error) throw new Error(error);\n            // Generate time-based insights\n            const insights = await this.generateTimeInsights(heatmapData || []);\n            return {\n                heatmap: heatmapData,\n                insights\n            };\n        } catch (error) {\n            return {\n                heatmap: null,\n                insights: [],\n                error: error.message\n            };\n        }\n    }\n    /**\n   * Perform advanced analytics\n   */ async getAdvancedAnalytics(analysisType, params = {}) {\n        try {\n            const { data, error } = await this.transactionDAL.getAdvancedAnalytics(analysisType, params);\n            if (error) throw new Error(error);\n            // Generate insights from advanced analytics\n            const insights = await this.generateAdvancedInsights(analysisType, data || []);\n            return {\n                data,\n                insights\n            };\n        } catch (error) {\n            return {\n                data: null,\n                insights: [],\n                error: error.message\n            };\n        }\n    }\n    /**\n   * Chat interface for natural language queries\n   */ async processChatMessage(message, conversationId, context = {}) {\n        try {\n            // Store user message\n            const userMessage = {\n                id: `msg_${Date.now()}_user`,\n                conversation_id: conversationId,\n                role: 'user',\n                content: message,\n                context: context.dashboardState?.section || 'general',\n                filters: context.dashboardState?.filters,\n                created_at: new Date().toISOString()\n            };\n            await this.aiDAL.storeChatMessage(userMessage);\n            // Process natural language query\n            const fullContext = {\n                conversationId,\n                userContext: context.userContext,\n                dashboardState: context.dashboardState,\n                previousMessages: context.previousMessages\n            };\n            const { data: response, error } = await this.aiDAL.processNaturalLanguageQuery(message, fullContext);\n            if (error) throw new Error(error);\n            // Generate AI response\n            const assistantMessage = {\n                id: `msg_${Date.now()}_assistant`,\n                conversation_id: conversationId,\n                role: 'assistant',\n                content: response.message || this.generateContextualResponse(message, context),\n                context: context.dashboardState?.section || 'general',\n                created_at: new Date().toISOString()\n            };\n            // Store assistant response\n            await this.aiDAL.storeChatMessage(assistantMessage);\n            return {\n                response: assistantMessage,\n                suggestions: this.generateSuggestions(message, context),\n                actions: response.actions\n            };\n        } catch (error) {\n            return {\n                response: {\n                    id: `msg_${Date.now()}_error`,\n                    conversation_id: conversationId,\n                    role: 'assistant',\n                    content: 'I encountered an error processing your request. Please try again.',\n                    created_at: new Date().toISOString()\n                },\n                suggestions: [\n                    'Try a different question',\n                    'Check your filters',\n                    'Refresh the page'\n                ],\n                error: error.message\n            };\n        }\n    }\n    /**\n   * Get AI-powered insights for specific metrics\n   */ async getAIInsights(params) {\n        try {\n            const { data: insights, error } = await this.aiDAL.generateInsights(params);\n            if (error) throw new Error(error);\n            return {\n                insights: insights || []\n            };\n        } catch (error) {\n            return {\n                insights: [],\n                error: error.message\n            };\n        }\n    }\n    /**\n   * Detect anomalies in business metrics\n   */ async detectAnomalies(metric = 'sales', timeframe = '7d') {\n        try {\n            const { data: anomalies, error } = await this.aiDAL.detectAnomalies(metric, timeframe);\n            if (error) throw new Error(error);\n            // Generate insights from anomalies\n            const insights = await this.generateAnomalyInsights(anomalies || []);\n            return {\n                anomalies: anomalies || [],\n                insights\n            };\n        } catch (error) {\n            return {\n                anomalies: [],\n                insights: [],\n                error: error.message\n            };\n        }\n    }\n    /**\n   * Get predictions for business metrics\n   */ async getPredictions(metrics = [\n        'sales',\n        'transactions'\n    ], days = 30) {\n        try {\n            const { data: predictions, error } = await this.aiDAL.generatePredictions(metrics, days);\n            if (error) throw new Error(error);\n            // Generate insights from predictions\n            const insights = await this.generatePredictionInsights(predictions || []);\n            return {\n                predictions: predictions || [],\n                insights\n            };\n        } catch (error) {\n            return {\n                predictions: [],\n                insights: [],\n                error: error.message\n            };\n        }\n    }\n    /**\n   * Semantic search across analytics data\n   */ async semanticSearch(query, filters = {}) {\n        try {\n            const { data: results, error } = await this.aiDAL.semanticSearch(query, filters);\n            if (error) throw new Error(error);\n            return {\n                results: results || []\n            };\n        } catch (error) {\n            return {\n                results: [],\n                error: error.message\n            };\n        }\n    }\n    // Private helper methods\n    async generateTimeInsights(heatmapData) {\n        const insights = [];\n        if (heatmapData.length === 0) return insights;\n        // Find peak hours\n        const maxTx = Math.max(...heatmapData.map((d)=>d.tx_count));\n        const peakHours = heatmapData.filter((d)=>d.tx_count === maxTx);\n        if (peakHours.length > 0) {\n            insights.push({\n                id: `time_peak_${Date.now()}`,\n                type: 'trend',\n                title: 'Peak Performance Hours Identified',\n                description: `Highest transaction volume occurs during ${peakHours.map((h)=>h.time_of_day).join(', ')}`,\n                confidence: 0.9,\n                priority: 'medium',\n                category: 'operational',\n                recommendations: [\n                    'Schedule more staff during peak hours',\n                    'Plan promotional activities during high-traffic periods'\n                ],\n                created_at: new Date().toISOString()\n            });\n        }\n        return insights;\n    }\n    async generateAdvancedInsights(type, data) {\n        const insights = [];\n        switch(type){\n            case 'retention':\n                if (data.length > 0) {\n                    const avgRetention = data.reduce((sum, d)=>sum + d.active_stores, 0) / data.length;\n                    insights.push({\n                        id: `retention_${Date.now()}`,\n                        type: 'trend',\n                        title: 'Store Retention Analysis',\n                        description: `Average store retention is ${avgRetention.toFixed(1)} stores per month`,\n                        confidence: 0.8,\n                        priority: 'medium',\n                        category: 'operational',\n                        created_at: new Date().toISOString()\n                    });\n                }\n                break;\n            case 'attribution':\n                if (data.length > 0) {\n                    const campaignData = data.find((d)=>d.source === 'Campaign');\n                    const organicData = data.find((d)=>d.source === 'Organic');\n                    if (campaignData && organicData) {\n                        const campaignROI = campaignData.revenue / campaignData.transactions / (organicData.revenue / organicData.transactions);\n                        insights.push({\n                            id: `attribution_${Date.now()}`,\n                            type: 'prediction',\n                            title: 'Campaign Attribution Impact',\n                            description: `Campaign-influenced transactions have ${campaignROI.toFixed(1)}x higher value than organic`,\n                            confidence: 0.85,\n                            priority: 'high',\n                            category: 'marketing',\n                            created_at: new Date().toISOString()\n                        });\n                    }\n                }\n                break;\n        }\n        return insights;\n    }\n    async generateAnomalyInsights(anomalies) {\n        return anomalies.map((anomaly)=>({\n                id: `anomaly_insight_${Date.now()}_${anomaly.id || Math.random()}`,\n                type: 'anomaly',\n                title: `${anomaly.metric} Anomaly Detected`,\n                description: `Unusual ${anomaly.metric} value detected: ${anomaly.value}`,\n                confidence: 0.8,\n                priority: anomaly.severity === 'high' ? 'high' : 'medium',\n                category: 'operational',\n                recommendations: [\n                    'Investigate potential causes',\n                    'Check data quality',\n                    'Monitor for trend continuation'\n                ],\n                created_at: new Date().toISOString()\n            }));\n    }\n    async generatePredictionInsights(predictions) {\n        return predictions.map((prediction)=>({\n                id: `prediction_insight_${Date.now()}_${prediction.metric}`,\n                type: 'prediction',\n                title: `${prediction.metric} Forecast Generated`,\n                description: `30-day forecast shows ${prediction.forecast.length} data points with ${(prediction.confidence * 100).toFixed(1)}% confidence`,\n                confidence: prediction.confidence,\n                priority: prediction.confidence > 0.8 ? 'high' : 'medium',\n                category: 'financial',\n                created_at: new Date().toISOString()\n            }));\n    }\n    generateContextualResponse(message, context) {\n        const section = context.dashboardState?.section || 'general';\n        const responses = {\n            'transaction-trends': 'I can help you analyze transaction trends. What specific time period or metric interests you?',\n            'product-mix': 'I can analyze your product performance data. Which categories or brands would you like to explore?',\n            'consumer-behavior': 'I can provide insights into consumer behavior patterns. What aspect of customer behavior are you curious about?',\n            'geographical-intelligence': 'I can help with geographic performance analysis. Which regions or provinces are you interested in?',\n            'competitive-analysis': 'I can analyze competitive positioning and market share. What competitors or categories should we focus on?',\n            'general': 'I can help you explore your analytics data. What would you like to learn about your business performance?'\n        };\n        return responses[section] || responses.general;\n    }\n    generateSuggestions(message, context) {\n        const section = context.dashboardState?.section || 'general';\n        const suggestions = {\n            'transaction-trends': [\n                'Show me sales trends for the last 30 days',\n                'Compare this month vs last month',\n                'What are the peak transaction hours?'\n            ],\n            'product-mix': [\n                'Which products are top performers?',\n                'Show me category performance',\n                'Analyze brand market share'\n            ],\n            'consumer-behavior': [\n                'What are the most common purchase patterns?',\n                'Analyze customer segmentation',\n                'Show conversion funnel data'\n            ],\n            'geographical-intelligence': [\n                'Which regions perform best?',\n                'Compare provincial sales',\n                'Show geographic distribution'\n            ],\n            'competitive-analysis': [\n                'Compare competitor performance',\n                'Show market share trends',\n                'Analyze pricing strategies'\n            ],\n            'general': [\n                'Show me key performance indicators',\n                'What are the latest insights?',\n                'Generate a business summary'\n            ]\n        };\n        return suggestions[section] || suggestions.general;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AnalyticsService);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0E7YUFDRDtZQUNELGVBQWU7Z0JBQ2I7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUNELHFCQUFxQjtnQkFDbkI7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUNELDZCQUE2QjtnQkFDM0I7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUNELHdCQUF3QjtnQkFDdEI7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUNELFdBQVc7Z0JBQ1Q7Z0JBQ0E7Z0JBQ0E7YUFDRDtRQUNIO1FBRUEsT0FBT0EsV0FBVyxDQUFDMUUsUUFBb0MsSUFBSTBFLFlBQVl1RCxPQUFPO0lBQ2hGO0FBQ0Y7QUFFQSxpRUFBZTFJLGdCQUFnQkEsRUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL3Njb3V0LWRhc2hib2FyZC1uZXh0anMvLi9saWIvc2VydmljZXMvYW5hbHl0aWNzLnRzP2FkMjMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBBbmFseXRpY3MgU2VydmljZSBMYXllclxuICogT3JjaGVzdHJhdGVzIERBTCBvcGVyYXRpb25zIGFuZCBidXNpbmVzcyBsb2dpYyBmb3IgYW5hbHl0aWNzXG4gKi9cblxuaW1wb3J0IFRyYW5zYWN0aW9uREFMLCB7IFRyYW5zYWN0aW9uRmlsdGVycyB9IGZyb20gJ0AvbGliL2RhbC90cmFuc2FjdGlvbnMnXG5pbXBvcnQgQUlEQUwsIHsgQUlBbmFseXNpc1BhcmFtcywgQ2hhdENvbnRleHQgfSBmcm9tICdAL2xpYi9kYWwvYWknXG5pbXBvcnQgdHlwZSB7IFxuICBUcmVuZERhdGEsIFxuICBCZWhhdmlvckRhdGEsIFxuICBQcm9kdWN0TWl4RGF0YSwgXG4gIFByb2ZpbGluZ0RhdGEsIFxuICBHZW9EYXRhLCBcbiAgVGltZUhlYXRtYXBEYXRhLCBcbiAgQ29tcGV0aXRpdmVEYXRhIFxufSBmcm9tICdAL2xpYi90eXBlcy90cmFuc2FjdGlvbnMnXG5pbXBvcnQgdHlwZSB7IEFJSW5zaWdodCwgUmVjb21tZW5kYXRpb25EYXRhLCBDaGF0TWVzc2FnZSB9IGZyb20gJ0AvbGliL3R5cGVzL2FpJ1xuXG5leHBvcnQgaW50ZXJmYWNlIEFuYWx5dGljc1NlcnZpY2VPcHRpb25zIHtcbiAgZW5hYmxlQ2FjaGluZz86IGJvb2xlYW5cbiAgZW5hYmxlQUk/OiBib29sZWFuXG4gIGRlZmF1bHRDYWNoZVRUTD86IG51bWJlclxufVxuXG5jbGFzcyBBbmFseXRpY3NTZXJ2aWNlIHtcbiAgcHJpdmF0ZSB0cmFuc2FjdGlvbkRBTDogVHJhbnNhY3Rpb25EQUxcbiAgcHJpdmF0ZSBhaURBTDogQUlEQUxcbiAgcHJpdmF0ZSBvcHRpb25zOiBBbmFseXRpY3NTZXJ2aWNlT3B0aW9uc1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IEFuYWx5dGljc1NlcnZpY2VPcHRpb25zID0ge30pIHtcbiAgICB0aGlzLnRyYW5zYWN0aW9uREFMID0gbmV3IFRyYW5zYWN0aW9uREFMKClcbiAgICB0aGlzLmFpREFMID0gbmV3IEFJREFMKClcbiAgICB0aGlzLm9wdGlvbnMgPSB7XG4gICAgICBlbmFibGVDYWNoaW5nOiB0cnVlLFxuICAgICAgZW5hYmxlQUk6IHRydWUsXG4gICAgICBkZWZhdWx0Q2FjaGVUVEw6IDMwMDAwMCxcbiAgICAgIC4uLm9wdGlvbnNcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IGNvbXByZWhlbnNpdmUgZGFzaGJvYXJkIGRhdGEgZm9yIGEgc3BlY2lmaWMgdmlld1xuICAgKi9cbiAgYXN5bmMgZ2V0RGFzaGJvYXJkRGF0YShcbiAgICBzZWN0aW9uOiBzdHJpbmcsXG4gICAgZmlsdGVyczogVHJhbnNhY3Rpb25GaWx0ZXJzID0ge30sXG4gICAgaW5jbHVkZUFJOiBib29sZWFuID0gdHJ1ZVxuICApOiBQcm9taXNlPHtcbiAgICBkYXRhOiBhbnlcbiAgICBpbnNpZ2h0cz86IEFJSW5zaWdodFtdXG4gICAgcmVjb21tZW5kYXRpb25zPzogUmVjb21tZW5kYXRpb25EYXRhW11cbiAgICBlcnJvcj86IHN0cmluZ1xuICB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGxldCBkYXNoYm9hcmREYXRhOiBhbnkgPSB7fVxuICAgICAgbGV0IGluc2lnaHRzOiBBSUluc2lnaHRbXSA9IFtdXG4gICAgICBsZXQgcmVjb21tZW5kYXRpb25zOiBSZWNvbW1lbmRhdGlvbkRhdGFbXSA9IFtdXG5cbiAgICAgIC8vIEdldCBzZWN0aW9uLXNwZWNpZmljIGRhdGFcbiAgICAgIHN3aXRjaCAoc2VjdGlvbikge1xuICAgICAgICBjYXNlICd0cmFuc2FjdGlvbi10cmVuZHMnOlxuICAgICAgICAgIGNvbnN0IHsgZGF0YTogdHJlbmRzRGF0YSwgZXJyb3I6IHRyZW5kc0Vycm9yIH0gPSBhd2FpdCB0aGlzLnRyYW5zYWN0aW9uREFMLmdldFRyZW5kcyhmaWx0ZXJzKVxuICAgICAgICAgIGlmICh0cmVuZHNFcnJvcikgdGhyb3cgbmV3IEVycm9yKHRyZW5kc0Vycm9yKVxuICAgICAgICAgIGRhc2hib2FyZERhdGEudHJlbmRzID0gdHJlbmRzRGF0YVxuICAgICAgICAgIGJyZWFrXG5cbiAgICAgICAgY2FzZSAncHJvZHVjdC1taXgnOlxuICAgICAgICAgIGNvbnN0IHsgZGF0YTogcHJvZHVjdERhdGEsIGVycm9yOiBwcm9kdWN0RXJyb3IgfSA9IGF3YWl0IHRoaXMudHJhbnNhY3Rpb25EQUwuZ2V0UHJvZHVjdE1peChmaWx0ZXJzKVxuICAgICAgICAgIGlmIChwcm9kdWN0RXJyb3IpIHRocm93IG5ldyBFcnJvcihwcm9kdWN0RXJyb3IpXG4gICAgICAgICAgZGFzaGJvYXJkRGF0YS5wcm9kdWN0TWl4ID0gcHJvZHVjdERhdGFcbiAgICAgICAgICBicmVha1xuXG4gICAgICAgIGNhc2UgJ2NvbnN1bWVyLWJlaGF2aW9yJzpcbiAgICAgICAgICBjb25zdCB7IGRhdGE6IGJlaGF2aW9yRGF0YSwgZXJyb3I6IGJlaGF2aW9yRXJyb3IgfSA9IGF3YWl0IHRoaXMudHJhbnNhY3Rpb25EQUwuZ2V0QmVoYXZpb3JEYXRhKGZpbHRlcnMpXG4gICAgICAgICAgaWYgKGJlaGF2aW9yRXJyb3IpIHRocm93IG5ldyBFcnJvcihiZWhhdmlvckVycm9yKVxuICAgICAgICAgIGRhc2hib2FyZERhdGEuYmVoYXZpb3IgPSBiZWhhdmlvckRhdGFcbiAgICAgICAgICBicmVha1xuXG4gICAgICAgIGNhc2UgJ2NvbnN1bWVyLXByb2ZpbGluZyc6XG4gICAgICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxpbmdEYXRhLCBlcnJvcjogcHJvZmlsaW5nRXJyb3IgfSA9IGF3YWl0IHRoaXMudHJhbnNhY3Rpb25EQUwuZ2V0UHJvZmlsaW5nKGZpbHRlcnMpXG4gICAgICAgICAgaWYgKHByb2ZpbGluZ0Vycm9yKSB0aHJvdyBuZXcgRXJyb3IocHJvZmlsaW5nRXJyb3IpXG4gICAgICAgICAgZGFzaGJvYXJkRGF0YS5wcm9maWxpbmcgPSBwcm9maWxpbmdEYXRhXG4gICAgICAgICAgYnJlYWtcblxuICAgICAgICBjYXNlICdnZW9ncmFwaGljYWwtaW50ZWxsaWdlbmNlJzpcbiAgICAgICAgICBjb25zdCB7IGRhdGE6IGdlb0RhdGEsIGVycm9yOiBnZW9FcnJvciB9ID0gYXdhaXQgdGhpcy50cmFuc2FjdGlvbkRBTC5nZXRHZW9EYXRhKGZpbHRlcnMpXG4gICAgICAgICAgaWYgKGdlb0Vycm9yKSB0aHJvdyBuZXcgRXJyb3IoZ2VvRXJyb3IpXG4gICAgICAgICAgZGFzaGJvYXJkRGF0YS5nZW8gPSBnZW9EYXRhXG4gICAgICAgICAgYnJlYWtcblxuICAgICAgICBjYXNlICdjb21wZXRpdGl2ZS1hbmFseXNpcyc6XG4gICAgICAgICAgY29uc3QgeyBkYXRhOiBjb21wZXRpdGl2ZURhdGEsIGVycm9yOiBjb21wZXRpdGl2ZUVycm9yIH0gPSBhd2FpdCB0aGlzLnRyYW5zYWN0aW9uREFMLmdldENvbXBldGl0aXZlRGF0YShmaWx0ZXJzKVxuICAgICAgICAgIGlmIChjb21wZXRpdGl2ZUVycm9yKSB0aHJvdyBuZXcgRXJyb3IoY29tcGV0aXRpdmVFcnJvcilcbiAgICAgICAgICBkYXNoYm9hcmREYXRhLmNvbXBldGl0aXZlID0gY29tcGV0aXRpdmVEYXRhXG4gICAgICAgICAgYnJlYWtcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIC8vIEdldCBvdmVydmlldyBkYXRhIGZvciBnZW5lcmFsIGRhc2hib2FyZFxuICAgICAgICAgIGNvbnN0IFt0cmVuZHNSZXN1bHQsIGJlaGF2aW9yUmVzdWx0LCBnZW9SZXN1bHRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICAgICAgdGhpcy50cmFuc2FjdGlvbkRBTC5nZXRUcmVuZHMoZmlsdGVycyksXG4gICAgICAgICAgICB0aGlzLnRyYW5zYWN0aW9uREFMLmdldEJlaGF2aW9yRGF0YShmaWx0ZXJzKSxcbiAgICAgICAgICAgIHRoaXMudHJhbnNhY3Rpb25EQUwuZ2V0R2VvRGF0YShmaWx0ZXJzKVxuICAgICAgICAgIF0pXG4gICAgICAgICAgXG4gICAgICAgICAgZGFzaGJvYXJkRGF0YSA9IHtcbiAgICAgICAgICAgIHRyZW5kczogdHJlbmRzUmVzdWx0LmRhdGEsXG4gICAgICAgICAgICBiZWhhdmlvcjogYmVoYXZpb3JSZXN1bHQuZGF0YSxcbiAgICAgICAgICAgIGdlbzogZ2VvUmVzdWx0LmRhdGFcbiAgICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEdldCBBSSBpbnNpZ2h0cyBhbmQgcmVjb21tZW5kYXRpb25zIGlmIGVuYWJsZWRcbiAgICAgIGlmIChpbmNsdWRlQUkgJiYgdGhpcy5vcHRpb25zLmVuYWJsZUFJKSB7XG4gICAgICAgIGNvbnN0IFtpbnNpZ2h0c1Jlc3VsdCwgcmVjb21tZW5kYXRpb25zUmVzdWx0XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgICB0aGlzLmFpREFMLmdlbmVyYXRlSW5zaWdodHMoe1xuICAgICAgICAgICAgY29udGV4dDogc2VjdGlvbixcbiAgICAgICAgICAgIGZpbHRlcnMsXG4gICAgICAgICAgICBhbmFseXNpc1R5cGU6ICd0cmVuZHMnLFxuICAgICAgICAgICAgdGltZWZyYW1lOiAnMzBkJ1xuICAgICAgICAgIH0pLFxuICAgICAgICAgIHRoaXMuYWlEQUwuZ2V0UmVjb21tZW5kYXRpb25zKHNlY3Rpb24sIHsgZmlsdGVycyB9KVxuICAgICAgICBdKVxuXG4gICAgICAgIGluc2lnaHRzID0gaW5zaWdodHNSZXN1bHQuZGF0YSB8fCBbXVxuICAgICAgICByZWNvbW1lbmRhdGlvbnMgPSByZWNvbW1lbmRhdGlvbnNSZXN1bHQuZGF0YSB8fCBbXVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBkYXRhOiBkYXNoYm9hcmREYXRhLFxuICAgICAgICBpbnNpZ2h0cyxcbiAgICAgICAgcmVjb21tZW5kYXRpb25zXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGVycm9yOiAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2VcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRpbWUtYmFzZWQgaGVhdG1hcCBkYXRhIHdpdGggaW5zaWdodHNcbiAgICovXG4gIGFzeW5jIGdldFRpbWVBbmFseXNpcyhmaWx0ZXJzOiBUcmFuc2FjdGlvbkZpbHRlcnMgPSB7fSk6IFByb21pc2U8e1xuICAgIGhlYXRtYXA6IFRpbWVIZWF0bWFwRGF0YVtdIHwgbnVsbFxuICAgIGluc2lnaHRzOiBBSUluc2lnaHRbXVxuICAgIGVycm9yPzogc3RyaW5nXG4gIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhOiBoZWF0bWFwRGF0YSwgZXJyb3IgfSA9IGF3YWl0IHRoaXMudHJhbnNhY3Rpb25EQUwuZ2V0VGltZUhlYXRtYXAoZmlsdGVycylcbiAgICAgIGlmIChlcnJvcikgdGhyb3cgbmV3IEVycm9yKGVycm9yKVxuXG4gICAgICAvLyBHZW5lcmF0ZSB0aW1lLWJhc2VkIGluc2lnaHRzXG4gICAgICBjb25zdCBpbnNpZ2h0cyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVUaW1lSW5zaWdodHMoaGVhdG1hcERhdGEgfHwgW10pXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGhlYXRtYXA6IGhlYXRtYXBEYXRhLFxuICAgICAgICBpbnNpZ2h0c1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBoZWF0bWFwOiBudWxsLFxuICAgICAgICBpbnNpZ2h0czogW10sXG4gICAgICAgIGVycm9yOiAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2VcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybSBhZHZhbmNlZCBhbmFseXRpY3NcbiAgICovXG4gIGFzeW5jIGdldEFkdmFuY2VkQW5hbHl0aWNzKFxuICAgIGFuYWx5c2lzVHlwZTogJ2NvaG9ydCcgfCAnZnVubmVsJyB8ICdyZXRlbnRpb24nIHwgJ2F0dHJpYnV0aW9uJyxcbiAgICBwYXJhbXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fVxuICApOiBQcm9taXNlPHsgZGF0YTogYW55W10gfCBudWxsOyBpbnNpZ2h0czogQUlJbnNpZ2h0W107IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgdGhpcy50cmFuc2FjdGlvbkRBTC5nZXRBZHZhbmNlZEFuYWx5dGljcyhhbmFseXNpc1R5cGUsIHBhcmFtcylcbiAgICAgIGlmIChlcnJvcikgdGhyb3cgbmV3IEVycm9yKGVycm9yKVxuXG4gICAgICAvLyBHZW5lcmF0ZSBpbnNpZ2h0cyBmcm9tIGFkdmFuY2VkIGFuYWx5dGljc1xuICAgICAgY29uc3QgaW5zaWdodHMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQWR2YW5jZWRJbnNpZ2h0cyhhbmFseXNpc1R5cGUsIGRhdGEgfHwgW10pXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGEsXG4gICAgICAgIGluc2lnaHRzXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGluc2lnaHRzOiBbXSxcbiAgICAgICAgZXJyb3I6IChlcnJvciBhcyBFcnJvcikubWVzc2FnZVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGF0IGludGVyZmFjZSBmb3IgbmF0dXJhbCBsYW5ndWFnZSBxdWVyaWVzXG4gICAqL1xuICBhc3luYyBwcm9jZXNzQ2hhdE1lc3NhZ2UoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIGNvbnZlcnNhdGlvbklkOiBzdHJpbmcsXG4gICAgY29udGV4dDogUGFydGlhbDxDaGF0Q29udGV4dD4gPSB7fVxuICApOiBQcm9taXNlPHtcbiAgICByZXNwb25zZTogQ2hhdE1lc3NhZ2VcbiAgICBzdWdnZXN0aW9uczogc3RyaW5nW11cbiAgICBhY3Rpb25zPzogYW55W11cbiAgICBlcnJvcj86IHN0cmluZ1xuICB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIFN0b3JlIHVzZXIgbWVzc2FnZVxuICAgICAgY29uc3QgdXNlck1lc3NhZ2U6IENoYXRNZXNzYWdlID0ge1xuICAgICAgICBpZDogYG1zZ18ke0RhdGUubm93KCl9X3VzZXJgLFxuICAgICAgICBjb252ZXJzYXRpb25faWQ6IGNvbnZlcnNhdGlvbklkLFxuICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgIGNvbnRlbnQ6IG1lc3NhZ2UsXG4gICAgICAgIGNvbnRleHQ6IGNvbnRleHQuZGFzaGJvYXJkU3RhdGU/LnNlY3Rpb24gfHwgJ2dlbmVyYWwnLFxuICAgICAgICBmaWx0ZXJzOiBjb250ZXh0LmRhc2hib2FyZFN0YXRlPy5maWx0ZXJzLFxuICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH1cblxuICAgICAgYXdhaXQgdGhpcy5haURBTC5zdG9yZUNoYXRNZXNzYWdlKHVzZXJNZXNzYWdlKVxuXG4gICAgICAvLyBQcm9jZXNzIG5hdHVyYWwgbGFuZ3VhZ2UgcXVlcnlcbiAgICAgIGNvbnN0IGZ1bGxDb250ZXh0OiBDaGF0Q29udGV4dCA9IHtcbiAgICAgICAgY29udmVyc2F0aW9uSWQsXG4gICAgICAgIHVzZXJDb250ZXh0OiBjb250ZXh0LnVzZXJDb250ZXh0LFxuICAgICAgICBkYXNoYm9hcmRTdGF0ZTogY29udGV4dC5kYXNoYm9hcmRTdGF0ZSxcbiAgICAgICAgcHJldmlvdXNNZXNzYWdlczogY29udGV4dC5wcmV2aW91c01lc3NhZ2VzXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgZGF0YTogcmVzcG9uc2UsIGVycm9yIH0gPSBhd2FpdCB0aGlzLmFpREFMLnByb2Nlc3NOYXR1cmFsTGFuZ3VhZ2VRdWVyeShtZXNzYWdlLCBmdWxsQ29udGV4dClcbiAgICAgIGlmIChlcnJvcikgdGhyb3cgbmV3IEVycm9yKGVycm9yKVxuXG4gICAgICAvLyBHZW5lcmF0ZSBBSSByZXNwb25zZVxuICAgICAgY29uc3QgYXNzaXN0YW50TWVzc2FnZTogQ2hhdE1lc3NhZ2UgPSB7XG4gICAgICAgIGlkOiBgbXNnXyR7RGF0ZS5ub3coKX1fYXNzaXN0YW50YCxcbiAgICAgICAgY29udmVyc2F0aW9uX2lkOiBjb252ZXJzYXRpb25JZCxcbiAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgIGNvbnRlbnQ6IHJlc3BvbnNlLm1lc3NhZ2UgfHwgdGhpcy5nZW5lcmF0ZUNvbnRleHR1YWxSZXNwb25zZShtZXNzYWdlLCBjb250ZXh0KSxcbiAgICAgICAgY29udGV4dDogY29udGV4dC5kYXNoYm9hcmRTdGF0ZT8uc2VjdGlvbiB8fCAnZ2VuZXJhbCcsXG4gICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfVxuXG4gICAgICAvLyBTdG9yZSBhc3Npc3RhbnQgcmVzcG9uc2VcbiAgICAgIGF3YWl0IHRoaXMuYWlEQUwuc3RvcmVDaGF0TWVzc2FnZShhc3Npc3RhbnRNZXNzYWdlKVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXNwb25zZTogYXNzaXN0YW50TWVzc2FnZSxcbiAgICAgICAgc3VnZ2VzdGlvbnM6IHRoaXMuZ2VuZXJhdGVTdWdnZXN0aW9ucyhtZXNzYWdlLCBjb250ZXh0KSxcbiAgICAgICAgYWN0aW9uczogcmVzcG9uc2UuYWN0aW9uc1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXNwb25zZToge1xuICAgICAgICAgIGlkOiBgbXNnXyR7RGF0ZS5ub3coKX1fZXJyb3JgLFxuICAgICAgICAgIGNvbnZlcnNhdGlvbl9pZDogY29udmVyc2F0aW9uSWQsXG4gICAgICAgICAgcm9sZTogJ2Fzc2lzdGFudCcsXG4gICAgICAgICAgY29udGVudDogJ0kgZW5jb3VudGVyZWQgYW4gZXJyb3IgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB0cnkgYWdhaW4uJyxcbiAgICAgICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgICAgfSxcbiAgICAgICAgc3VnZ2VzdGlvbnM6IFsnVHJ5IGEgZGlmZmVyZW50IHF1ZXN0aW9uJywgJ0NoZWNrIHlvdXIgZmlsdGVycycsICdSZWZyZXNoIHRoZSBwYWdlJ10sXG4gICAgICAgIGVycm9yOiAoZXJyb3IgYXMgRXJyb3IpLm1lc3NhZ2VcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0IEFJLXBvd2VyZWQgaW5zaWdodHMgZm9yIHNwZWNpZmljIG1ldHJpY3NcbiAgICovXG4gIGFzeW5jIGdldEFJSW5zaWdodHMoXG4gICAgcGFyYW1zOiBBSUFuYWx5c2lzUGFyYW1zXG4gICk6IFByb21pc2U8eyBpbnNpZ2h0czogQUlJbnNpZ2h0W107IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhOiBpbnNpZ2h0cywgZXJyb3IgfSA9IGF3YWl0IHRoaXMuYWlEQUwuZ2VuZXJhdGVJbnNpZ2h0cyhwYXJhbXMpXG4gICAgICBpZiAoZXJyb3IpIHRocm93IG5ldyBFcnJvcihlcnJvcilcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaW5zaWdodHM6IGluc2lnaHRzIHx8IFtdXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGluc2lnaHRzOiBbXSxcbiAgICAgICAgZXJyb3I6IChlcnJvciBhcyBFcnJvcikubWVzc2FnZVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlY3QgYW5vbWFsaWVzIGluIGJ1c2luZXNzIG1ldHJpY3NcbiAgICovXG4gIGFzeW5jIGRldGVjdEFub21hbGllcyhcbiAgICBtZXRyaWM6IHN0cmluZyA9ICdzYWxlcycsXG4gICAgdGltZWZyYW1lOiBzdHJpbmcgPSAnN2QnXG4gICk6IFByb21pc2U8eyBhbm9tYWxpZXM6IGFueVtdOyBpbnNpZ2h0czogQUlJbnNpZ2h0W107IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhOiBhbm9tYWxpZXMsIGVycm9yIH0gPSBhd2FpdCB0aGlzLmFpREFMLmRldGVjdEFub21hbGllcyhtZXRyaWMsIHRpbWVmcmFtZSlcbiAgICAgIGlmIChlcnJvcikgdGhyb3cgbmV3IEVycm9yKGVycm9yKVxuXG4gICAgICAvLyBHZW5lcmF0ZSBpbnNpZ2h0cyBmcm9tIGFub21hbGllc1xuICAgICAgY29uc3QgaW5zaWdodHMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQW5vbWFseUluc2lnaHRzKGFub21hbGllcyB8fCBbXSlcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYW5vbWFsaWVzOiBhbm9tYWxpZXMgfHwgW10sXG4gICAgICAgIGluc2lnaHRzXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFub21hbGllczogW10sXG4gICAgICAgIGluc2lnaHRzOiBbXSxcbiAgICAgICAgZXJyb3I6IChlcnJvciBhcyBFcnJvcikubWVzc2FnZVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcHJlZGljdGlvbnMgZm9yIGJ1c2luZXNzIG1ldHJpY3NcbiAgICovXG4gIGFzeW5jIGdldFByZWRpY3Rpb25zKFxuICAgIG1ldHJpY3M6IHN0cmluZ1tdID0gWydzYWxlcycsICd0cmFuc2FjdGlvbnMnXSxcbiAgICBkYXlzOiBudW1iZXIgPSAzMFxuICApOiBQcm9taXNlPHsgcHJlZGljdGlvbnM6IGFueVtdOyBpbnNpZ2h0czogQUlJbnNpZ2h0W107IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhOiBwcmVkaWN0aW9ucywgZXJyb3IgfSA9IGF3YWl0IHRoaXMuYWlEQUwuZ2VuZXJhdGVQcmVkaWN0aW9ucyhtZXRyaWNzLCBkYXlzKVxuICAgICAgaWYgKGVycm9yKSB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpXG5cbiAgICAgIC8vIEdlbmVyYXRlIGluc2lnaHRzIGZyb20gcHJlZGljdGlvbnNcbiAgICAgIGNvbnN0IGluc2lnaHRzID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVByZWRpY3Rpb25JbnNpZ2h0cyhwcmVkaWN0aW9ucyB8fCBbXSlcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcHJlZGljdGlvbnM6IHByZWRpY3Rpb25zIHx8IFtdLFxuICAgICAgICBpbnNpZ2h0c1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBwcmVkaWN0aW9uczogW10sXG4gICAgICAgIGluc2lnaHRzOiBbXSxcbiAgICAgICAgZXJyb3I6IChlcnJvciBhcyBFcnJvcikubWVzc2FnZVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZW1hbnRpYyBzZWFyY2ggYWNyb3NzIGFuYWx5dGljcyBkYXRhXG4gICAqL1xuICBhc3luYyBzZW1hbnRpY1NlYXJjaChcbiAgICBxdWVyeTogc3RyaW5nLFxuICAgIGZpbHRlcnM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fVxuICApOiBQcm9taXNlPHsgcmVzdWx0czogYW55W107IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkYXRhOiByZXN1bHRzLCBlcnJvciB9ID0gYXdhaXQgdGhpcy5haURBTC5zZW1hbnRpY1NlYXJjaChxdWVyeSwgZmlsdGVycylcbiAgICAgIGlmIChlcnJvcikgdGhyb3cgbmV3IEVycm9yKGVycm9yKVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXN1bHRzOiByZXN1bHRzIHx8IFtdXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJlc3VsdHM6IFtdLFxuICAgICAgICBlcnJvcjogKGVycm9yIGFzIEVycm9yKS5tZXNzYWdlXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gUHJpdmF0ZSBoZWxwZXIgbWV0aG9kc1xuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlVGltZUluc2lnaHRzKGhlYXRtYXBEYXRhOiBUaW1lSGVhdG1hcERhdGFbXSk6IFByb21pc2U8QUlJbnNpZ2h0W10+IHtcbiAgICBjb25zdCBpbnNpZ2h0czogQUlJbnNpZ2h0W10gPSBbXVxuXG4gICAgaWYgKGhlYXRtYXBEYXRhLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGluc2lnaHRzXG5cbiAgICAvLyBGaW5kIHBlYWsgaG91cnNcbiAgICBjb25zdCBtYXhUeCA9IE1hdGgubWF4KC4uLmhlYXRtYXBEYXRhLm1hcChkID0+IGQudHhfY291bnQpKVxuICAgIGNvbnN0IHBlYWtIb3VycyA9IGhlYXRtYXBEYXRhLmZpbHRlcihkID0+IGQudHhfY291bnQgPT09IG1heFR4KVxuXG4gICAgaWYgKHBlYWtIb3Vycy5sZW5ndGggPiAwKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKHtcbiAgICAgICAgaWQ6IGB0aW1lX3BlYWtfJHtEYXRlLm5vdygpfWAsXG4gICAgICAgIHR5cGU6ICd0cmVuZCcsXG4gICAgICAgIHRpdGxlOiAnUGVhayBQZXJmb3JtYW5jZSBIb3VycyBJZGVudGlmaWVkJyxcbiAgICAgICAgZGVzY3JpcHRpb246IGBIaWdoZXN0IHRyYW5zYWN0aW9uIHZvbHVtZSBvY2N1cnMgZHVyaW5nICR7cGVha0hvdXJzLm1hcChoID0+IGgudGltZV9vZl9kYXkpLmpvaW4oJywgJyl9YCxcbiAgICAgICAgY29uZmlkZW5jZTogMC45LFxuICAgICAgICBwcmlvcml0eTogJ21lZGl1bScsXG4gICAgICAgIGNhdGVnb3J5OiAnb3BlcmF0aW9uYWwnLFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IFtcbiAgICAgICAgICAnU2NoZWR1bGUgbW9yZSBzdGFmZiBkdXJpbmcgcGVhayBob3VycycsXG4gICAgICAgICAgJ1BsYW4gcHJvbW90aW9uYWwgYWN0aXZpdGllcyBkdXJpbmcgaGlnaC10cmFmZmljIHBlcmlvZHMnXG4gICAgICAgIF0sXG4gICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICByZXR1cm4gaW5zaWdodHNcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVBZHZhbmNlZEluc2lnaHRzKHR5cGU6IHN0cmluZywgZGF0YTogYW55W10pOiBQcm9taXNlPEFJSW5zaWdodFtdPiB7XG4gICAgY29uc3QgaW5zaWdodHM6IEFJSW5zaWdodFtdID0gW11cblxuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSAncmV0ZW50aW9uJzpcbiAgICAgICAgaWYgKGRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGF2Z1JldGVudGlvbiA9IGRhdGEucmVkdWNlKChzdW0sIGQpID0+IHN1bSArIGQuYWN0aXZlX3N0b3JlcywgMCkgLyBkYXRhLmxlbmd0aFxuICAgICAgICAgIGluc2lnaHRzLnB1c2goe1xuICAgICAgICAgICAgaWQ6IGByZXRlbnRpb25fJHtEYXRlLm5vdygpfWAsXG4gICAgICAgICAgICB0eXBlOiAndHJlbmQnLFxuICAgICAgICAgICAgdGl0bGU6ICdTdG9yZSBSZXRlbnRpb24gQW5hbHlzaXMnLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IGBBdmVyYWdlIHN0b3JlIHJldGVudGlvbiBpcyAke2F2Z1JldGVudGlvbi50b0ZpeGVkKDEpfSBzdG9yZXMgcGVyIG1vbnRoYCxcbiAgICAgICAgICAgIGNvbmZpZGVuY2U6IDAuOCxcbiAgICAgICAgICAgIHByaW9yaXR5OiAnbWVkaXVtJyxcbiAgICAgICAgICAgIGNhdGVnb3J5OiAnb3BlcmF0aW9uYWwnLFxuICAgICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBicmVha1xuXG4gICAgICBjYXNlICdhdHRyaWJ1dGlvbic6XG4gICAgICAgIGlmIChkYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCBjYW1wYWlnbkRhdGEgPSBkYXRhLmZpbmQoZCA9PiBkLnNvdXJjZSA9PT0gJ0NhbXBhaWduJylcbiAgICAgICAgICBjb25zdCBvcmdhbmljRGF0YSA9IGRhdGEuZmluZChkID0+IGQuc291cmNlID09PSAnT3JnYW5pYycpXG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKGNhbXBhaWduRGF0YSAmJiBvcmdhbmljRGF0YSkge1xuICAgICAgICAgICAgY29uc3QgY2FtcGFpZ25ST0kgPSAoY2FtcGFpZ25EYXRhLnJldmVudWUgLyBjYW1wYWlnbkRhdGEudHJhbnNhY3Rpb25zKSAvIChvcmdhbmljRGF0YS5yZXZlbnVlIC8gb3JnYW5pY0RhdGEudHJhbnNhY3Rpb25zKVxuICAgICAgICAgICAgaW5zaWdodHMucHVzaCh7XG4gICAgICAgICAgICAgIGlkOiBgYXR0cmlidXRpb25fJHtEYXRlLm5vdygpfWAsXG4gICAgICAgICAgICAgIHR5cGU6ICdwcmVkaWN0aW9uJyxcbiAgICAgICAgICAgICAgdGl0bGU6ICdDYW1wYWlnbiBBdHRyaWJ1dGlvbiBJbXBhY3QnLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogYENhbXBhaWduLWluZmx1ZW5jZWQgdHJhbnNhY3Rpb25zIGhhdmUgJHtjYW1wYWlnblJPSS50b0ZpeGVkKDEpfXggaGlnaGVyIHZhbHVlIHRoYW4gb3JnYW5pY2AsXG4gICAgICAgICAgICAgIGNvbmZpZGVuY2U6IDAuODUsXG4gICAgICAgICAgICAgIHByaW9yaXR5OiAnaGlnaCcsXG4gICAgICAgICAgICAgIGNhdGVnb3J5OiAnbWFya2V0aW5nJyxcbiAgICAgICAgICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgIH1cblxuICAgIHJldHVybiBpbnNpZ2h0c1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUFub21hbHlJbnNpZ2h0cyhhbm9tYWxpZXM6IGFueVtdKTogUHJvbWlzZTxBSUluc2lnaHRbXT4ge1xuICAgIHJldHVybiBhbm9tYWxpZXMubWFwKGFub21hbHkgPT4gKHtcbiAgICAgIGlkOiBgYW5vbWFseV9pbnNpZ2h0XyR7RGF0ZS5ub3coKX1fJHthbm9tYWx5LmlkIHx8IE1hdGgucmFuZG9tKCl9YCxcbiAgICAgIHR5cGU6ICdhbm9tYWx5JyBhcyBjb25zdCxcbiAgICAgIHRpdGxlOiBgJHthbm9tYWx5Lm1ldHJpY30gQW5vbWFseSBEZXRlY3RlZGAsXG4gICAgICBkZXNjcmlwdGlvbjogYFVudXN1YWwgJHthbm9tYWx5Lm1ldHJpY30gdmFsdWUgZGV0ZWN0ZWQ6ICR7YW5vbWFseS52YWx1ZX1gLFxuICAgICAgY29uZmlkZW5jZTogMC44LFxuICAgICAgcHJpb3JpdHk6IGFub21hbHkuc2V2ZXJpdHkgPT09ICdoaWdoJyA/ICdoaWdoJyBhcyBjb25zdCA6ICdtZWRpdW0nIGFzIGNvbnN0LFxuICAgICAgY2F0ZWdvcnk6ICdvcGVyYXRpb25hbCcgYXMgY29uc3QsXG4gICAgICByZWNvbW1lbmRhdGlvbnM6IFtcbiAgICAgICAgJ0ludmVzdGlnYXRlIHBvdGVudGlhbCBjYXVzZXMnLFxuICAgICAgICAnQ2hlY2sgZGF0YSBxdWFsaXR5JyxcbiAgICAgICAgJ01vbml0b3IgZm9yIHRyZW5kIGNvbnRpbnVhdGlvbidcbiAgICAgIF0sXG4gICAgICBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9KSlcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVQcmVkaWN0aW9uSW5zaWdodHMocHJlZGljdGlvbnM6IGFueVtdKTogUHJvbWlzZTxBSUluc2lnaHRbXT4ge1xuICAgIHJldHVybiBwcmVkaWN0aW9ucy5tYXAocHJlZGljdGlvbiA9PiAoe1xuICAgICAgaWQ6IGBwcmVkaWN0aW9uX2luc2lnaHRfJHtEYXRlLm5vdygpfV8ke3ByZWRpY3Rpb24ubWV0cmljfWAsXG4gICAgICB0eXBlOiAncHJlZGljdGlvbicgYXMgY29uc3QsXG4gICAgICB0aXRsZTogYCR7cHJlZGljdGlvbi5tZXRyaWN9IEZvcmVjYXN0IEdlbmVyYXRlZGAsXG4gICAgICBkZXNjcmlwdGlvbjogYDMwLWRheSBmb3JlY2FzdCBzaG93cyAke3ByZWRpY3Rpb24uZm9yZWNhc3QubGVuZ3RofSBkYXRhIHBvaW50cyB3aXRoICR7KHByZWRpY3Rpb24uY29uZmlkZW5jZSAqIDEwMCkudG9GaXhlZCgxKX0lIGNvbmZpZGVuY2VgLFxuICAgICAgY29uZmlkZW5jZTogcHJlZGljdGlvbi5jb25maWRlbmNlLFxuICAgICAgcHJpb3JpdHk6IHByZWRpY3Rpb24uY29uZmlkZW5jZSA+IDAuOCA/ICdoaWdoJyBhcyBjb25zdCA6ICdtZWRpdW0nIGFzIGNvbnN0LFxuICAgICAgY2F0ZWdvcnk6ICdmaW5hbmNpYWwnIGFzIGNvbnN0LFxuICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfSkpXG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlQ29udGV4dHVhbFJlc3BvbnNlKG1lc3NhZ2U6IHN0cmluZywgY29udGV4dDogUGFydGlhbDxDaGF0Q29udGV4dD4pOiBzdHJpbmcge1xuICAgIGNvbnN0IHNlY3Rpb24gPSBjb250ZXh0LmRhc2hib2FyZFN0YXRlPy5zZWN0aW9uIHx8ICdnZW5lcmFsJ1xuICAgIFxuICAgIGNvbnN0IHJlc3BvbnNlcyA9IHtcbiAgICAgICd0cmFuc2FjdGlvbi10cmVuZHMnOiAnSSBjYW4gaGVscCB5b3UgYW5hbHl6ZSB0cmFuc2FjdGlvbiB0cmVuZHMuIFdoYXQgc3BlY2lmaWMgdGltZSBwZXJpb2Qgb3IgbWV0cmljIGludGVyZXN0cyB5b3U/JyxcbiAgICAgICdwcm9kdWN0LW1peCc6ICdJIGNhbiBhbmFseXplIHlvdXIgcHJvZHVjdCBwZXJmb3JtYW5jZSBkYXRhLiBXaGljaCBjYXRlZ29yaWVzIG9yIGJyYW5kcyB3b3VsZCB5b3UgbGlrZSB0byBleHBsb3JlPycsXG4gICAgICAnY29uc3VtZXItYmVoYXZpb3InOiAnSSBjYW4gcHJvdmlkZSBpbnNpZ2h0cyBpbnRvIGNvbnN1bWVyIGJlaGF2aW9yIHBhdHRlcm5zLiBXaGF0IGFzcGVjdCBvZiBjdXN0b21lciBiZWhhdmlvciBhcmUgeW91IGN1cmlvdXMgYWJvdXQ/JyxcbiAgICAgICdnZW9ncmFwaGljYWwtaW50ZWxsaWdlbmNlJzogJ0kgY2FuIGhlbHAgd2l0aCBnZW9ncmFwaGljIHBlcmZvcm1hbmNlIGFuYWx5c2lzLiBXaGljaCByZWdpb25zIG9yIHByb3ZpbmNlcyBhcmUgeW91IGludGVyZXN0ZWQgaW4/JyxcbiAgICAgICdjb21wZXRpdGl2ZS1hbmFseXNpcyc6ICdJIGNhbiBhbmFseXplIGNvbXBldGl0aXZlIHBvc2l0aW9uaW5nIGFuZCBtYXJrZXQgc2hhcmUuIFdoYXQgY29tcGV0aXRvcnMgb3IgY2F0ZWdvcmllcyBzaG91bGQgd2UgZm9jdXMgb24/JyxcbiAgICAgICdnZW5lcmFsJzogJ0kgY2FuIGhlbHAgeW91IGV4cGxvcmUgeW91ciBhbmFseXRpY3MgZGF0YS4gV2hhdCB3b3VsZCB5b3UgbGlrZSB0byBsZWFybiBhYm91dCB5b3VyIGJ1c2luZXNzIHBlcmZvcm1hbmNlPydcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzcG9uc2VzW3NlY3Rpb24gYXMga2V5b2YgdHlwZW9mIHJlc3BvbnNlc10gfHwgcmVzcG9uc2VzLmdlbmVyYWxcbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVTdWdnZXN0aW9ucyhtZXNzYWdlOiBzdHJpbmcsIGNvbnRleHQ6IFBhcnRpYWw8Q2hhdENvbnRleHQ+KTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHNlY3Rpb24gPSBjb250ZXh0LmRhc2hib2FyZFN0YXRlPy5zZWN0aW9uIHx8ICdnZW5lcmFsJ1xuICAgIFxuICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0ge1xuICAgICAgJ3RyYW5zYWN0aW9uLXRyZW5kcyc6IFtcbiAgICAgICAgJ1Nob3cgbWUgc2FsZXMgdHJlbmRzIGZvciB0aGUgbGFzdCAzMCBkYXlzJyxcbiAgICAgICAgJ0NvbXBhcmUgdGhpcyBtb250aCB2cyBsYXN0IG1vbnRoJyxcbiAgICAgICAgJ1doYXQgYXJlIHRoZSBwZWFrIHRyYW5zYWN0aW9uIGhvdXJzPydcbiAgICAgIF0sXG4gICAgICAncHJvZHVjdC1taXgnOiBbXG4gICAgICAgICdXaGljaCBwcm9kdWN0cyBhcmUgdG9wIHBlcmZvcm1lcnM/JyxcbiAgICAgICAgJ1Nob3cgbWUgY2F0ZWdvcnkgcGVyZm9ybWFuY2UnLFxuICAgICAgICAnQW5hbHl6ZSBicmFuZCBtYXJrZXQgc2hhcmUnXG4gICAgICBdLFxuICAgICAgJ2NvbnN1bWVyLWJlaGF2aW9yJzogW1xuICAgICAgICAnV2hhdCBhcmUgdGhlIG1vc3QgY29tbW9uIHB1cmNoYXNlIHBhdHRlcm5zPycsXG4gICAgICAgICdBbmFseXplIGN1c3RvbWVyIHNlZ21lbnRhdGlvbicsXG4gICAgICAgICdTaG93IGNvbnZlcnNpb24gZnVubmVsIGRhdGEnXG4gICAgICBdLFxuICAgICAgJ2dlb2dyYXBoaWNhbC1pbnRlbGxpZ2VuY2UnOiBbXG4gICAgICAgICdXaGljaCByZWdpb25zIHBlcmZvcm0gYmVzdD8nLFxuICAgICAgICAnQ29tcGFyZSBwcm92aW5jaWFsIHNhbGVzJyxcbiAgICAgICAgJ1Nob3cgZ2VvZ3JhcGhpYyBkaXN0cmlidXRpb24nXG4gICAgICBdLFxuICAgICAgJ2NvbXBldGl0aXZlLWFuYWx5c2lzJzogW1xuICAgICAgICAnQ29tcGFyZSBjb21wZXRpdG9yIHBlcmZvcm1hbmNlJyxcbiAgICAgICAgJ1Nob3cgbWFya2V0IHNoYXJlIHRyZW5kcycsXG4gICAgICAgICdBbmFseXplIHByaWNpbmcgc3RyYXRlZ2llcydcbiAgICAgIF0sXG4gICAgICAnZ2VuZXJhbCc6IFtcbiAgICAgICAgJ1Nob3cgbWUga2V5IHBlcmZvcm1hbmNlIGluZGljYXRvcnMnLFxuICAgICAgICAnV2hhdCBhcmUgdGhlIGxhdGVzdCBpbnNpZ2h0cz8nLFxuICAgICAgICAnR2VuZXJhdGUgYSBidXNpbmVzcyBzdW1tYXJ5J1xuICAgICAgXVxuICAgIH1cblxuICAgIHJldHVybiBzdWdnZXN0aW9uc1tzZWN0aW9uIGFzIGtleW9mIHR5cGVvZiBzdWdnZXN0aW9uc10gfHwgc3VnZ2VzdGlvbnMuZ2VuZXJhbFxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFuYWx5dGljc1NlcnZpY2UiXSwibmFtZXMiOlsiVHJhbnNhY3Rpb25EQUwiLCJBSURBTCIsIkFuYWx5dGljc1NlcnZpY2UiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJ0cmFuc2FjdGlvbkRBTCIsImFpREFMIiwiZW5hYmxlQ2FjaGluZyIsImVuYWJsZUFJIiwiZGVmYXVsdENhY2hlVFRMIiwiZ2V0RGFzaGJvYXJkRGF0YSIsInNlY3Rpb24iLCJmaWx0ZXJzIiwiaW5jbHVkZUFJIiwiZGFzaGJvYXJkRGF0YSIsImluc2lnaHRzIiwicmVjb21tZW5kYXRpb25zIiwiZGF0YSIsInRyZW5kc0RhdGEiLCJlcnJvciIsInRyZW5kc0Vycm9yIiwiZ2V0VHJlbmRzIiwiRXJyb3IiLCJ0cmVuZHMiLCJwcm9kdWN0RGF0YSIsInByb2R1Y3RFcnJvciIsImdldFByb2R1Y3RNaXgiLCJwcm9kdWN0TWl4IiwiYmVoYXZpb3JEYXRhIiwiYmVoYXZpb3JFcnJvciIsImdldEJlaGF2aW9yRGF0YSIsImJlaGF2aW9yIiwicHJvZmlsaW5nRGF0YSIsInByb2ZpbGluZ0Vycm9yIiwiZ2V0UHJvZmlsaW5nIiwicHJvZmlsaW5nIiwiZ2VvRGF0YSIsImdlb0Vycm9yIiwiZ2V0R2VvRGF0YSIsImdlbyIsImNvbXBldGl0aXZlRGF0YSIsImNvbXBldGl0aXZlRXJyb3IiLCJnZXRDb21wZXRpdGl2ZURhdGEiLCJjb21wZXRpdGl2ZSIsInRyZW5kc1Jlc3VsdCIsImJlaGF2aW9yUmVzdWx0IiwiZ2VvUmVzdWx0IiwiUHJvbWlzZSIsImFsbCIsImluc2lnaHRzUmVzdWx0IiwicmVjb21tZW5kYXRpb25zUmVzdWx0IiwiZ2VuZXJhdGVJbnNpZ2h0cyIsImNvbnRleHQiLCJhbmFseXNpc1R5cGUiLCJ0aW1lZnJhbWUiLCJnZXRSZWNvbW1lbmRhdGlvbnMiLCJtZXNzYWdlIiwiZ2V0VGltZUFuYWx5c2lzIiwiaGVhdG1hcERhdGEiLCJnZXRUaW1lSGVhdG1hcCIsImdlbmVyYXRlVGltZUluc2lnaHRzIiwiaGVhdG1hcCIsImdldEFkdmFuY2VkQW5hbHl0aWNzIiwicGFyYW1zIiwiZ2VuZXJhdGVBZHZhbmNlZEluc2lnaHRzIiwicHJvY2Vzc0NoYXRNZXNzYWdlIiwiY29udmVyc2F0aW9uSWQiLCJ1c2VyTWVzc2FnZSIsImlkIiwiRGF0ZSIsIm5vdyIsImNvbnZlcnNhdGlvbl9pZCIsInJvbGUiLCJjb250ZW50IiwiZGFzaGJvYXJkU3RhdGUiLCJjcmVhdGVkX2F0IiwidG9JU09TdHJpbmciLCJzdG9yZUNoYXRNZXNzYWdlIiwiZnVsbENvbnRleHQiLCJ1c2VyQ29udGV4dCIsInByZXZpb3VzTWVzc2FnZXMiLCJyZXNwb25zZSIsInByb2Nlc3NOYXR1cmFsTGFuZ3VhZ2VRdWVyeSIsImFzc2lzdGFudE1lc3NhZ2UiLCJnZW5lcmF0ZUNvbnRleHR1YWxSZXNwb25zZSIsInN1Z2dlc3Rpb25zIiwiZ2VuZXJhdGVTdWdnZXN0aW9ucyIsImFjdGlvbnMiLCJnZXRBSUluc2lnaHRzIiwiZGV0ZWN0QW5vbWFsaWVzIiwibWV0cmljIiwiYW5vbWFsaWVzIiwiZ2VuZXJhdGVBbm9tYWx5SW5zaWdodHMiLCJnZXRQcmVkaWN0aW9ucyIsIm1ldHJpY3MiLCJkYXlzIiwicHJlZGljdGlvbnMiLCJnZW5lcmF0ZVByZWRpY3Rpb25zIiwiZ2VuZXJhdGVQcmVkaWN0aW9uSW5zaWdodHMiLCJzZW1hbnRpY1NlYXJjaCIsInF1ZXJ5IiwicmVzdWx0cyIsImxlbmd0aCIsIm1heFR4IiwiTWF0aCIsIm1heCIsIm1hcCIsImQiLCJ0eF9jb3VudCIsInBlYWtIb3VycyIsImZpbHRlciIsInB1c2giLCJ0eXBlIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImgiLCJ0aW1lX29mX2RheSIsImpvaW4iLCJjb25maWRlbmNlIiwicHJpb3JpdHkiLCJjYXRlZ29yeSIsImF2Z1JldGVudGlvbiIsInJlZHVjZSIsInN1bSIsImFjdGl2ZV9zdG9yZXMiLCJ0b0ZpeGVkIiwiY2FtcGFpZ25EYXRhIiwiZmluZCIsInNvdXJjZSIsIm9yZ2FuaWNEYXRhIiwiY2FtcGFpZ25ST0kiLCJyZXZlbnVlIiwidHJhbnNhY3Rpb25zIiwiYW5vbWFseSIsInJhbmRvbSIsInZhbHVlIiwic2V2ZXJpdHkiLCJwcmVkaWN0aW9uIiwiZm9yZWNhc3QiLCJyZXNwb25zZXMiLCJnZW5lcmFsIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/services/analytics.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils/validation.ts":
/*!*********************************!*\
  !*** ./lib/utils/validation.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   validateAIAnalysisParams: () => (/* binding */ validateAIAnalysisParams),\n/* harmony export */   validateChatMessage: () => (/* binding */ validateChatMessage),\n/* harmony export */   validatePagination: () => (/* binding */ validatePagination),\n/* harmony export */   validateSearchQuery: () => (/* binding */ validateSearchQuery),\n/* harmony export */   validateTransactionFilters: () => (/* binding */ validateTransactionFilters)\n/* harmony export */ });\n/**\n * Validation utilities for Scout Dashboard\n */ /**\n * Validate and sanitize transaction filters\n */ function validateTransactionFilters(filters) {\n    const errors = [];\n    const sanitized = {};\n    // Validate date range\n    if (filters.dateFrom) {\n        const fromDate = new Date(filters.dateFrom);\n        if (isNaN(fromDate.getTime())) {\n            errors.push('Invalid dateFrom format. Use YYYY-MM-DD.');\n        } else {\n            sanitized.dateFrom = fromDate.toISOString().split('T')[0];\n        }\n    }\n    if (filters.dateTo) {\n        const toDate = new Date(filters.dateTo);\n        if (isNaN(toDate.getTime())) {\n            errors.push('Invalid dateTo format. Use YYYY-MM-DD.');\n        } else {\n            sanitized.dateTo = toDate.toISOString().split('T')[0];\n        }\n    }\n    // Validate date range logic\n    if (sanitized.dateFrom && sanitized.dateTo && sanitized.dateFrom > sanitized.dateTo) {\n        errors.push('dateFrom cannot be after dateTo.');\n    }\n    // Validate array filters\n    const arrayFields = [\n        'regions',\n        'provinces',\n        'stores',\n        'brands',\n        'categories',\n        'genders',\n        'ageBrackets'\n    ];\n    arrayFields.forEach((field)=>{\n        if (filters[field]) {\n            if (Array.isArray(filters[field])) {\n                const filtered = filters[field].filter((item)=>typeof item === 'string' && item.trim().length > 0);\n                if (filtered.length > 0) {\n                    sanitized[field] = filtered;\n                }\n            } else if (typeof filters[field] === 'string') {\n                const items = filters[field].split(',').map((item)=>item.trim()).filter(Boolean);\n                if (items.length > 0) {\n                    sanitized[field] = items;\n                }\n            }\n        }\n    });\n    return {\n        isValid: errors.length === 0,\n        errors,\n        sanitized\n    };\n}\n/**\n * Validate chat message input\n */ function validateChatMessage(data) {\n    const errors = [];\n    if (!data.message || typeof data.message !== 'string') {\n        errors.push('Message is required and must be a string.');\n    } else if (data.message.trim().length === 0) {\n        errors.push('Message cannot be empty.');\n    } else if (data.message.length > 1000) {\n        errors.push('Message cannot exceed 1000 characters.');\n    }\n    if (data.conversationId && typeof data.conversationId !== 'string') {\n        errors.push('Conversation ID must be a string.');\n    }\n    return {\n        isValid: errors.length === 0,\n        errors,\n        sanitized: {\n            message: data.message?.trim(),\n            conversationId: data.conversationId || null,\n            context: data.context || 'general',\n            filters: data.filters || {}\n        }\n    };\n}\n/**\n * Validate AI analysis parameters\n */ function validateAIAnalysisParams(params) {\n    const errors = [];\n    const validAnalysisTypes = [\n        'trends',\n        'anomalies',\n        'predictions',\n        'recommendations'\n    ];\n    if (!params.analysisType || !validAnalysisTypes.includes(params.analysisType)) {\n        errors.push(`Analysis type must be one of: ${validAnalysisTypes.join(', ')}.`);\n    }\n    if (params.confidenceThreshold !== undefined) {\n        const confidence = parseFloat(params.confidenceThreshold);\n        if (isNaN(confidence) || confidence < 0 || confidence > 1) {\n            errors.push('Confidence threshold must be a number between 0 and 1.');\n        } else {\n            params.confidenceThreshold = confidence;\n        }\n    }\n    if (params.timeframe && typeof params.timeframe !== 'string') {\n        errors.push('Timeframe must be a string (e.g., \"30d\", \"7d\").');\n    }\n    return {\n        isValid: errors.length === 0,\n        errors,\n        sanitized: params\n    };\n}\n/**\n * Validate pagination parameters\n */ function validatePagination(params) {\n    const errors = [];\n    const sanitized = {};\n    if (params.limit !== undefined) {\n        const limit = parseInt(params.limit, 10);\n        if (isNaN(limit) || limit < 1 || limit > 1000) {\n            errors.push('Limit must be a number between 1 and 1000.');\n        } else {\n            sanitized.limit = limit;\n        }\n    }\n    if (params.offset !== undefined) {\n        const offset = parseInt(params.offset, 10);\n        if (isNaN(offset) || offset < 0) {\n            errors.push('Offset must be a non-negative number.');\n        } else {\n            sanitized.offset = offset;\n        }\n    }\n    return {\n        isValid: errors.length === 0,\n        errors,\n        sanitized\n    };\n}\n/**\n * Sanitize and validate search query\n */ function validateSearchQuery(query) {\n    const errors = [];\n    if (typeof query !== 'string') {\n        errors.push('Search query must be a string.');\n        return {\n            isValid: false,\n            errors\n        };\n    }\n    const sanitized = query.trim();\n    if (sanitized.length === 0) {\n        errors.push('Search query cannot be empty.');\n    } else if (sanitized.length > 200) {\n        errors.push('Search query cannot exceed 200 characters.');\n    }\n    // Check for potential SQL injection patterns\n    const suspiciousPatterns = /(\\b(SELECT|INSERT|UPDATE|DELETE|DROP|UNION|EXEC)\\b)|[;'\"\\\\]/i;\n    if (suspiciousPatterns.test(sanitized)) {\n        errors.push('Search query contains invalid characters.');\n    }\n    return {\n        isValid: errors.length === 0,\n        errors,\n        sanitized\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Ly9zY291dC1kYXNoYm9hcmQtbmV4dGpzLy4vbGliL3V0aWxzL3ZhbGlkYXRpb24udHM/ZDgyNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFZhbGlkYXRpb24gdXRpbGl0aWVzIGZvciBTY291dCBEYXNoYm9hcmRcbiAqL1xuXG5pbXBvcnQgeyBUcmFuc2FjdGlvbkZpbHRlcnMgfSBmcm9tICdAL2xpYi9kYWwvdHJhbnNhY3Rpb25zJ1xuXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25SZXN1bHQge1xuICBpc1ZhbGlkOiBib29sZWFuXG4gIGVycm9yczogc3RyaW5nW11cbiAgc2FuaXRpemVkPzogYW55XG59XG5cbi8qKlxuICogVmFsaWRhdGUgYW5kIHNhbml0aXplIHRyYW5zYWN0aW9uIGZpbHRlcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlVHJhbnNhY3Rpb25GaWx0ZXJzKGZpbHRlcnM6IGFueSk6IFZhbGlkYXRpb25SZXN1bHQge1xuICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW11cbiAgY29uc3Qgc2FuaXRpemVkOiBUcmFuc2FjdGlvbkZpbHRlcnMgPSB7fVxuXG4gIC8vIFZhbGlkYXRlIGRhdGUgcmFuZ2VcbiAgaWYgKGZpbHRlcnMuZGF0ZUZyb20pIHtcbiAgICBjb25zdCBmcm9tRGF0ZSA9IG5ldyBEYXRlKGZpbHRlcnMuZGF0ZUZyb20pXG4gICAgaWYgKGlzTmFOKGZyb21EYXRlLmdldFRpbWUoKSkpIHtcbiAgICAgIGVycm9ycy5wdXNoKCdJbnZhbGlkIGRhdGVGcm9tIGZvcm1hdC4gVXNlIFlZWVktTU0tREQuJylcbiAgICB9IGVsc2Uge1xuICAgICAgc2FuaXRpemVkLmRhdGVGcm9tID0gZnJvbURhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdXG4gICAgfVxuICB9XG5cbiAgaWYgKGZpbHRlcnMuZGF0ZVRvKSB7XG4gICAgY29uc3QgdG9EYXRlID0gbmV3IERhdGUoZmlsdGVycy5kYXRlVG8pXG4gICAgaWYgKGlzTmFOKHRvRGF0ZS5nZXRUaW1lKCkpKSB7XG4gICAgICBlcnJvcnMucHVzaCgnSW52YWxpZCBkYXRlVG8gZm9ybWF0LiBVc2UgWVlZWS1NTS1ERC4nKVxuICAgIH0gZWxzZSB7XG4gICAgICBzYW5pdGl6ZWQuZGF0ZVRvID0gdG9EYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXVxuICAgIH1cbiAgfVxuXG4gIC8vIFZhbGlkYXRlIGRhdGUgcmFuZ2UgbG9naWNcbiAgaWYgKHNhbml0aXplZC5kYXRlRnJvbSAmJiBzYW5pdGl6ZWQuZGF0ZVRvICYmIHNhbml0aXplZC5kYXRlRnJvbSA+IHNhbml0aXplZC5kYXRlVG8pIHtcbiAgICBlcnJvcnMucHVzaCgnZGF0ZUZyb20gY2Fubm90IGJlIGFmdGVyIGRhdGVUby4nKVxuICB9XG5cbiAgLy8gVmFsaWRhdGUgYXJyYXkgZmlsdGVyc1xuICBjb25zdCBhcnJheUZpZWxkcyA9IFsncmVnaW9ucycsICdwcm92aW5jZXMnLCAnc3RvcmVzJywgJ2JyYW5kcycsICdjYXRlZ29yaWVzJywgJ2dlbmRlcnMnLCAnYWdlQnJhY2tldHMnXVxuICBcbiAgYXJyYXlGaWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgaWYgKGZpbHRlcnNbZmllbGRdKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWx0ZXJzW2ZpZWxkXSkpIHtcbiAgICAgICAgY29uc3QgZmlsdGVyZWQgPSBmaWx0ZXJzW2ZpZWxkXS5maWx0ZXIoKGl0ZW06IGFueSkgPT4gXG4gICAgICAgICAgdHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnICYmIGl0ZW0udHJpbSgpLmxlbmd0aCA+IDBcbiAgICAgICAgKVxuICAgICAgICBpZiAoZmlsdGVyZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHNhbml0aXplZFtmaWVsZCBhcyBrZXlvZiBUcmFuc2FjdGlvbkZpbHRlcnNdID0gZmlsdGVyZWQgYXMgYW55XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGZpbHRlcnNbZmllbGRdID09PSAnc3RyaW5nJykge1xuICAgICAgICBjb25zdCBpdGVtcyA9IGZpbHRlcnNbZmllbGRdLnNwbGl0KCcsJykubWFwKChpdGVtOiBzdHJpbmcpID0+IGl0ZW0udHJpbSgpKS5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBzYW5pdGl6ZWRbZmllbGQgYXMga2V5b2YgVHJhbnNhY3Rpb25GaWx0ZXJzXSA9IGl0ZW1zIGFzIGFueVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KVxuXG4gIHJldHVybiB7XG4gICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcbiAgICBlcnJvcnMsXG4gICAgc2FuaXRpemVkXG4gIH1cbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSBjaGF0IG1lc3NhZ2UgaW5wdXRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQ2hhdE1lc3NhZ2UoZGF0YTogYW55KTogVmFsaWRhdGlvblJlc3VsdCB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXVxuXG4gIGlmICghZGF0YS5tZXNzYWdlIHx8IHR5cGVvZiBkYXRhLm1lc3NhZ2UgIT09ICdzdHJpbmcnKSB7XG4gICAgZXJyb3JzLnB1c2goJ01lc3NhZ2UgaXMgcmVxdWlyZWQgYW5kIG11c3QgYmUgYSBzdHJpbmcuJylcbiAgfSBlbHNlIGlmIChkYXRhLm1lc3NhZ2UudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgIGVycm9ycy5wdXNoKCdNZXNzYWdlIGNhbm5vdCBiZSBlbXB0eS4nKVxuICB9IGVsc2UgaWYgKGRhdGEubWVzc2FnZS5sZW5ndGggPiAxMDAwKSB7XG4gICAgZXJyb3JzLnB1c2goJ01lc3NhZ2UgY2Fubm90IGV4Y2VlZCAxMDAwIGNoYXJhY3RlcnMuJylcbiAgfVxuXG4gIGlmIChkYXRhLmNvbnZlcnNhdGlvbklkICYmIHR5cGVvZiBkYXRhLmNvbnZlcnNhdGlvbklkICE9PSAnc3RyaW5nJykge1xuICAgIGVycm9ycy5wdXNoKCdDb252ZXJzYXRpb24gSUQgbXVzdCBiZSBhIHN0cmluZy4nKVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgIGVycm9ycyxcbiAgICBzYW5pdGl6ZWQ6IHtcbiAgICAgIG1lc3NhZ2U6IGRhdGEubWVzc2FnZT8udHJpbSgpLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGRhdGEuY29udmVyc2F0aW9uSWQgfHwgbnVsbCxcbiAgICAgIGNvbnRleHQ6IGRhdGEuY29udGV4dCB8fCAnZ2VuZXJhbCcsXG4gICAgICBmaWx0ZXJzOiBkYXRhLmZpbHRlcnMgfHwge31cbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSBBSSBhbmFseXNpcyBwYXJhbWV0ZXJzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUFJQW5hbHlzaXNQYXJhbXMocGFyYW1zOiBhbnkpOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdXG4gIFxuICBjb25zdCB2YWxpZEFuYWx5c2lzVHlwZXMgPSBbJ3RyZW5kcycsICdhbm9tYWxpZXMnLCAncHJlZGljdGlvbnMnLCAncmVjb21tZW5kYXRpb25zJ11cbiAgXG4gIGlmICghcGFyYW1zLmFuYWx5c2lzVHlwZSB8fCAhdmFsaWRBbmFseXNpc1R5cGVzLmluY2x1ZGVzKHBhcmFtcy5hbmFseXNpc1R5cGUpKSB7XG4gICAgZXJyb3JzLnB1c2goYEFuYWx5c2lzIHR5cGUgbXVzdCBiZSBvbmUgb2Y6ICR7dmFsaWRBbmFseXNpc1R5cGVzLmpvaW4oJywgJyl9LmApXG4gIH1cblxuICBpZiAocGFyYW1zLmNvbmZpZGVuY2VUaHJlc2hvbGQgIT09IHVuZGVmaW5lZCkge1xuICAgIGNvbnN0IGNvbmZpZGVuY2UgPSBwYXJzZUZsb2F0KHBhcmFtcy5jb25maWRlbmNlVGhyZXNob2xkKVxuICAgIGlmIChpc05hTihjb25maWRlbmNlKSB8fCBjb25maWRlbmNlIDwgMCB8fCBjb25maWRlbmNlID4gMSkge1xuICAgICAgZXJyb3JzLnB1c2goJ0NvbmZpZGVuY2UgdGhyZXNob2xkIG11c3QgYmUgYSBudW1iZXIgYmV0d2VlbiAwIGFuZCAxLicpXG4gICAgfSBlbHNlIHtcbiAgICAgIHBhcmFtcy5jb25maWRlbmNlVGhyZXNob2xkID0gY29uZmlkZW5jZVxuICAgIH1cbiAgfVxuXG4gIGlmIChwYXJhbXMudGltZWZyYW1lICYmIHR5cGVvZiBwYXJhbXMudGltZWZyYW1lICE9PSAnc3RyaW5nJykge1xuICAgIGVycm9ycy5wdXNoKCdUaW1lZnJhbWUgbXVzdCBiZSBhIHN0cmluZyAoZS5nLiwgXCIzMGRcIiwgXCI3ZFwiKS4nKVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgIGVycm9ycyxcbiAgICBzYW5pdGl6ZWQ6IHBhcmFtc1xuICB9XG59XG5cbi8qKlxuICogVmFsaWRhdGUgcGFnaW5hdGlvbiBwYXJhbWV0ZXJzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhZ2luYXRpb24ocGFyYW1zOiBhbnkpOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdXG4gIGNvbnN0IHNhbml0aXplZDogYW55ID0ge31cblxuICBpZiAocGFyYW1zLmxpbWl0ICE9PSB1bmRlZmluZWQpIHtcbiAgICBjb25zdCBsaW1pdCA9IHBhcnNlSW50KHBhcmFtcy5saW1pdCwgMTApXG4gICAgaWYgKGlzTmFOKGxpbWl0KSB8fCBsaW1pdCA8IDEgfHwgbGltaXQgPiAxMDAwKSB7XG4gICAgICBlcnJvcnMucHVzaCgnTGltaXQgbXVzdCBiZSBhIG51bWJlciBiZXR3ZWVuIDEgYW5kIDEwMDAuJylcbiAgICB9IGVsc2Uge1xuICAgICAgc2FuaXRpemVkLmxpbWl0ID0gbGltaXRcbiAgICB9XG4gIH1cblxuICBpZiAocGFyYW1zLm9mZnNldCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3Qgb2Zmc2V0ID0gcGFyc2VJbnQocGFyYW1zLm9mZnNldCwgMTApXG4gICAgaWYgKGlzTmFOKG9mZnNldCkgfHwgb2Zmc2V0IDwgMCkge1xuICAgICAgZXJyb3JzLnB1c2goJ09mZnNldCBtdXN0IGJlIGEgbm9uLW5lZ2F0aXZlIG51bWJlci4nKVxuICAgIH0gZWxzZSB7XG4gICAgICBzYW5pdGl6ZWQub2Zmc2V0ID0gb2Zmc2V0XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgIGVycm9ycyxcbiAgICBzYW5pdGl6ZWRcbiAgfVxufVxuXG4vKipcbiAqIFNhbml0aXplIGFuZCB2YWxpZGF0ZSBzZWFyY2ggcXVlcnlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlU2VhcmNoUXVlcnkocXVlcnk6IHN0cmluZyk6IFZhbGlkYXRpb25SZXN1bHQge1xuICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW11cblxuICBpZiAodHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJykge1xuICAgIGVycm9ycy5wdXNoKCdTZWFyY2ggcXVlcnkgbXVzdCBiZSBhIHN0cmluZy4nKVxuICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnMgfVxuICB9XG5cbiAgY29uc3Qgc2FuaXRpemVkID0gcXVlcnkudHJpbSgpXG5cbiAgaWYgKHNhbml0aXplZC5sZW5ndGggPT09IDApIHtcbiAgICBlcnJvcnMucHVzaCgnU2VhcmNoIHF1ZXJ5IGNhbm5vdCBiZSBlbXB0eS4nKVxuICB9IGVsc2UgaWYgKHNhbml0aXplZC5sZW5ndGggPiAyMDApIHtcbiAgICBlcnJvcnMucHVzaCgnU2VhcmNoIHF1ZXJ5IGNhbm5vdCBleGNlZWQgMjAwIGNoYXJhY3RlcnMuJylcbiAgfVxuXG4gIC8vIENoZWNrIGZvciBwb3RlbnRpYWwgU1FMIGluamVjdGlvbiBwYXR0ZXJuc1xuICBjb25zdCBzdXNwaWNpb3VzUGF0dGVybnMgPSAvKFxcYihTRUxFQ1R8SU5TRVJUfFVQREFURXxERUxFVEV8RFJPUHxVTklPTnxFWEVDKVxcYil8WzsnXCJcXFxcXS9pXG4gIGlmIChzdXNwaWNpb3VzUGF0dGVybnMudGVzdChzYW5pdGl6ZWQpKSB7XG4gICAgZXJyb3JzLnB1c2goJ1NlYXJjaCBxdWVyeSBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMuJylcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcbiAgICBlcnJvcnMsXG4gICAgc2FuaXRpemVkXG4gIH1cbn0iXSwibmFtZXMiOlsidmFsaWRhdGVUcmFuc2FjdGlvbkZpbHRlcnMiLCJmaWx0ZXJzIiwiZXJyb3JzIiwic2FuaXRpemVkIiwiZGF0ZUZyb20iLCJmcm9tRGF0ZSIsIkRhdGUiLCJpc05hTiIsImdldFRpbWUiLCJwdXNoIiwidG9JU09TdHJpbmciLCJzcGxpdCIsImRhdGVUbyIsInRvRGF0ZSIsImFycmF5RmllbGRzIiwiZm9yRWFjaCIsImZpZWxkIiwiQXJyYXkiLCJpc0FycmF5IiwiZmlsdGVyZWQiLCJmaWx0ZXIiLCJpdGVtIiwidHJpbSIsImxlbmd0aCIsIml0ZW1zIiwibWFwIiwiQm9vbGVhbiIsImlzVmFsaWQiLCJ2YWxpZGF0ZUNoYXRNZXNzYWdlIiwiZGF0YSIsIm1lc3NhZ2UiLCJjb252ZXJzYXRpb25JZCIsImNvbnRleHQiLCJ2YWxpZGF0ZUFJQW5hbHlzaXNQYXJhbXMiLCJwYXJhbXMiLCJ2YWxpZEFuYWx5c2lzVHlwZXMiLCJhbmFseXNpc1R5cGUiLCJpbmNsdWRlcyIsImpvaW4iLCJjb25maWRlbmNlVGhyZXNob2xkIiwidW5kZWZpbmVkIiwiY29uZmlkZW5jZSIsInBhcnNlRmxvYXQiLCJ0aW1lZnJhbWUiLCJ2YWxpZGF0ZVBhZ2luYXRpb24iLCJsaW1pdCIsInBhcnNlSW50Iiwib2Zmc2V0IiwidmFsaWRhdGVTZWFyY2hRdWVyeSIsInF1ZXJ5Iiwic3VzcGljaW91c1BhdHRlcm5zIiwidGVzdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils/validation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@15.0.0-rc.0_react-dom@19.1.1_react@19.1.1__react@19.1.1"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@15.0.0-rc.0_react-dom@19.1.1_react@19.1.1__react@19.1.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fscout%2Ftrends%2Froute&page=%2Fapi%2Fscout%2Ftrends%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fscout%2Ftrends%2Froute.ts&appDir=%2FUsers%2Ftbwa%2Fscout-dashboard%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftbwa%2Fscout-dashboard&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();